(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    483027,      12159]
NotebookOptionsPosition[    481522,      12130]
NotebookOutlinePosition[    481926,      12147]
CellTagsIndexPosition[    481883,      12144]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"NotebookDirectory", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7923780504945374`*^9, 3.792378058576915*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"c7e36da7-39ea-464c-81ec-8c4f212968ba"],

Cell[BoxData["\<\"/Users/seamus11/\"\>"], "Output",
 CellChangeTimes->{3.792378060650584*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"408b420e-994a-4d04-947a-10ed881820ea"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     StyleBox[
      RowBox[{"SetOptions", "[", 
       RowBox[{"$FrontEnd", ",", 
        RowBox[{"Background", "\[Rule]", 
         RowBox[{"RGBColor", "[", 
          RowBox[{"0.9", ",", "0.91", ",", "0.66"}], "]"}]}]}], "]"}], "Code"], 
     StyleBox["\n", "Code"], 
     RowBox[{"SetOptions", "[", 
      RowBox[{
       RowBox[{"InputNotebook", "[", "]"}], ",", 
       RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}], 
     "\n", 
     RowBox[{"SetOptions", "[", 
      RowBox[{"$FrontEnd", ",", " ", 
       RowBox[{"FontSize", " ", "->", " ", "12"}]}], "]"}], "\n", 
     RowBox[{"NotebookSave", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RunProcess", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<scp\>\"", ",", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"NotebookFileName", "[", "]"}], ",", 
          RowBox[{"\"\<.nb\>\"", "\[Rule]", "\"\<.m\>\""}]}], "]"}], ",", 
        "\"\<fwq:~\>\""}], "}"}], "]"}], "\n", 
     RowBox[{"RunProcess", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<scp\>\"", ",", "\"\<fwq:~/180.txt\>\"", ",", 
        "\"\</Users/seamus11\>\""}], "}"}], "]"}]}]}], 
   StyleBox["*)", "Code"]}], 
  StyleBox["\n", "Code"], 
  RowBox[{
   RowBox[{
    RowBox[{"cluster", ":=", " ", 
     RowBox[{
     "Print", "@", 
      "\"\<SetOptions[InputNotebook[],AutoGeneratedPackage\[Rule]Automatic];\
\[IndentingNewLine]NotebookSave[];\[IndentingNewLine]RunProcess[{\\\"scp\\\",\
StringReplace[NotebookFileName[],\\\".nb\\\"\[Rule]\\\".m\\\"],\\\"fwq:pn\\\"}\
];\[IndentingNewLine]RunProcess[{\\\"scp\\\",\\\"fwq:180.txt\\\",\
NotebookDirectory[]}];\n\
SetDirectory@NotebookDirectory[];\[IndentingNewLine]Export[\\\"test.gif\\\",\
Plot[Sin[x],{x,0,10}]];\[IndentingNewLine]Import[\\\"test.gif\\\"];\>\""}]}], 
    ";"}], 
   StyleBox["\n", "Code"], 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"line", "[", "i__", "]"}], "/;", 
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"{", "i", "}"}]}], ">", 
       RowBox[{"Length", "@", 
        RowBox[{"Union", "@", 
         RowBox[{"{", "i", "}"}]}]}]}]}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"med", ",", "po"}], "}"}], ",", 
       RowBox[{
        RowBox[{"med", "=", 
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Split", "@", 
             RowBox[{"Sort", "@", 
              RowBox[{"{", "i", "}"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"po", "=", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"{", "i", "}"}], ",", "med"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"line", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{
             RowBox[{"{", "i", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"po", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
           "]"}], 
          RowBox[{"sub", "[", " ", 
           RowBox[{"Sequence", "@@", 
            RowBox[{
             RowBox[{"{", "i", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"po", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ";;", 
               RowBox[{
                RowBox[{"po", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "]"}], 
             "]"}]}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"line", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{
             RowBox[{"{", "i", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"po", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], ";;"}], "]"}], 
             "]"}]}], "]"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"line", "[", "]"}], "\[Rule]", " ", "1"}], ",", 
           RowBox[{
            RowBox[{"line", "[", "_", "]"}], "\[Rule]", " ", "1"}]}], 
          "}"}]}]}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"line", "/:", 
     RowBox[{
      RowBox[{"line", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "^", "2"}], ":=", 
     RowBox[{"-", 
      RowBox[{"sub", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"line", "/:", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"line", "[", "i__", "]"}], " ", 
       RowBox[{"line", "[", "j__", "]"}]}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "i", "}"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"{", "j", "}"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ":=", 
     RowBox[{"line", "[", 
      RowBox[{"i", ",", 
       RowBox[{"Sequence", "@@", 
        RowBox[{
         RowBox[{"{", "j", "}"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"line", "/:", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"line", "[", "i__", "]"}], " ", 
       RowBox[{"line", "[", "j__", "]"}]}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "i", "}"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"{", "j", "}"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"{", "j", "}"}]}], "-", "1"}], ")"}]}], " ", 
      RowBox[{"line", "[", 
       RowBox[{"i", ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Reverse", "@", 
            RowBox[{"{", "j", "}"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"line", "/:", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"line", "[", "i__", "]"}], " ", 
       RowBox[{"line", "[", "j__", "]"}]}], "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "i", "}"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"{", "j", "}"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"{", "i", "}"}]}], "-", "1"}], ")"}]}], " ", 
      RowBox[{"line", "[", 
       RowBox[{
        RowBox[{"Sequence", "@@", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Reverse", "@", 
            RowBox[{"{", "i", "}"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}]}], ",", "j"}], "]"}]}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"line", "/:", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"line", "[", "i__", "]"}], " ", 
       RowBox[{"line", "[", "j__", "]"}]}], "/;", 
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"{", "i", "}"}], ",", 
          RowBox[{"{", "j", "}"}]}], "]"}]}], ">", "1"}]}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "med", ",", "ii", ",", "jj", ",", "sign1", ",", "sign2", ",", "ip1", 
         ",", "ip2", ",", "jp1", ",", "jp2"}], "}"}], ",", 
       RowBox[{
        RowBox[{"med", "=", 
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"{", "i", "}"}], ",", 
           RowBox[{"{", "j", "}"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"{", "i", "}"}], ",", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"med", ",", "#"}], "]"}], "&"}]}], "]"}], "\[Equal]", 
           "med"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sign1", "=", "1"}], ")"}], ";", 
           RowBox[{"(", 
            RowBox[{"ii", "=", 
             RowBox[{"{", "i", "}"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sign1", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"{", "i", "}"}]}], "-", "1"}], ")"}]}]}], ")"}], ";", 
           RowBox[{"(", 
            RowBox[{"ii", "=", 
             RowBox[{"Reverse", "@", 
              RowBox[{"{", "i", "}"}]}]}], ")"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"{", "j", "}"}], ",", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"med", ",", "#"}], "]"}], "&"}]}], "]"}], "\[Equal]", 
           RowBox[{"Reverse", "@", " ", "med"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sign2", "=", "1"}], ")"}], ";", 
           RowBox[{"(", 
            RowBox[{"jj", "=", 
             RowBox[{"{", "j", "}"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sign2", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"{", "j", "}"}]}], "-", "1"}], ")"}]}]}], ")"}], ";", 
           RowBox[{"(", 
            RowBox[{"jj", "=", 
             RowBox[{"Reverse", "@", 
              RowBox[{"{", "j", "}"}]}]}], ")"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ip1", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ii", ",", 
            RowBox[{"med", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"ip2", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"ii", ",", 
            RowBox[{"med", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"jp1", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"jj", ",", 
            RowBox[{"med", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"jp2", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"jj", ",", 
            RowBox[{"med", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sign1", " ", "sign2", " ", 
         RowBox[{"line", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"ii", "[", 
             RowBox[{"[", 
              RowBox[{";;", "ip1"}], "]"}], "]"}]}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"jj", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jp1", "+", "1"}], ";;"}], "]"}], "]"}]}]}], "]"}], 
         RowBox[{"sub", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"ii", "[", 
             RowBox[{"[", 
              RowBox[{"ip1", ";;", 
               RowBox[{"ip2", "-", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"jj", "[", 
             RowBox[{"[", 
              RowBox[{"jp2", ";;", 
               RowBox[{"jp1", "-", "1"}]}], "]"}], "]"}]}]}], "]"}], 
         RowBox[{"line", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"jj", "[", 
             RowBox[{"[", 
              RowBox[{";;", "jp2"}], "]"}], "]"}]}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"ii", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"ip2", "+", "1"}], ";;"}], "]"}], "]"}]}]}], 
          "]"}]}]}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"line", "/:", 
     RowBox[{
      RowBox[{
       StyleBox["Times",
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True], 
       StyleBox["[",
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True], 
       RowBox[{
        RowBox[{"line", "[", "i__", "]"}], ",", 
        RowBox[{"line", "[", "j__", "]"}], ",", "k__"}], "]"}], "/;", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"medd", ",", "in"}], "}"}], ",", 
        RowBox[{
         RowBox[{"medd", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "k", "}"}], ",", 
            RowBox[{"line", "[", "__", "]"}]}], "]"}]}], ";", 
         RowBox[{"in", "=", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"Split", "@", 
              RowBox[{"Sort", "@", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", 
                  RowBox[{"List", "@@@", "medd"}]}], "}"}]}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "#"}], ">", "1"}], "&"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "in"}], "==", 
           RowBox[{
            RowBox[{"Length", "@", "medd"}], "+", "2"}]}], "&&", 
          "\[IndentingNewLine]", 
          RowBox[{"And", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"Intersection", "[", 
                 RowBox[{"#", ",", "in"}], "]"}]}], "\[Equal]", "2"}], "&"}], 
             "/@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "i", "}"}], ",", 
               RowBox[{"{", "j", "}"}], ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"List", "@@@", "medd"}]}]}], "}"}]}], ")"}]}]}]}]}], 
       "]"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "med", ",", "medd", ",", "ip", ",", "jp", ",", "$ip", ",", "$jp"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"medd", "=", 
         RowBox[{"Union", "@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "k", "}"}], ",", 
            RowBox[{
             RowBox[{"line", "[", "ii__", "]"}], "\[RuleDelayed]", " ", 
             RowBox[{"Sequence", "@", "ii"}]}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"med", "=", 
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", 
            RowBox[{"{", "j", "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ip", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", "med"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jp", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "j", "}"}], ",", "med"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$ip", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "i", "}"}], ",", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"{", "i", "}"}], ",", "medd"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"$jp", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"{", "j", "}"}], ",", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"{", "j", "}"}], ",", "medd"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ip", "-", "$ip"}], ")"}], 
            RowBox[{"(", " ", 
             RowBox[{"jp", "-", "$jp"}], ")"}]}], "<", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"line", "[", 
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{
                RowBox[{"{", "i", "}"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", "ip"}], "]"}], "]"}]}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{
                RowBox[{"{", "j", "}"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jp", "+", "1"}], ";;"}], "]"}], "]"}]}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"line", "[", 
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{
                RowBox[{"{", "j", "}"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", "jp"}], "]"}], "]"}]}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{
                RowBox[{"{", "i", "}"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"ip", "+", "1"}], ";;"}], "]"}], "]"}]}]}], "]"}], 
            ",", "k"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"{", "j", "}"}]}], "-", "1"}], ")"}]}], 
           RowBox[{"Times", "[", 
            RowBox[{
             RowBox[{"line", "[", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{
                 RowBox[{"{", "i", "}"}], "[", 
                 RowBox[{"[", 
                  RowBox[{";;", "ip"}], "]"}], "]"}]}], ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "@", 
                 RowBox[{
                  RowBox[{"{", "j", "}"}], "[", 
                  RowBox[{"[", 
                   RowBox[{";;", 
                    RowBox[{"jp", "-", "1"}]}], "]"}], "]"}]}]}]}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"line", "[", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "@", 
                 RowBox[{
                  RowBox[{"{", "j", "}"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"jp", ";;"}], "]"}], "]"}]}]}], ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{
                 RowBox[{"{", "i", "}"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"ip", "+", "1"}], ";;"}], "]"}], "]"}]}]}], 
              "]"}]}], "]"}]}]}], "]"}]}]}], "]"}]}], ";"}], "\n", "\n", "\n", 
   StyleBox[
    RowBox[{"(*", "Analytic", "*)"}], "Title"], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["s", "i__"], "/;", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"{", "i", "}"}]}], "\[NotEqual]", " ", 
       RowBox[{"{", "i", "}"}]}]}], ":=", 
     SubscriptBox["s", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Sort", "@", 
        RowBox[{"{", "i", "}"}]}]}]]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"pair", "[", "i__", "]"}], ":=", " ", 
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "i", "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "i", "}"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}]}], ";"}], "\n", "\n", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"KKbasis", " ", "BCJbasis"}], "*)"}], "Subsubsection"], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"cyclicity", "[", "slot_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"slot", "[", 
         RowBox[{"[", 
          RowBox[{"i", ";;"}], "]"}], "]"}], "~", "Join", "~", 
        RowBox[{"slot", "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "slot"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cyclicity", "[", 
      RowBox[{"list_", ",", "a_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$list", "=", "list"}], "}"}], ",", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"$list", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=!=", "a"}], ",", 
          RowBox[{"$list", "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"$list", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
             RowBox[{"$list", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
        "$list"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"shuffle", "[", "list__", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"preshuffle", ",", "listt", ",", 
        RowBox[{"ii", "=", "3"}], ",", "med"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"preshuffle", "[", 
         RowBox[{"list1_", ",", "list2_"}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"listt", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"list1", ",", "list2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ReplacePart", "[", 
              RowBox[{"listt", ",", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", " ", 
                    RowBox[{"#", ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "listt"}]}], ",", "#"}], "]"}]}], 
                    "}"}]}], ",", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"list1", ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{"list2", ",", 
                    RowBox[{"Function", "[", 
                    RowBox[{"slotttt", ",", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"list1", ",", "slotttt"}], "]"}]}]}], "]"}]}], 
                    "]"}]}], "}"}]}]}], "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "listt"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"Length", "@", "list1"}], "}"}]}], "]"}]}], "//", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"list2", ",", "#"}], "]"}], "&"}]}], "]"}], 
                "\[Equal]", "list2"}], "&"}]}], "]"}], "&"}]}]}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"{", "list", "}"}]}], "\[LessEqual]", " ", "1"}], ",", 
         RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"med", "=", 
           RowBox[{"preshuffle", "@@", 
            RowBox[{
             RowBox[{"{", "list", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", "2"}], "]"}], "]"}]}]}], ";", " ", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"ii", "\[LessEqual]", " ", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "list", "}"}]}]}], ",", 
            RowBox[{
             RowBox[{"med", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"preshuffle", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"{", "list", "}"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], "&"}], "/@", 
                 "med"}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"ii", "++"}]}]}], "]"}], ";", "med"}]}], "]"}]}]}], 
     "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"KKbasis", "[", 
      RowBox[{"parketaylorlistlike_", ",", "$1_", ",", "$n_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"KKbasis", "[", 
       RowBox[{"parketaylorlistlike", ",", "$1", ",", "$n"}], "]"}], "=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"list", "=", 
          RowBox[{"Level", "[", 
           RowBox[{"parketaylorlistlike", ",", 
            RowBox[{"{", 
             RowBox[{"-", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"cyclicity", "[", 
          RowBox[{"list", ",", "$1"}], "]"}], "//", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pot", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"#", ",", "$n"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "@", "list"}], "-", "pot"}], ")"}]}], 
             RowBox[{"Plus", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{"slot", ",", 
                  RowBox[{
                   RowBox[{"parketaylorlistlike", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "[", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "$1", "}"}], ",", "slot", ",", 
                    RowBox[{"{", "$n", "}"}]}], "]"}]}], "]"}]}], "]"}], "/@", 
                RowBox[{"shuffle", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"pot", "-", "1"}]}], "]"}], "]"}], ",", 
                  RowBox[{"Reverse", "@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pot", "+", "1"}], ";;"}], "]"}], "]"}]}]}], 
                 "]"}]}], ")"}]}]}]}], "]"}], "&"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fundamentalBCJ", "[", 
      RowBox[{
      "iii_Integer", ",", "ntotal_Integer", ",", "AnYM_", ",", "$s_", ",", 
       "$ss_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"fundamentalBCJ", "[", 
       RowBox[{"iii", ",", "ntotal", ",", "AnYM"}], "]"}], "=", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "calG", ",", "tposition", ",", "m", ",", "calF", ",", "pop"}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"calG", "[", 
           RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "<", "j"}], "||", 
             RowBox[{"j", "==", "1"}], "||", 
             RowBox[{"j", "==", "3"}]}], ",", 
            RowBox[{"$s", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", "0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tposition", "[", 
           RowBox[{"i_Integer", ",", "rho_List", ",", "m_Integer"}], "]"}], ":=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", 
             RowBox[{"m", "+", "1"}]}], ",", "0", ",", 
            RowBox[{"i", "\[Equal]", "3"}], ",", 
            RowBox[{"tposition", "[", 
             RowBox[{"5", ",", "rho", ",", "m"}], "]"}], ",", "True", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"rho", ",", "i"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", "\n", 
         RowBox[{
          RowBox[{"calF", "[", 
           RowBox[{"sigma_List", ",", "k_Integer", ",", "m_Integer"}], "]"}], 
          ":=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rho", "=", 
              RowBox[{"Flatten", "@", 
               RowBox[{"{", 
                RowBox[{"3", ",", "sigma", ",", "1"}], "}"}]}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tposition", "[", 
                 RowBox[{
                  RowBox[{"k", "-", "1"}], ",", "rho", ",", "m"}], "]"}], "<", 
                RowBox[{"tposition", "[", 
                 RowBox[{"k", ",", "rho", ",", "m"}], "]"}]}], ",", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"calG", "[", 
                  RowBox[{"k", ",", 
                   RowBox[{"rho", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"l", ",", 
                   RowBox[{"tposition", "[", 
                    RowBox[{"k", ",", "rho", ",", "m"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "sigma"}], 
                    "]"}]}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"calG", "[", 
                   RowBox[{"k", ",", 
                    RowBox[{"rho", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", 
                    RowBox[{"tposition", "[", 
                    RowBox[{"k", ",", "rho", ",", "m"}], "]"}]}], "}"}]}], 
                 "]"}]}]}], "]"}], "+", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"tposition", "[", 
                 RowBox[{
                  RowBox[{"k", "-", "1"}], ",", "rho", ",", "m"}], "]"}], "<", 
                RowBox[{"tposition", "[", 
                 RowBox[{"k", ",", "rho", ",", "m"}], "]"}], "<", 
                RowBox[{"tposition", "[", 
                 RowBox[{
                  RowBox[{"k", "+", "1"}], ",", "rho", ",", "m"}], "]"}]}], 
               ",", 
               RowBox[{"$ss", "[", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"4", ",", "k"}], "]"}], ",", "2"}], "]"}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"tposition", "[", 
                 RowBox[{
                  RowBox[{"k", "-", "1"}], ",", "rho", ",", "m"}], "]"}], ">", 
                RowBox[{"tposition", "[", 
                 RowBox[{"k", ",", "rho", ",", "m"}], "]"}], ">", 
                RowBox[{"tposition", "[", 
                 RowBox[{
                  RowBox[{"k", "+", "1"}], ",", "rho", ",", "m"}], "]"}]}], 
               ",", 
               RowBox[{"-", 
                RowBox[{"$ss", "[", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"4", ",", "k"}], "]"}], ",", "2"}], "]"}], 
                 "]"}]}], ",", "True", ",", "0"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pop", "[", 
           RowBox[{"alpha_", ",", "beta_"}], "]"}], ":=", 
          "\[IndentingNewLine]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"$beta", "=", 
              RowBox[{"{", "beta", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"$beta", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"slot", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Insert", "[", 
                    RowBox[{"slot", ",", 
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "#"}], "]"}], "&"}],
                     "/@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"$beta", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "+", "1"}], "]"}]}]}], 
                   "]"}], "/@", "$beta"}], "//", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", 
                 RowBox[{"Length", "@", "alpha"}]}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", "$beta"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"alpha", "=", 
              RowBox[{"Range", "[", 
               RowBox[{"4", ",", "iii"}], "]"}]}], ",", 
             RowBox[{"beta", "=", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"iii", "+", "1"}], ",", "ntotal"}], "]"}]}]}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"alpha", "===", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"AnYM", "@@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3", ",", "beta"}], "}"}]}]}], 
             ",", 
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"popblock", "=", 
                 RowBox[{"pop", "[", 
                  RowBox[{"alpha", ",", "beta"}], "]"}]}], "}"}], ",", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"AnYM", "@@", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2", ",", "3", ",", 
                    RowBox[{"popblock", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}]}], 
                  RowBox[{"Product", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"calF", "[", 
                    RowBox[{
                    RowBox[{"popblock", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "k", ",", 
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "/", 
                    RowBox[{"$ss", "[", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"4", ",", "k"}], "]"}], ",", "2"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "4", ",", 
                    RowBox[{"alpha", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "@", "popblock"}]}], "}"}]}], "]"}]}], 
              "]"}]}], "]"}]}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BCJbasis", "[", 
      RowBox[{"parketaylorlistlike_", ",", "$1_", ",", "$2_", ",", "$3_"}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"AnYM", ",", "$s", ",", "$ss", ",", 
         RowBox[{"list", "=", 
          RowBox[{"Level", "[", 
           RowBox[{"parketaylorlistlike", ",", 
            RowBox[{"{", 
             RowBox[{"-", "1"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"ntotal", "=", 
          RowBox[{"Length", "@", 
           RowBox[{"Level", "[", 
            RowBox[{"parketaylorlistlike", ",", 
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}]}], "]"}]}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"cyclicity", "[", 
         RowBox[{"list", ",", "$2"}], "]"}], "//", 
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"pot", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"#", ",", "$1"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "iii"}], "}"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "@", "list"}], "-", "pot"}], ")"}]}], 
            RowBox[{"Plus", "@@", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"slot", ",", 
                 RowBox[{
                  RowBox[{"iii", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"slot", ",", "$3"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "2"}]}], ";", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"fundamentalBCJ", "[", 
                    RowBox[{
                    "iii", ",", "ntotal", ",", "AnYM", ",", "$s", ",", 
                    "$ss"}], "]"}], "/.", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "@", "ntotal"}], ",", 
                    RowBox[{"ToExpression", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\"\<i\>\"", "<>", 
                    RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{"Range", "@", "ntotal"}]}], ")"}]}]}], "}"}]}], 
                    "]"}]}], "/.", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ToExpression", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\"\<i\>\"", "<>", 
                    RowBox[{"ToString", "[", "#", "]"}]}], "&"}], "/@", 
                    RowBox[{"Range", "@", "ntotal"}]}], ")"}]}], ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"$1", ",", "$2", ",", "$3", ",", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"slot", ",", 
                    RowBox[{"iii", "-", "2"}]}], "]"}]}], "}"}]}]}], "}"}]}], 
                    "]"}]}], "/.", 
                    RowBox[{"AnYM", "\[Rule]", " ", 
                    RowBox[{"parketaylorlistlike", "[", 
                    RowBox[{"[", "0", "]"}], "]"}]}]}], "/.", 
                    RowBox[{
                    RowBox[{"$s", "[", 
                    RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", "  ", 
                    SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]}]}]]}]}], "/.", 
                   RowBox[{
                    RowBox[{"$ss", "[", "$1list_", "]"}], "\[RuleDelayed]", 
                    "  ", 
                    SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "@", "$1list"}]}]]}]}]}]}], "]"}], 
               "\[IndentingNewLine]", "/@", 
               RowBox[{"shuffle", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ";;", 
                    RowBox[{"pot", "-", "1"}]}], "]"}], "]"}], ",", 
                 RowBox[{"Reverse", "@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"pot", "+", "1"}], ";;"}], "]"}], "]"}]}]}], 
                "]"}]}], ")"}]}]}]}], "]"}], "&"}]}]}], "]"}]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{
  3.687100278330181*^9, {3.6871004032451363`*^9, 3.6871004041156764`*^9}, {
   3.6871005239423*^9, 3.6871005254442716`*^9}, {3.722892599605239*^9, 
   3.722892622397236*^9}, {3.7256058527450943`*^9, 3.725605856655218*^9}, 
   3.725664245761207*^9, 3.736288125368169*^9, {3.7362885622946253`*^9, 
   3.736288566709729*^9}, {3.736682034087237*^9, 3.736682034544466*^9}, {
   3.737588167195366*^9, 3.737588180816313*^9}, {3.737588219240876*^9, 
   3.7375882239516973`*^9}, 3.7376355449126263`*^9, {3.7377517775005293`*^9, 
   3.737751780395814*^9}, {3.737855350371723*^9, 3.73785535097134*^9}, {
   3.738450698069771*^9, 3.738450700759438*^9}, {3.7415649280689287`*^9, 
   3.741564929433298*^9}, {3.7421898049283133`*^9, 3.74218981019621*^9}, {
   3.743845529462174*^9, 3.743845530040977*^9}, 3.7440646201499853`*^9, {
   3.772776434519438*^9, 3.772776434786881*^9}, {3.7731087875941477`*^9, 
   3.773108799617302*^9}, {3.792043796705125*^9, 3.792043838548607*^9}, {
   3.792045448632574*^9, 3.7920454826689796`*^9}, {3.79204601517379*^9, 
   3.792046015612899*^9}, 3.792046706916574*^9, {3.792046870215592*^9, 
   3.7920468837360153`*^9}, {3.792047312011075*^9, 3.792047314097597*^9}, {
   3.792048776722068*^9, 
   3.792048780584152*^9}},ExpressionUUID->"9f0aadb1-08d1-4e65-8e9b-\
6a9a867b4424"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", "fullcycle", "*)"}], "Subsection"], 
  StyleBox["\n", "Subsection"], 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"CenterDot", ",", "Orderless"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"cyclicity", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"i", ";;"}], "]"}], "]"}], "~", "Join", "~", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "#"}]}], "}"}]}], "]"}], "&"}]}], ";", 
     RowBox[{"SetAttributes", "[", 
      RowBox[{"CenterDot", ",", "Orderless"}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"shuffle", "[", 
       RowBox[{"list1_List", ",", "list2_List"}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Length", "@", "list1"}], "+", 
            RowBox[{"Length", "@", "list2"}]}], "]"}], " ", ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                    RowBox[{"Length", "@", "list1"}], "+", 
                    RowBox[{"Length", "@", "list2"}]}], "]"}], ",", "#"}], 
                 "]"}]}], "]"}], ",", 
              RowBox[{"Join", "[", 
               RowBox[{"list1", ",", "list2"}], "]"}]}], "}"}]}], "]"}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Length", "@", "list1"}], "+", 
           RowBox[{"Length", "@", "list2"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Length", "@", "list1"}], "}"}]}], "]"}]}]}], ";"}], "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunglasses", "[", 
     RowBox[{"AA_", ",", "chain_", ",", "BB_", ",", "full_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"sunglasses", "[", 
      RowBox[{"AA", ",", "chain", ",", "BB", ",", "full"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "AA"}], ">", "1"}], "&&", 
        RowBox[{
         RowBox[{"Length", "@", "BB"}], "==", "1"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"Length", "@", "chain"}]}], " ", 
        RowBox[{"sunglasses", "[", 
         RowBox[{"BB", ",", 
          RowBox[{"Reverse", "@", "chain"}], ",", "AA", ",", "full"}], 
         "]"}]}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "A", ",", "B", ",", "a", ",", "b", ",", "\[Alpha]", ",", "\[Beta]", 
           ",", "\[Beta]\[Beta]", ",", "\[Beta]\[Beta]\[Beta]", ",", "A1", 
           ",", "A2", ",", "B1", ",", "B2", ",", "subcyclePart", ",", 
           "pollywogPart", ",", "sunglassesPart"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A", "=", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"cyclicity", "@", "AA"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                RowBox[{"chain", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"B", "=", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"cyclicity", "@", "BB"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "\[Equal]", 
                RowBox[{"chain", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a", "=", 
           RowBox[{"A", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", 
          RowBox[{"b", "=", 
           RowBox[{"B", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "A"}], ">", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"subcyclePart", "=", 
              RowBox[{"Sum", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Alpha]", "=", 
                  RowBox[{"A", "[", 
                   RowBox[{"[", "\[Alpha]i", "]"}], "]"}]}], ";", 
                 RowBox[{"\[Beta]", "=", 
                  RowBox[{"B", "[", 
                   RowBox[{"[", "\[Beta]i", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"A1", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"A", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"\[Alpha]i", "-", "1"}]}], "]"}], "]"}]}]}], ";", 
                 RowBox[{"A2", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"A", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Alpha]i", "+", "1"}], ";;"}], "]"}], "]"}]}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"B1", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"B", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Beta]i", "+", "1"}], ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ";", 
                 RowBox[{"B2", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"B", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"\[Beta]i", "-", "1"}]}], "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", "A2"}], "+", 
                    RowBox[{"Length", "@", "B2"}]}], ")"}]}], 
                  RowBox[{"(*", 
                   SubscriptBox["nnn", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}]], "*)"}], 
                  RowBox[{
                   SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "]"}]}]], 
                   "/", 
                   SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "[", "A", "]"}]}]]}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"slot2", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"slot", ",", 
                    RowBox[{"-", " ", 
                    RowBox[{"subcycle", "[", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "chain"}], ",", 
                    RowBox[{"Sequence", "@@", "slot"}], ",", "\[Alpha]", ",", 
                    "\[Beta]", ",", 
                    RowBox[{"Sequence", "@@", "slot2"}]}], "]"}]}]}], "]"}], "/@", 
                    RowBox[{"shuffle", "[", 
                    RowBox[{"A1", ",", 
                    RowBox[{"Reverse", "@", "A2"}]}], "]"}]}], "//", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "#"}], "&"}]}]}], "]"}], "/@", 
                    RowBox[{"shuffle", "[", 
                    RowBox[{"B1", ",", 
                    RowBox[{"Reverse", "@", "B2"}]}], "]"}]}], "//", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "#"}], "&"}]}], ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]i", ",", "2", ",", 
                  RowBox[{"Length", "@", "A"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]i", ",", 
                  RowBox[{
                   RowBox[{"Length", "@", "B"}], "-", "1"}]}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"sunglassesPart", "=", 
              RowBox[{"Sum", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Alpha]", "=", 
                  RowBox[{"A", "[", 
                   RowBox[{"[", "\[Alpha]i", "]"}], "]"}]}], ";", 
                 RowBox[{"\[Beta]\[Beta]\[Beta]", "=", 
                  RowBox[{"chain", "[", 
                   RowBox[{"[", "\[Beta]\[Beta]\[Beta]i", "]"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"A1", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"A", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"\[Alpha]i", "-", "1"}]}], "]"}], "]"}]}]}], ";", 
                 RowBox[{"A2", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"A", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Alpha]i", "+", "1"}], ";;"}], "]"}], "]"}]}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"Length", "@", "A2"}], ")"}]}], 
                  RowBox[{"(*", 
                   SubscriptBox["nnn", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]\[Beta]\[Beta]"}]], 
                   "*)"}], 
                  RowBox[{
                   SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]\[Beta]\[Beta]"}], "}"}],
                     "]"}]}]], "/", 
                   SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "[", "A", "]"}]}]]}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"slot", ",", 
                    RowBox[{"-", 
                    RowBox[{"sunglasses", "[", " ", 
                    RowBox[{
                    RowBox[{"subcycle", "[", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"chain", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Beta]\[Beta]\[Beta]i", ";;"}], "]"}], "]"}]}], 
                    ",", 
                    RowBox[{"Sequence", "@@", "slot"}], ",", "\[Alpha]"}], 
                    "]"}], ",", 
                    RowBox[{"chain", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "\[Beta]\[Beta]\[Beta]i"}], "]"}], "]"}], 
                    ",", "B", ",", "full"}], "]"}]}]}], "]"}], "/@", 
                    RowBox[{"shuffle", "[", 
                    RowBox[{"A1", ",", 
                    RowBox[{"Reverse", "@", "A2"}]}], "]"}]}], "//", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "#"}], "&"}]}], ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]i", ",", "2", ",", 
                  RowBox[{"Length", "@", "A"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]\[Beta]\[Beta]i", ",", "2", ",", 
                  RowBox[{
                   RowBox[{"Length", "@", "chain"}], "-", "1"}]}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pollywogPart", "=", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Alpha]", "=", 
                  RowBox[{"A", "[", 
                   RowBox[{"[", "\[Alpha]i", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"A1", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"A", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"\[Alpha]i", "-", "1"}]}], "]"}], "]"}]}]}], ";", 
                 RowBox[{"A2", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"A", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Alpha]i", "+", "1"}], ";;"}], "]"}], "]"}]}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"\[Beta]\[Beta]", "=", 
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{"full", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "A"}], ",", 
                    RowBox[{"List", "@@", "B"}], ",", "chain"}], "]"}]}], 
                    "]"}], "[", 
                   RowBox[{"[", "\[Beta]\[Beta]i", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"Length", "@", "A2"}], ")"}]}], 
                  RowBox[{"(*", 
                   SubscriptBox["nnn", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]\[Beta]"}]], " ", "*)"}], 
                  RowBox[{
                   SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]\[Beta]"}], "}"}], 
                    "]"}]}]], "/", 
                   SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "[", "A", "]"}]}]]}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"slot", ",", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", "A"}], "+", 
                    RowBox[{"Length", "@", "chain"}]}], ")"}]}]}], " ", 
                    RowBox[{"pollywog", "[", 
                    RowBox[{"B", ",", 
                    RowBox[{"Reverse", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "chain"}], ",", 
                    RowBox[{"Sequence", "@@", "slot"}], ",", "\[Alpha]", ",", 
                    "\[Beta]\[Beta]"}], "}"}]}]}], "]"}]}]}], "]"}], "/@", 
                    RowBox[{"shuffle", "[", 
                    RowBox[{"A1", ",", 
                    RowBox[{"Reverse", "@", "A2"}]}], "]"}]}], "//", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "#"}], "&"}]}], ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Alpha]i", ",", "2", ",", 
                  RowBox[{"Length", "@", "A"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]\[Beta]i", ",", 
                  RowBox[{"Length", "@", 
                   RowBox[{"Complement", "[", 
                    RowBox[{"full", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "A"}], ",", 
                    RowBox[{"List", "@@", "B"}], ",", "chain"}], "]"}]}], 
                    "]"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
             "subcyclePart", "+", "sunglassesPart", "+", "pollywogPart"}]}], 
            ",", "\[IndentingNewLine]", 
            StyleBox[
             RowBox[{"(*", 
              RowBox[{"1", "-", 
               RowBox[{"length", " ", "cycle"}]}], "*)"}], "Text"], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"subcyclePart", "=", 
              RowBox[{"Sum", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Beta]", "=", 
                  RowBox[{"B", "[", 
                   RowBox[{"[", "\[Beta]i", "]"}], "]"}]}], ";", 
                 RowBox[{"B1", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"B", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"\[Beta]i", "+", "1"}], ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ";", 
                 RowBox[{"B2", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"B", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"\[Beta]i", "-", "1"}]}], "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"Length", "@", "B2"}], ")"}]}], 
                  RowBox[{"(*", 
                   SubscriptBox["nnn1", 
                    RowBox[{"a", ",", "\[Beta]"}]], "*)"}], 
                  RowBox[{
                   SubscriptBox["\[Epsilon]", "a"], "\[CenterDot]", 
                   SubscriptBox["k", "\[Beta]"]}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"slot2", ",", 
                    RowBox[{"-", 
                    RowBox[{"subcycle", "[", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "chain"}], ",", "\[Beta]", ",", 
                    RowBox[{"Sequence", "@@", "slot2"}]}], "]"}]}]}], "]"}], "/@", 
                    RowBox[{"shuffle", "[", 
                    RowBox[{"B1", ",", 
                    RowBox[{"Reverse", "@", "B2"}]}], "]"}]}], "//", 
                    RowBox[{
                    RowBox[{"Plus", "@@", "#"}], "&"}]}], ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]i", ",", 
                  RowBox[{
                   RowBox[{"Length", "@", "B"}], "-", "1"}]}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"sunglassesPart", "=", 
              RowBox[{"Sum", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Beta]\[Beta]\[Beta]", "=", 
                  RowBox[{"chain", "[", 
                   RowBox[{"[", "\[Beta]\[Beta]\[Beta]i", "]"}], "]"}]}], ";",
                  "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  SubscriptBox["nnn1", 
                   RowBox[{"a", ",", "\[Beta]\[Beta]\[Beta]"}]], "*)"}], 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Epsilon]", "a"], "\[CenterDot]", 
                   SubscriptBox["k", "\[Beta]\[Beta]\[Beta]"]}], " ", 
                  RowBox[{"(", 
                   RowBox[{"-", 
                    RowBox[{"sunglasses", "[", " ", 
                    RowBox[{
                    RowBox[{"subcycle", "[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"chain", "[", 
                    RowBox[{"[", 
                    RowBox[{"\[Beta]\[Beta]\[Beta]i", ";;"}], "]"}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"chain", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "\[Beta]\[Beta]\[Beta]i"}], "]"}], "]"}], 
                    ",", "B", ",", "full"}], "]"}]}], ")"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]\[Beta]\[Beta]i", ",", "2", ",", 
                  RowBox[{
                   RowBox[{"Length", "@", "chain"}], "-", "1"}]}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"pollywogPart", "=", 
              RowBox[{"Sum", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Beta]\[Beta]", "=", 
                  RowBox[{
                   RowBox[{"Complement", "[", 
                    RowBox[{"full", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "A"}], ",", 
                    RowBox[{"List", "@@", "B"}], ",", "chain"}], "]"}]}], 
                    "]"}], "[", 
                   RowBox[{"[", "\[Beta]\[Beta]i", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  SubscriptBox["nnn1", 
                   RowBox[{"a", ",", "\[Beta]\[Beta]"}]], "*)"}], 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["\[Epsilon]", "a"], "\[CenterDot]", 
                   SubscriptBox["k", "\[Beta]\[Beta]"]}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"Length", "@", "chain"}], ")"}]}], " ", 
                    RowBox[{"pollywog", "[", 
                    RowBox[{"B", ",", 
                    RowBox[{"Reverse", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "chain"}], ",", 
                    "\[Beta]\[Beta]"}], "}"}]}]}], "]"}]}], ")"}]}]}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"{", 
                 RowBox[{"\[Beta]\[Beta]i", ",", 
                  RowBox[{"Length", "@", 
                   RowBox[{"Complement", "[", 
                    RowBox[{"full", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "A"}], ",", 
                    RowBox[{"List", "@@", "B"}], ",", "chain"}], "]"}]}], 
                    "]"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
             "subcyclePart", "+", "sunglassesPart", "+", "pollywogPart"}]}]}],
            "\[IndentingNewLine]", "]"}]}]}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunglassesRecursion", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"slot", ",", "full"}], "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pow", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{"slot", ",", 
              RowBox[{"pollywog", "[", "__", "]"}]}], "]"}]}], ",", 
           RowBox[{"suc", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{"slot", ",", 
              RowBox[{"subcycle", "[", "__", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ",", "pot"}], "}"}],
          ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pow", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "suc"}], "\[Equal]", "0"}], ",", "slot", 
             ",", 
             RowBox[{
              RowBox[{"Length", "@", "suc"}], "\[Equal]", "1"}], ",", 
             RowBox[{"slot", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"suc", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
                RowBox[{"parketaylor", "@@", 
                 RowBox[{"suc", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"Length", "@", "suc"}], ">", "1"}], ",", 
             RowBox[{"slot", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"suc", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "\[Rule]", " ", "1"}], 
                ",", 
                RowBox[{
                 RowBox[{"suc", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], "\[Rule]", " ", 
                 RowBox[{"sunglasses", "[", 
                  RowBox[{
                   RowBox[{"suc", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"suc", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{"suc", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "1"}], "]"}], "]"}]}], "}"}], 
                   ",", 
                   RowBox[{"suc", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", "full"}], 
                  "]"}]}]}], "}"}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"pot", "=", 
             RowBox[{"Position", "[", 
              RowBox[{"suc", ",", 
               RowBox[{"pow", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
            ";", 
            RowBox[{"slot", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"pow", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", "1"}], ",", 
               RowBox[{
                RowBox[{"suc", "[", 
                 RowBox[{"[", 
                  RowBox[{"pot", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                "\[Rule]", " ", 
                RowBox[{"sunglasses", "[", 
                 RowBox[{
                  RowBox[{"pow", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"pow", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"suc", "[", 
                   RowBox[{"[", 
                    RowBox[{"pot", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  "full"}], "]"}]}]}], "}"}]}]}]}], "]"}]}], "]"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fullcycle", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "slot3", "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"$slot", "=", 
           RowBox[{"Expand", "@", "slot3"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"full", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "@", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Cases", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
                   "  ", 
                   RowBox[{"List", "[", "i", "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}]}], "&"}], "/@", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"$slot", ",", "_Plus"}], "]"}], ",", 
               RowBox[{"List", "@@", "$slot"}], ",", 
               RowBox[{"List", "@", "$slot"}]}], "]"}]}], "//", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"Union", "@", "#"}]}], "\[Equal]", "1"}], "&&", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"Union", "@", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Union", "@", "#"}]}]}]}], "\[Equal]", " ", 
                 RowBox[{"Length", "@", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"Union", "@", "#"}]}]}]}]}], ",", 
               RowBox[{"Flatten", "@", 
                RowBox[{"Union", "@", "#"}]}], ",", 
               RowBox[{"{", "}"}]}], "]"}], "&"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"full", "===", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<can't fullcycle\>\"", "]"}], ";", 
             "slot3"}], ",", 
            RowBox[{"NestWhile", "[", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"slot2", ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Expand", "@", 
                    RowBox[{"sunglassesRecursion", "[", 
                    RowBox[{"#", ",", "full"}], "]"}]}], "&"}], ",", "slot2", 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"slot2", ",", "_Plus"}], "]"}], ",", "1", ",", 
                    "0"}], "]"}], "}"}]}], "]"}]}], "]"}], ",", "$slot", ",", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"FreeQ", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"subcycle", "[", "__", "]"}]}], "]"}]}], "&"}]}], 
             "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], ";"}], "\n"}]}]], "Code",
 CellChangeTimes->{{3.6867461152185397`*^9, 3.6867461302996874`*^9}, {
   3.6868129168929186`*^9, 3.68681291777892*^9}, 3.6869694765931587`*^9, {
   3.686972863341854*^9, 3.6869729358525934`*^9}, {3.686973535804743*^9, 
   3.6869735371613607`*^9}, {3.686973617969118*^9, 3.686973625795563*^9}, {
   3.686973785489343*^9, 3.686973812928587*^9}, {3.6869739034074454`*^9, 
   3.6869739536003647`*^9}, {3.686985460083843*^9, 3.686985495738863*^9}, {
   3.6869855651019683`*^9, 3.6869856007094193`*^9}, {3.6869856850872183`*^9, 
   3.686985708179446*^9}, {3.686985744961012*^9, 3.686985799686187*^9}, {
   3.68698584226794*^9, 3.686985903484823*^9}, 3.686985987405351*^9, {
   3.686986108320046*^9, 3.6869861284622*^9}, {3.6869861601675*^9, 
   3.6869862475257607`*^9}, {3.686986305896207*^9, 3.6869863093106775`*^9}, 
   3.686986382100483*^9, 3.686986471015452*^9, 3.686986545542506*^9, 
   3.6869870296992054`*^9, 3.6869875118591413`*^9, 3.686995287046829*^9, 
   3.6869953680893564`*^9, {3.6869985775937757`*^9, 3.6869985906102047`*^9}, {
   3.6869989429207344`*^9, 3.68699894420444*^9}, {3.6870063771327653`*^9, 
   3.6870064264829025`*^9}, 3.6870103139066057`*^9, 3.6870835101179085`*^9, {
   3.6870835409136667`*^9, 3.68708354138881*^9}, {3.687083827062688*^9, 
   3.687083828245259*^9}, 3.687083863674438*^9, 3.687091601977935*^9, {
   3.687512262715803*^9, 3.6875122635306635`*^9}, 3.6891367627224264`*^9, {
   3.736682025119823*^9, 3.7366820284662323`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"ce4f864c-e20a-4ff5-b34e-2393ffaf6922"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", "phi3mand", "*)"}], "Subsection"], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"phi3mand", "[", 
      RowBox[{"list1_List", ",", "list2_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"psi", ",", "recpsi"}], "}"}], ",", " ", 
       RowBox[{
        RowBox[{"recpsi", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"psi", "[", 
            RowBox[{"listA_", ",", "listB_"}], "]"}], " ", "\[RuleDelayed]", 
           "  ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "@", "listA"}], "==", 
              RowBox[{"Sort", "@", "listB"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "listA", "]"}], "\[Equal]", "1"}], ",",
                "1", ",", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"s", "[", "listA", "]"}]}], " ", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"psi", "[", " ", 
                    RowBox[{
                    RowBox[{"listA", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "ii"}], "]"}], "]"}], ",", 
                    RowBox[{"listB", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "ii"}], "]"}], "]"}]}], " ", "]"}], " ", 
                    RowBox[{"psi", "[", " ", 
                    RowBox[{
                    RowBox[{"listA", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"ii", "+", "1"}], ";;"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"listB", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"ii", "+", "1"}], ";;"}], "]"}], "]"}]}], " ", 
                    "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"psi", "[", " ", 
                    RowBox[{
                    RowBox[{"listA", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "ii"}], "]"}], "]"}], " ", ",", " ", 
                    RowBox[{"listB", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "ii"}], ";;"}], "]"}], "]"}]}], " ", "]"}], 
                    " ", 
                    RowBox[{"psi", "[", " ", 
                    RowBox[{
                    RowBox[{"listA", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"ii", "+", "1"}], ";;"}], "]"}], "]"}], ",", 
                    RowBox[{"listB", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "ii"}], "-", "1"}]}], "]"}], "]"}]}], "  ", 
                    "]"}]}]}], " ", ",", 
                  RowBox[{"{", 
                   RowBox[{"ii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "listA", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}]}], "]"}], ",", "0"}], "]"}]}], " ", 
          "}"}]}], ";", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"s", "[", 
             RowBox[{"list1", "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], " ", 
            RowBox[{"psi", "[", 
             RowBox[{
              RowBox[{"list1", "[", 
               RowBox[{"[", 
                RowBox[{";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{"cyclicity", "[", 
                RowBox[{"list2", ",", 
                 RowBox[{"list1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ";;"}], "]"}], "]"}]}], "]"}]}], "//.", 
           "recpsi"}], "/.", 
          RowBox[{
           RowBox[{"s", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
           SubscriptBox["s", 
            RowBox[{"Sequence", "@@", "i"}]]}]}], "//", "Expand"}]}]}], 
      "]"}]}], ";"}], "\n", 
   StyleBox[
    RowBox[{"(*", "phi3diagram", "*)"}], "Subsection"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi3diagram", "[", 
     RowBox[{"expp_", ",", 
      RowBox[{"list__:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "startt", ",", "twoparts", ",", "position", ",", "med", ",", "$med", 
        ",", "pre", ",", "exp", ",", "ss", ",", "parlist"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"parlist", "=", 
        RowBox[{"Union", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"expp", ",", 
              RowBox[{
               SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
               RowBox[{"{", "i", "}"}]}], ",", "Infinity"}], "]"}], ",", 
            "list"}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"exp", "=", 
        RowBox[{
         RowBox[{"expp", "/.", 
          RowBox[{"s", "\[Rule]", " ", "ss"}]}], "/.", 
         RowBox[{
          RowBox[{
           SubscriptBox["ss", "i__"], "/;", 
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", 
              RowBox[{"parlist", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}]}], 
          "\[RuleDelayed]", " ", 
          SubscriptBox["ss", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Complement", "[", 
             RowBox[{"parlist", ",", 
              RowBox[{"{", "i", "}"}]}], "]"}]}]]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"twoparts", "[", "start_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "begin", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"begin", "=", "start"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "begin"}], "\[Equal]", "1"}], ",", 
             "begin", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Length", "@", "begin"}], "\[Equal]", "2"}], ",", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"begin", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "<", 
                 RowBox[{"Length", "@", 
                  RowBox[{"begin", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], "&&", " ", 
                RowBox[{
                 RowBox[{"Union", "@", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "\[Equal]", 
                 RowBox[{"begin", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
               RowBox[{"begin", "=", 
                RowBox[{"begin", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ";;"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"begin", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "<", 
                 RowBox[{"Length", "@", 
                  RowBox[{"begin", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], "&&", " ", 
                RowBox[{
                 RowBox[{"Union", "@", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "\[Equal]", 
                 RowBox[{"begin", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
               RowBox[{"begin", "=", 
                RowBox[{"begin", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", "1"}], "]"}], "]"}]}], ",", "True", ",", 
               "begin"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Length", "@", "begin"}], ">", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"While", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "begin"}], ">", "2"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"Or", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "<", 
                    RowBox[{"Length", "@", "#"}]}], "&&", " ", 
                    RowBox[{
                    RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "}"}]}]}], 
                    "\[Equal]", "#"}]}], "&"}], "/@", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], ",", 
                   RowBox[{"begin", "=", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ",", 
                   RowBox[{"begin", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"begin", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Which", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "<", 
                   RowBox[{"Length", "@", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "&&", " ", 
                  RowBox[{
                   RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "\[Equal]", 
                   RowBox[{"begin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
                 RowBox[{"begin", "=", 
                  RowBox[{"begin", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "<", 
                   RowBox[{"Length", "@", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "&&", " ", 
                  RowBox[{
                   RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "\[Equal]", 
                   RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
                 RowBox[{"begin", "=", 
                  RowBox[{"begin", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", "1"}], "]"}], "]"}]}], ",", "True", ",", 
                 "begin"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sort", "@", 
              RowBox[{"Select", "[", 
               RowBox[{"start", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "@", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "==", 
                  RowBox[{"begin", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ",", 
             RowBox[{"Sort", "@", 
              RowBox[{"Select", "[", 
               RowBox[{"start", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "@", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"begin", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "=!=", 
                  RowBox[{"begin", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
            "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"position", "[", "start_", "]"}], ":=", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "#"}], "\[Equal]", "2"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], " ", "+", 
                RowBox[{
                 RowBox[{"3", "/", "4"}], " ", "#"}]}], ",", 
               RowBox[{
                RowBox[{"Length", "@", "#"}], "\[Equal]", "3"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", "/", "4"}], 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", "/", "4"}], 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "+", "1"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{
                RowBox[{"Length", "@", "#"}], "\[Equal]", "4"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", "/", "4"}], 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"3", "/", "4"}], 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "+", "1"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], 
            ",", "  ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "\[Equal]", " ", "1"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], 
                 "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"position", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}], "//", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{
                    RowBox[{"twoparts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
                  RowBox[{"Append", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "4"}], ",", 
                    RowBox[{"3", "/", "4"}], ",", "1", ",", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                  "#"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"-", "2"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", " ", "0"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "#"}], "\[Equal]", "2"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], " ", "+", 
                  RowBox[{
                   RowBox[{"3", "/", "4"}], " ", "#"}]}], ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "#"}], "\[Equal]", "3"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"3", "/", "4"}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "+", "1"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"3", "/", "4"}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "+", "1"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "#"}], "\[Equal]", "4"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"3", "/", "4"}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "+", "1"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"3", "/", "4"}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "+", "1"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], 
              ",", "  ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", " ", "1"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "1"}], "]"}], "]"}]}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], 
                   "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"position", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}], "//", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{
                    RowBox[{"twoparts", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", "0"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "4"}], ",", 
                    RowBox[{"3", "/", "4"}], ",", "1", ",", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"twoparts", "@", "start"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    "#"}], "]"}], "&"}]}]}], "\[IndentingNewLine]", "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"-", "2"}], "}"}]}], "]"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pre", "[", "exppp_", "]"}], ":=", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"startt", "=", 
           RowBox[{"exppp", "//", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Denominator", "@", "#"}], ",", 
               RowBox[{
                SubscriptBox["ss", "i__"], "\[RuleDelayed]", " ", 
                RowBox[{"{", "i", "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "&"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "startt"}], "<", "1"}], ",", "exppp", ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Length", "@", "startt"}], "==", "1"}], ",", 
            "\[IndentingNewLine]", " ", 
            RowBox[{
             RowBox[{"Numerator", "@", "exppp"}], "  ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"Denominator", "@", "exppp"}]}], " ", "/.", 
               RowBox[{
                SubscriptBox["ss", "__"], "\[Rule]", " ", "1"}]}], ")"}], " ", 
             RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "7"}], "/", "4"}], ",", 
                    RowBox[{"7", "/", "4"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", 
                    RowBox[{"7", "/", "4"}]}], "}"}]}], "}"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "5"}]}], "}"}]}], "}"}], "]"}], 
                ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"startt", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "7"}], "/", "4"}], ",", 
                    RowBox[{"37", "/", "20"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"Text", "[", 
                 RowBox[{
                  RowBox[{"startt", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", 
                    RowBox[{"37", "/", "20"}]}], "}"}]}], "]"}]}], "}"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Length", "@", "startt"}], ">", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"med", "=", 
              RowBox[{"position", "[", "startt", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"$med", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Level", "[", 
                 RowBox[{"med", ",", 
                  RowBox[{"{", 
                   RowBox[{"-", "2"}], "}"}]}], "]"}], "//", 
                RowBox[{
                 RowBox[{"Select", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "\[Equal]", "4"}], "&"}]}], 
                  "]"}], "&"}]}], "//", 
               RowBox[{
                RowBox[{"med", "/.", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "\[Rule]", " ", 
                    RowBox[{"Sequence", "[", "]"}]}], "&"}], "/@", "#"}], 
                  ")"}]}], "&"}]}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", " ", 
             RowBox[{
              RowBox[{"Numerator", "@", "exppp"}], "  ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"Denominator", "@", "exppp"}]}], " ", "/.", 
                RowBox[{
                 SubscriptBox["ss", "__"], "\[Rule]", " ", "1"}]}], ")"}], 
              " ", 
              RowBox[{"Graphics", "@", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{"$med", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_"}], "}"}], ",", "_List", ",", 
                    "_List"}], "}"}], ",", "Infinity"}], "]"}], "//", 
                   RowBox[{
                    RowBox[{"Append", "[", 
                    RowBox[{"#", ",", "$med"}], "]"}], "&"}]}], "//", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Line", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Flatten", "@", "#"}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "2"}], "]"}], "]"}], "&"}], "/@", "#"}], 
                    ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1", ",", "3"}], "}"}], "]"}], "]"}], 
                    "]"}], "&"}], "/@", "#"}], "&"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Level", "[", 
                    RowBox[{"med", ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "2"}], "}"}]}], "]"}], "//", 
                   RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "\[Equal]", "3"}], "&"}]}], 
                    "]"}], "&"}]}], "//", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"1", "/", "10"}]}], "}"}]}]}], "]"}], "&"}], "/@",
                     "#"}], "&"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Level", "[", 
                    RowBox[{"med", ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "2"}], "}"}]}], "]"}], "//", 
                   RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "#"}], "\[Equal]", "4"}], "&"}]}], 
                    "]"}], "&"}]}], "//", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"1", "/", "10"}]}], "}"}]}]}], "]"}], "&"}], "/@",
                     "#"}], "&"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "5"}]}], "}"}]}], "}"}], "]"}], 
                   ",", 
                   RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{"parlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"-", "2"}], "/", "7"}]}], "}"}]}], "]"}]}], "}"}],
                  ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "parlist"}], "-", 
                    RowBox[{"Length", "@", 
                    RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", "startt"}]}]}]}], "\[Equal]", 
                    "2"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Text", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"parlist", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", "startt"}]}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"9", "/", "8"}]}], "}"}]}], "]"}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], "]"}]}]}]}]}], "]"}]}], 
         ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "exp"}], "\[Equal]", "1"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"exp", ",", "_Times"}], "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"exp", ",", "_Power"}], "]"}]}], ",", 
         RowBox[{"pre", "@", "exp"}], ",", 
         RowBox[{"pre", "/@", "exp"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.6867461152185397`*^9, 3.6867461302996874`*^9}, {
   3.6868129168929186`*^9, 3.68681291777892*^9}, 3.6869694765931587`*^9, {
   3.686972863341854*^9, 3.6869729358525934`*^9}, {3.686973535804743*^9, 
   3.6869735371613607`*^9}, {3.686973617969118*^9, 3.686973625795563*^9}, {
   3.686973785489343*^9, 3.686973812928587*^9}, {3.6869739034074454`*^9, 
   3.6869739536003647`*^9}, {3.686985460083843*^9, 3.686985495738863*^9}, {
   3.6869855651019683`*^9, 3.6869856007094193`*^9}, {3.6869856850872183`*^9, 
   3.686985708179446*^9}, {3.686985744961012*^9, 3.686985799686187*^9}, {
   3.68698584226794*^9, 3.686985903484823*^9}, 3.686985987405351*^9, {
   3.686986108320046*^9, 3.6869861284622*^9}, {3.6869861601675*^9, 
   3.6869862475257607`*^9}, {3.686986305896207*^9, 3.6869863093106775`*^9}, 
   3.686986382100483*^9, 3.686986471015452*^9, 3.686986545542506*^9, 
   3.6869870296992054`*^9, 3.6869875118591413`*^9, 3.686995287046829*^9, 
   3.6869953680893564`*^9, {3.6869985775937757`*^9, 3.6869985906102047`*^9}, {
   3.6869989429207344`*^9, 3.68699894420444*^9}, {3.6870063771327653`*^9, 
   3.6870064264829025`*^9}, 3.6870103139066057`*^9, 3.6870835101179085`*^9, {
   3.6870835409136667`*^9, 3.68708354138881*^9}, {3.687083827062688*^9, 
   3.687083828245259*^9}, 3.687083863674438*^9, {3.687091601977935*^9, 
   3.687091644597803*^9}, 3.692082520349681*^9, {3.6920837468233194`*^9, 
   3.6920837484510994`*^9}, 3.714388229974295*^9, 3.714438448253621*^9, {
   3.725670250618833*^9, 3.725670252301256*^9}, {3.725670566335766*^9, 
   3.7256705823024282`*^9}, {3.773108493881639*^9, 3.77310856534487*^9}, {
   3.773108645564581*^9, 3.773108677122048*^9}, {3.77310884395368*^9, 
   3.773108846913281*^9}, 3.773117845351639*^9, 
   3.773133635316848*^9},ExpressionUUID->"0347b7c8-9753-481c-99d6-\
917cfaed8cb5"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", "trace", "*)"}], "Subsection"], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"CenterDot", ",", "Orderless"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reduceCenterDot", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ex__", "\[CenterDot]", 
         RowBox[{"(", 
          RowBox[{"i__", " ", "j_Integer"}], ")"}]}], "\[RuleDelayed]", 
        RowBox[{"j", " ", 
         RowBox[{"ex", "\[CenterDot]", 
          RowBox[{"Times", "[", "i", "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"ex__", "\[CenterDot]", 
         RowBox[{"(", 
          RowBox[{"i__", " ", "j_CenterDot"}], ")"}]}], "\[RuleDelayed]", 
        RowBox[{"j", " ", 
         RowBox[{"ex", "\[CenterDot]", 
          RowBox[{"Times", "[", "i", "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"ex__", "\[CenterDot]", 
         RowBox[{"(", 
          RowBox[{"i__", " ", "j_Power"}], ")"}]}], "\[RuleDelayed]", 
        RowBox[{"j", " ", 
         RowBox[{"ex", "\[CenterDot]", 
          RowBox[{"Times", "[", "i", "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"ex__", "\[CenterDot]", 
         RowBox[{"(", 
          RowBox[{"i__", " ", "j_Plus"}], ")"}]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ex", "\[CenterDot]", 
            RowBox[{"(", 
             RowBox[{"#1", " ", "i"}], ")"}]}], "&"}], ")"}], "/@", "j"}]}], 
       ",", 
       RowBox[{
        RowBox[{"ex__", "\[CenterDot]", "i_Plus"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ex", "\[CenterDot]", "#1"}], "&"}], ")"}], "/@", "i"}]}], 
       ",", 
       RowBox[{
        RowBox[{"ex__", "\[CenterDot]", 
         RowBox[{"(", 
          RowBox[{"i__", " ", "j_Rational"}], ")"}]}], "\[RuleDelayed]", 
        RowBox[{"j", " ", 
         RowBox[{"ex", "\[CenterDot]", 
          RowBox[{"Times", "[", "i", "]"}]}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tracefieldstrength", "[", "f_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fieldstrength", ",", "operate1", ",", "operate"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fieldstrength", "[", "i_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["k", "i"], ",", 
             SubscriptBox["\[Epsilon]", "i"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["\[Epsilon]", "i"]}], ",", 
             SubscriptBox["k", "i"]}], "}"}]}], "}"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"operate1", " ", "[", 
          RowBox[{"ff_List", ",", "g_List"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ff", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ff", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[CenterDot]", 
                RowBox[{
                 RowBox[{"g", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], " ", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "ff", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], " ", "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"operate", "[", "i_List", "]"}], ":=", 
         RowBox[{"Fold", "[", 
          RowBox[{"operate1", ",", 
           RowBox[{"fieldstrength", "[", 
            RowBox[{"i", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"fieldstrength", "/@", 
            RowBox[{"(", 
             RowBox[{"i", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "i", "]"}], "-", "1"}], "]"}]}], 
               "]"}], "]"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[CenterDot]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "//.", "reduceCenterDot"}], 
           "&"}], "/@", 
          RowBox[{"operate", "@", "f"}]}], "//", 
         RowBox[{
          RowBox[{"Plus", "@@", "#"}], "&"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"eekkdotfieldstrength", "[", 
      RowBox[{"aa_", ",", "f_List", ",", "bb_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fieldstrength", ",", "operate1", ",", "operate"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fieldstrength", "[", "i_", "]"}], ":=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["k", "i"], ",", 
             SubscriptBox["\[Epsilon]", "i"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["\[Epsilon]", "i"]}], ",", 
             SubscriptBox["k", "i"]}], "}"}]}], "}"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"operate1", " ", "[", 
          RowBox[{"ff_List", ",", "g_List"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"ff", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ff", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[CenterDot]", 
                RowBox[{
                 RowBox[{"g", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], " ", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "ff", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "g", "]"}]}], "}"}]}], " ", "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"operate", "[", "i_List", "]"}], ":=", 
         RowBox[{"Fold", "[", 
          RowBox[{"operate1", ",", 
           RowBox[{"fieldstrength", "[", 
            RowBox[{"i", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"fieldstrength", "/@", 
            RowBox[{"(", 
             RowBox[{"i", "[", 
              RowBox[{"[", 
               RowBox[{"1", "+", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "i", "]"}], "-", "1"}], "]"}]}], 
               "]"}], "]"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"aa", "\[CenterDot]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[CenterDot]", "bb"}]}], "//.",
             "reduceCenterDot"}], "&"}], "/@", 
          RowBox[{"operate", "@", "f"}]}], "//", 
         RowBox[{
          RowBox[{"Plus", "@@", "#"}], "&"}]}]}]}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"reducecdot", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"cdot", "[", "ii__", "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"{", "ii", "}"}]}], "\[Equal]", "2"}], ",", 
          RowBox[{"CenterDot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "ii", "}"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", "ii", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"eekkdotfieldstrength", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "ii", "}"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", "ii", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", ";;", 
                RowBox[{"-", "2"}]}], ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", "ii", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"trace", "[", "ii__", "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"tracefieldstrength", "[", 
         RowBox[{
          RowBox[{"{", "ii", "}"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.6867461152185397`*^9, 3.6867461302996874`*^9}, {
   3.6868129168929186`*^9, 3.68681291777892*^9}, 3.6869694765931587`*^9, {
   3.686972863341854*^9, 3.6869729358525934`*^9}, {3.686973535804743*^9, 
   3.6869735371613607`*^9}, {3.686973617969118*^9, 3.686973625795563*^9}, {
   3.686973785489343*^9, 3.686973812928587*^9}, {3.6869739034074454`*^9, 
   3.6869739536003647`*^9}, {3.686985460083843*^9, 3.686985495738863*^9}, {
   3.6869855651019683`*^9, 3.6869856007094193`*^9}, {3.6869856850872183`*^9, 
   3.686985708179446*^9}, {3.686985744961012*^9, 3.686985799686187*^9}, {
   3.68698584226794*^9, 3.686985903484823*^9}, 3.686985987405351*^9, {
   3.686986108320046*^9, 3.6869861284622*^9}, {3.6869861601675*^9, 
   3.6869862475257607`*^9}, {3.686986305896207*^9, 3.6869863093106775`*^9}, 
   3.686986382100483*^9, 3.686986471015452*^9, 3.686986545542506*^9, 
   3.6869870296992054`*^9, 3.6869875118591413`*^9, 3.686995287046829*^9, 
   3.6869953680893564`*^9, {3.6869985775937757`*^9, 3.6869985906102047`*^9}, {
   3.6869989429207344`*^9, 3.68699894420444*^9}, {3.6870063771327653`*^9, 
   3.6870064264829025`*^9}, 3.6870103139066057`*^9, 3.6870835101179085`*^9, {
   3.6870835409136667`*^9, 3.68708354138881*^9}, {3.687083827062688*^9, 
   3.687083828245259*^9}, 3.687083863674438*^9, {3.687091601977935*^9, 
   3.687091611735571*^9}, {3.693307599219858*^9, 3.693307621333061*^9}, {
   3.70026114210149*^9, 3.700261149863366*^9}, 3.7169436758161716`*^9, 
   3.7169529738200865`*^9, {3.716954127636796*^9, 3.7169541824804316`*^9}, {
   3.716961332676459*^9, 3.7169614140597095`*^9}, {3.716974640570696*^9, 
   3.7169746621266713`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"66f8ccbb-caa0-43c7-974c-750d7c6a330d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"crossfunction", "[", 
    RowBox[{"list1_", ",", "list2_", ",", 
     RowBox[{"fun_:", "List"}]}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"fun", "[", 
        RowBox[{
         RowBox[{"list1", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"list2", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "list1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "@", "list2"}]}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mypartition", "[", 
    RowBox[{"list_", ",", "ii_", ",", 
     RowBox[{"fill_:", "0"}]}], "]"}], ":=", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Length", "@", "list"}], ",", "ii", ",", "0"}], "]"}], "===", 
      "0"}], ",", 
     RowBox[{"Partition", "[", 
      RowBox[{"list", ",", "ii"}], "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"fill", "===", "0"}], ",", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{"list", ",", "ii"}], "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"Length", "@", "list"}], ",", "ii", ",", "0"}], 
              "]"}]}], ";;"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"list", ",", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{
             RowBox[{"{", "afewfhhoawpfi", "}"}], ",", 
             RowBox[{"ii", "-", 
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"Length", "@", "list"}], ",", "ii", ",", "0"}], 
               "]"}]}]}], "]"}]}], "]"}], ",", "ii"}], "]"}]}], "]"}]}], 
    "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Pf", "[", "A_", "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{
     RowBox[{"Length", "[", "A", "]"}], ",", "0", ",", "1", ",", 
     RowBox[{"_", "?", "OddQ"}], ",", "0", ",", 
     RowBox[{"_", "?", "EvenQ"}], ",", 
     RowBox[{"xPf", "[", "A", "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xPf", "[", "A_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "A", "]"}], "\[Equal]", "2"}], ",", 
     RowBox[{"A", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "i"], " ", 
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
        RowBox[{"xPf", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"Delete", "[", 
              RowBox[{"A", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{"{", "i", "}"}]}], "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", "i", "}"}]}], "}"}]}], "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.7142978381680565`*^9, 3.71429784153567*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"5de668f0-77c4-4b74-a5d2-5581cd782964"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{"YM", " ", "GR", " ", "BI", " ", 
     RowBox[{"F", "^", "3"}], " ", "amplitudes", " ", "analytic"}], " ", 
    "*)"}], "Subsubsection"], 
  StyleBox["\[IndentingNewLine]", "Subsubsection"], 
  StyleBox["\[IndentingNewLine]", "Subsubsection"], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"subcycleset", "[", "list_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Times", "@@", 
           RowBox[{"$line", "@@@", 
            RowBox[{"Transpose", "@", 
             RowBox[{"{", 
              RowBox[{"list", ",", "#"}], "}"}]}]}]}], "&"}], "/@", " ", 
         RowBox[{"Permutations", "@", "list"}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "/.", 
           RowBox[{"$line", "\[Rule]", " ", "line"}]}], "/.", 
          RowBox[{"sub", "\[Rule]", " ", "subcycle"}]}], "&"}]}], "//", 
       "Total"}], "//", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "@", "#"}], "\[Equal]", "Plus"}], ",", " ", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"sl", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "@", "list"}], "-", 
                RowBox[{"Length", "@", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"sl", ",", "_subcycle", ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}]}]}], 
               ")"}]}], "sl"}]}], "]"}], "/@", "#"}], ",", "#"}], "]"}], 
       "&"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AmpYManalytic", "[", "list_List", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"subcycleset", "@", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}]}], "/.", 
        RowBox[{
         RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", "i", "}"}], ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"cyclicity", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", "i", "}"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"list", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "}"}]}], ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], 
              RowBox[{"cdot", "[", 
               RowBox[{
                SubscriptBox["\[Epsilon]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]], ",", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}], ",", 
                SubscriptBox["\[Epsilon]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]]}], "]"}], " ", 
              RowBox[{"subcycle", "@@", "#"}]}], "&"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
             RowBox[{"subcycle", "[", "i", "]"}], ",", 
             RowBox[{
              RowBox[{"1", "/", "2"}], 
              RowBox[{"trace", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["f", "#"], "&"}], "/@", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"{", "i", "}"}]}]}], ")"}]}], " ", 
              RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}], "]"}]}]}], "//",
        "fullcycle"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "/.", 
         RowBox[{
          RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
          RowBox[{"KKbasis", "[", 
           RowBox[{
            RowBox[{"parketaylor", "[", "i", "]"}], ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"phi3mand", "[", 
          RowBox[{"list", ",", 
           RowBox[{"{", "i", "}"}]}], " ", "]"}]}]}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpGRanalytic", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", "=", 
        RowBox[{"Range", "@", "n"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"subcycleset", "@", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}]}], "/.", 
          RowBox[{
           RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", "i", "}"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"cyclicity", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", "i", "}"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "}"}]}], ",", 
                RowBox[{"list", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", "2"}], 
                RowBox[{"cdot", "[", 
                 RowBox[{
                  SubscriptBox["\[Epsilon]", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]], ",", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}], ",", 
                  SubscriptBox["\[Epsilon]", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]]}], "]"}], " ", 
                RowBox[{"subcycle", "@@", "#"}]}], "&"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
               RowBox[{"subcycle", "[", "i", "]"}], ",", 
               RowBox[{
                RowBox[{"1", "/", "2"}], 
                RowBox[{"trace", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", "i", "}"}]}]}], ")"}]}], " ", 
                RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}], "]"}]}]}], "//",
          "fullcycle"}], "//", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
           RowBox[{"KKbasis", "[", 
            RowBox[{
             RowBox[{"parketaylor", "[", "i", "]"}], ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "&"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"#", "^", "2"}], "]"}], "/.", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], "^", "2"}], 
            "\[RuleDelayed]", " ", 
            RowBox[{"phi3mand", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", 
              RowBox[{"{", "i", "}"}]}], " ", "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], 
             RowBox[{"parketaylor", "[", "j__", "]"}]}], "\[RuleDelayed]", 
            " ", 
            RowBox[{"phi3mand", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", 
              RowBox[{"{", "j", "}"}]}], " ", "]"}]}]}], "}"}]}], "&"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpBIanalytic", "[", "n_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"EvenQ", "@", "n"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"list", "=", 
          RowBox[{"Range", "@", "n"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"subcycleset", "@", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], "]"}], "]"}]}], "/.", 
              RowBox[{
               RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"{", "i", "}"}], ",", 
                   RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"cyclicity", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "}"}]}], ",", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"cdot", "[", 
                    RowBox[{
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}], ",", 
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]]}], "]"}], " ", 
                    RowBox[{"subcycle", "@@", "#"}]}], "&"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
                   RowBox[{"subcycle", "[", "i", "]"}], ",", 
                   RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{"trace", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "i", "}"}]}]}], ")"}]}], " ", 
                    RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}], 
                "]"}]}]}], "//", "fullcycle"}], "//", 
            RowBox[{
             RowBox[{"#", "/.", 
              RowBox[{
               RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", 
               " ", 
               RowBox[{"KKbasis", "[", 
                RowBox[{
                 RowBox[{"parketaylor", "[", "i", "]"}], ",", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "&"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"subcycleset", "@", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", 
                   RowBox[{"-", "3"}]}], "]"}], "]"}]}], "/.", 
               RowBox[{
                RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", "0", 
                  ",", 
                  RowBox[{
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["k", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}]], "\[CenterDot]", 
                    SubscriptBox["k", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], ",", "1"}], "]"}], "]"}], 
                    "]"}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}]}], "}"}]}], "]"}], " ", 
                   RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}]}], "//", 
              RowBox[{
               RowBox[{"#", " ", 
                RowBox[{"subcycle", "[", 
                 RowBox[{
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "&"}]}], "//",
              "fullcycle"}], "//", 
            RowBox[{
             RowBox[{"#", "/.", 
              RowBox[{
               RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", 
               " ", 
               RowBox[{"KKbasis", "[", 
                RowBox[{
                 RowBox[{"parketaylor", "[", "i", "]"}], ",", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "&"}]}], 
           ")"}]}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "@", "#"}], "/.", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"parketaylor", "[", "i__", "]"}], "^", "2"}], 
              "\[RuleDelayed]", " ", 
              RowBox[{"phi3mand", "[", 
               RowBox[{
                RowBox[{"{", "i", "}"}], ",", 
                RowBox[{"{", "i", "}"}]}], " ", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"parketaylor", "[", "i__", "]"}], 
               RowBox[{"parketaylor", "[", "j__", "]"}]}], "\[RuleDelayed]", 
              " ", 
              RowBox[{"phi3mand", "[", 
               RowBox[{
                RowBox[{"{", "i", "}"}], ",", 
                RowBox[{"{", "j", "}"}]}], " ", "]"}]}]}], "}"}]}], "&"}]}]}],
        "]"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AmpF3analytic", "[", "list_List", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"subcycleset", "@", "list"}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", "_Times"}], "]"}], ",", 
               RowBox[{"Length", "@", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"Length", "/@", 
                   RowBox[{"List", "@@", "#"}]}], ",", 
                  RowBox[{
                   RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}], ",", "1"}], 
              "]"}], "#"}], "&"}], "/@", "#"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"#", "/.", 
          RowBox[{
           RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
             RowBox[{"subcycle", "[", "i", "]"}], ",", 
             RowBox[{
              RowBox[{"1", "/", "2"}], 
              RowBox[{"trace", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["f", "#"], "&"}], "/@", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"{", "i", "}"}]}]}], ")"}]}], " ", 
              RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}]}], "&"}]}], "//",
        "fullcycle"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "/.", 
         RowBox[{
          RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
          RowBox[{"KKbasis", "[", 
           RowBox[{
            RowBox[{"parketaylor", "[", "i", "]"}], ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "/.", 
        RowBox[{
         RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"phi3mand", "[", 
          RowBox[{"list", ",", 
           RowBox[{"{", "i", "}"}]}], " ", "]"}]}]}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpR2analytic", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", "=", 
        RowBox[{"Range", "@", "n"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"subcycleset", "@", "list"}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{"#", ",", "_Times"}], "]"}], ",", 
                   RowBox[{"Length", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Length", "/@", 
                    RowBox[{"List", "@@", "#"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}], ",", "1"}], 
                  "]"}], "#"}], "&"}], "/@", "#"}], "&"}]}], "//", 
            RowBox[{
             RowBox[{"#", "/.", 
              RowBox[{
               RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
                 RowBox[{"subcycle", "[", "i", "]"}], ",", 
                 RowBox[{
                  RowBox[{"1", "/", "2"}], 
                  RowBox[{"trace", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "i", "}"}]}]}], ")"}]}], " ", 
                  RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}]}], "&"}]}],
            "//", "fullcycle"}], "//", 
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
             RowBox[{"KKbasis", "[", 
              RowBox[{
               RowBox[{"parketaylor", "[", "i", "]"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "&"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"subcycleset", "@", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}]}], "/.", 
            RowBox[{
             RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "i", "}"}], ",", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"cyclicity", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", "i", "}"}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", " ", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"list", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "}"}]}], ",", 
                  RowBox[{"list", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "2"}], 
                  RowBox[{"cdot", "[", 
                   RowBox[{
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}], ",", 
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]]}], "]"}], " ", 
                  RowBox[{"subcycle", "@@", "#"}]}], "&"}]}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
                 RowBox[{"subcycle", "[", "i", "]"}], ",", 
                 RowBox[{
                  RowBox[{"1", "/", "2"}], 
                  RowBox[{"trace", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "i", "}"}]}]}], ")"}]}], " ", 
                  RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}], "]"}]}]}],
            "//", "fullcycle"}], "//", 
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
             RowBox[{"KKbasis", "[", 
              RowBox[{
               RowBox[{"parketaylor", "[", "i", "]"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "&"}]}], ")"}]}],
        "//", 
       RowBox[{
        RowBox[{
         RowBox[{"Expand", "@", "#"}], "/.", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], "^", "2"}], 
            "\[RuleDelayed]", " ", 
            RowBox[{"phi3mand", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", 
              RowBox[{"{", "i", "}"}]}], " ", "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], 
             RowBox[{"parketaylor", "[", "j__", "]"}]}], "\[RuleDelayed]", 
            " ", 
            RowBox[{"phi3mand", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", 
              RowBox[{"{", "j", "}"}]}], " ", "]"}]}]}], "}"}]}], "&"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpR3analytic", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", "=", 
        RowBox[{"Range", "@", "n"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"subcycleset", "@", "list"}], "//", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{"#", ",", "_Times"}], "]"}], ",", 
                  RowBox[{"Length", "@", 
                   RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Length", "/@", 
                    RowBox[{"List", "@@", "#"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}], ",", "1"}], 
                 "]"}], "#"}], "&"}], "/@", "#"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
                RowBox[{"subcycle", "[", "i", "]"}], ",", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], 
                 RowBox[{"trace", "@@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["f", "#"], "&"}], "/@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "i", "}"}]}]}], ")"}]}], " ", 
                 RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}]}], "&"}]}], 
          "//", "fullcycle"}], "//", 
         RowBox[{
          RowBox[{"#", "/.", 
           RowBox[{
            RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
            RowBox[{"KKbasis", "[", 
             RowBox[{
              RowBox[{"parketaylor", "[", "i", "]"}], ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"-", "2"}], "]"}], "]"}], ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "&"}]}], ")"}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"#", "^", "2"}], "]"}], "/.", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], "^", "2"}], 
            "\[RuleDelayed]", " ", 
            RowBox[{"phi3mand", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", 
              RowBox[{"{", "i", "}"}]}], " ", "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], 
             RowBox[{"parketaylor", "[", "j__", "]"}]}], "\[RuleDelayed]", 
            " ", 
            RowBox[{"phi3mand", "[", 
             RowBox[{
              RowBox[{"{", "i", "}"}], ",", 
              RowBox[{"{", "j", "}"}]}], " ", "]"}]}]}], "}"}]}], "&"}]}]}], 
     "]"}]}], "\n", 
   RowBox[{
    RowBox[{"AmpDBIpurescalaranalytic", "[", "n_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"EvenQ", "@", "n"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"list", "=", 
          RowBox[{"Range", "@", "n"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"subcycleset", "@", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"-", "3"}]}], "]"}], "]"}]}], "/.", 
              RowBox[{
               RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", 
                   RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", "0", 
                 ",", 
                 RowBox[{
                  RowBox[{"Product", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "@", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], ",", "1"}], "]"}]}], "}"}], 
                    "]"}], "]"}]}]}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}]}], "}"}]}], "]"}], " ", 
                  RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}]}], "//", 
             RowBox[{
              RowBox[{"#", " ", 
               RowBox[{"subcycle", "[", 
                RowBox[{
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "&"}]}], "//",
             "fullcycle"}], "//", 
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
              RowBox[{"KKbasis", "[", 
               RowBox[{
                RowBox[{"parketaylor", "[", "i", "]"}], ",", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                RowBox[{"list", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "&"}]}], ")"}], 
         "//", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"#", "^", "2"}], "]"}], "/.", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"parketaylor", "[", "i__", "]"}], "^", "2"}], 
               "\[RuleDelayed]", " ", 
               RowBox[{"phi3mand", "[", 
                RowBox[{
                 RowBox[{"{", "i", "}"}], ",", 
                 RowBox[{"{", "i", "}"}]}], " ", "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"parketaylor", "[", "i__", "]"}], 
                RowBox[{"parketaylor", "[", "j__", "]"}]}], "\[RuleDelayed]", 
               " ", 
               RowBox[{"phi3mand", "[", 
                RowBox[{
                 RowBox[{"{", "i", "}"}], ",", 
                 RowBox[{"{", "j", "}"}]}], " ", "]"}]}]}], "}"}]}], "/.", 
           RowBox[{
            SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"{", "i", "}"}]}], "<", 
               RowBox[{"n", "/", "2"}]}], ",", 
              SubscriptBox["s", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Sort", "@", 
                 RowBox[{"{", "i", "}"}]}]}]], ",", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"{", "i", "}"}]}], ">", 
               RowBox[{"n", "/", "2"}]}], ",", 
              SubscriptBox["s", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Complement", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", "i", "}"}]}], "]"}]}]], ",", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"{", "i", "}"}]}], "==", 
               RowBox[{"n", "/", "2"}]}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", "i", "}"}], ",", 
                  RowBox[{"Min", "@", "list"}]}], "]"}], ",", 
                SubscriptBox["s", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"Sort", "@", 
                   RowBox[{"{", "i", "}"}]}]}]], ",", 
                SubscriptBox["s", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"Complement", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}]]}], "]"}]}], "]"}]}]}],
           "&"}]}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AmpsGalanalytic", "[", "n_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"EvenQ", "@", "n"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"list", "=", 
           RowBox[{"Range", "@", "n"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"subcycleset", "@", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", 
                    RowBox[{"-", "3"}]}], "]"}], "]"}]}], "/.", 
                RowBox[{
                 RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", "0", 
                   ",", 
                   RowBox[{
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    SubscriptBox["s", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "@", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], ",", "1"}], "]"}]}], "}"}], 
                    "]"}], "]"}]}]}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}]}], "}"}]}], "]"}], " ", 
                    RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}]}], "//", 
               RowBox[{
                RowBox[{"#", " ", 
                 RowBox[{"subcycle", "[", 
                  RowBox[{
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                   RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "&"}]}], "//",
               "fullcycle"}], "//", 
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", 
                " ", 
                RowBox[{"KKbasis", "[", 
                 RowBox[{
                  RowBox[{"parketaylor", "[", "i", "]"}], ",", 
                  RowBox[{"list", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"list", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "&"}]}], "//", 
            RowBox[{
             RowBox[{"#", "^", "2"}], "&"}]}], "//", "Expand"}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"parketaylor", "[", "ii__", "]"}], "^", "2"}], 
                "\[RuleDelayed]", " ", 
                RowBox[{"phi3mand", "[", 
                 RowBox[{
                  RowBox[{"{", "ii", "}"}], ",", 
                  RowBox[{"{", "ii", "}"}]}], " ", "]"}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"parketaylor", "[", "ii__", "]"}], 
                 RowBox[{"parketaylor", "[", "jj__", "]"}]}], 
                "\[RuleDelayed]", " ", 
                RowBox[{"phi3mand", "[", 
                 RowBox[{
                  RowBox[{"{", "ii", "}"}], ",", 
                  RowBox[{"{", "jj", "}"}]}], " ", "]"}]}]}], "}"}]}], "/.", 
            RowBox[{
             SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"{", "i", "}"}]}], "<", 
                RowBox[{"n", "/", "2"}]}], ",", 
               SubscriptBox["s", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Sort", "@", 
                  RowBox[{"{", "i", "}"}]}]}]], ",", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"{", "i", "}"}]}], ">", 
                RowBox[{"n", "/", "2"}]}], ",", 
               SubscriptBox["s", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"list", ",", 
                   RowBox[{"{", "i", "}"}]}], "]"}]}]], ",", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"{", "i", "}"}]}], "==", 
                RowBox[{"n", "/", "2"}]}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"{", "i", "}"}], ",", 
                   RowBox[{"Min", "@", "list"}]}], "]"}], ",", 
                 SubscriptBox["s", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Sort", "@", 
                    RowBox[{"{", "i", "}"}]}]}]], ",", 
                 SubscriptBox["s", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"Complement", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}]]}], "]"}]}], "]"}]}]}],
            "&"}]}]}], "]"}], ",", "0"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AmpNLSManalytic", "[", "list_List", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"EvenQ", "@", 
        RowBox[{"Length", "@", "list"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"subcycleset", "@", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"-", "3"}]}], "]"}], "]"}]}], "/.", 
           RowBox[{
            RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", "0", ",", 
              RowBox[{
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"1", "/", "2"}], 
                  SubscriptBox["s", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Sort", "@", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], ",", "1"}], "]"}]}], "}"}], 
                    "]"}], "]"}]}]}]]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}]}], "}"}]}], "]"}], " ", 
               RowBox[{"subcycle", "[", "i", "]"}]}]}], "]"}]}]}], "//", 
          RowBox[{
           RowBox[{"#", " ", 
            RowBox[{"subcycle", "[", 
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"-", "2"}], "]"}], "]"}], ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "&"}]}], "//", 
         "fullcycle"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "/.", 
            RowBox[{
             RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
             RowBox[{"KKbasis", "[", 
              RowBox[{
               RowBox[{"parketaylor", "[", "i", "]"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}], ",", 
               RowBox[{"list", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"parketaylor", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
            RowBox[{"phi3mand", "[", 
             RowBox[{"list", ",", 
              RowBox[{"{", "i", "}"}]}], " ", "]"}]}]}], "/.", 
          RowBox[{
           SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"{", "i", "}"}]}], "<", 
              RowBox[{"n", "/", "2"}]}], ",", 
             SubscriptBox["s", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"Sort", "@", 
                RowBox[{"{", "i", "}"}]}]}]], ",", 
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"{", "i", "}"}]}], ">", 
              RowBox[{"n", "/", "2"}]}], ",", 
             SubscriptBox["s", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"Complement", "[", 
                RowBox[{"list", ",", 
                 RowBox[{"{", "i", "}"}]}], "]"}]}]], ",", 
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"{", "i", "}"}]}], "==", 
              RowBox[{"n", "/", "2"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"{", "i", "}"}], ",", 
                 RowBox[{"Min", "@", "list"}]}], "]"}], ",", 
               SubscriptBox["s", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Sort", "@", 
                  RowBox[{"{", "i", "}"}]}]}]], ",", 
               SubscriptBox["s", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Complement", "[", 
                  RowBox[{"list", ",", 
                   RowBox[{"{", "i", "}"}]}], "]"}]}]]}], "]"}]}], "]"}]}]}], 
         "&"}]}], ",", "0"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"AmpYMBerendsGiele", "[", 
     RowBox[{"list_List", ",", 
      RowBox[{"$1_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"calF", ",", "calA"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"calF", "[", "Ylist_List", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Rlist", ",", "Slist"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["k", 
               RowBox[{"Sequence", "@@", "Ylist"}]], ",", 
              RowBox[{"calA", "[", "Ylist", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"calA", "[", "Ylist", "]"}], ",", 
              RowBox[{"-", 
               SubscriptBox["k", 
                RowBox[{"Sequence", "@@", "Ylist"}]]}]}], "}"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Rlist", "=", 
                 RowBox[{"Ylist", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", "ii"}], "]"}], "]"}]}], ";", 
                RowBox[{"Slist", "=", 
                 RowBox[{"Ylist", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"ii", "+", "1"}], ";;"}], "]"}], "]"}]}], ";", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"calA", "[", "Rlist", "]"}]}], ",", 
                    RowBox[{"calA", "[", "Slist", "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"calA", "[", "Slist", "]"}], ",", 
                    RowBox[{"calA", "[", "Rlist", "]"}]}], "}"}]}], "}"}]}]}],
                "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "Ylist"}], "-", "1"}]}], "}"}]}], 
              "]"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"calA", "[", "Plist_List", "]"}], ":=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "Plist"}], "==", "1"}], ",", 
          SubscriptBox["\[Epsilon]", 
           RowBox[{"Sequence", "@@", "Plist"}]], ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Xlist", ",", "Ylist"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", 
              SubscriptBox["s", 
               RowBox[{"Sequence", "@@", "Plist"}]]}], 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Xlist", "=", 
                 RowBox[{"Plist", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", "ii"}], "]"}], "]"}]}], ";", 
                RowBox[{"Ylist", "=", 
                 RowBox[{"Plist", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"ii", "+", "1"}], ";;"}], "]"}], "]"}]}], ";", 
                RowBox[{
                 RowBox[{
                  RowBox[{"calA", "[", "Xlist", "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["k", 
                    RowBox[{"Sequence", "@@", "Xlist"}]], "\[CenterDot]", 
                    RowBox[{"calA", "[", "Ylist", "]"}]}], ")"}]}], "+", 
                 RowBox[{"(", 
                  RowBox[{"Plus", "@@", 
                   RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"calA", "[", "Xlist", "]"}], "\[CenterDot]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", 
                    RowBox[{"calF", "[", "Ylist", "]"}]}], ")"}]}], ")"}], 
                 "-", "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"calA", "[", "Ylist", "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["k", 
                    RowBox[{"Sequence", "@@", "Ylist"}]], "\[CenterDot]", 
                    RowBox[{"calA", "[", "Xlist", "]"}]}], ")"}]}], 
                   "\[IndentingNewLine]", "+", 
                   RowBox[{"(", 
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"calA", "[", "Ylist", "]"}], "\[CenterDot]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}], "/@", 
                    RowBox[{"calF", "[", "Xlist", "]"}]}], ")"}]}], ")"}]}], 
                  ")"}]}]}], "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", 
                 RowBox[{
                  RowBox[{"Length", "@", "Plist"}], "-", "1"}]}], "}"}]}], 
              "]"}]}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["s", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{";;", 
                 RowBox[{"-", "2"}]}], "]"}], "]"}]}]], 
            RowBox[{"calA", "[", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}]}], ")"}], 
          "\[CenterDot]", 
          RowBox[{"calA", "[", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}], "]"}], "]"}], "]"}]}], "//.", 
         "reduceCenterDot"}], "//", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"$1", "\[Equal]", "1"}], ",", "#", ",", 
           RowBox[{
            RowBox[{"#", "/.", 
             RowBox[{
              SubscriptBox["k", "i__"], "\[RuleDelayed]", " ", 
              RowBox[{"Sum", "[", 
               RowBox[{
                SubscriptBox["k", 
                 RowBox[{
                  RowBox[{"{", "i", "}"}], "[", 
                  RowBox[{"[", "jj", "]"}], "]"}]], ",", 
                RowBox[{"{", 
                 RowBox[{"jj", ",", 
                  RowBox[{"Length", "@", 
                   RowBox[{"{", "i", "}"}]}]}], "}"}]}], "]"}]}]}], "//.", 
            "reduceCenterDot"}]}], "]"}], "&"}]}]}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7169501751450434`*^9, 3.7169501907362194`*^9}, 
   3.7169504116803417`*^9, {3.716950481426933*^9, 3.7169505624227314`*^9}, {
   3.716950751548133*^9, 3.716950798256098*^9}, 3.7169508410480967`*^9, {
   3.716951620138713*^9, 3.7169516331740556`*^9}, {3.7169608235114336`*^9, 
   3.716960846607187*^9}, {3.7169608955031443`*^9, 3.7169609471423445`*^9}, {
   3.716966110714511*^9, 3.7169661355699043`*^9}, 3.716966173382741*^9, 
   3.7169662236156054`*^9, 3.7169662552878327`*^9, 3.717233124674306*^9, {
   3.717233160450937*^9, 3.717233169022539*^9}, {3.804221842368092*^9, 
   3.804221847551179*^9}},ExpressionUUID->"18e7cee1-e688-489f-ac59-\
bd5d23b855e0"],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.7434634524185047`*^9},
 CellLabel->
  "In[210]:=",ExpressionUUID->"534cbd9c-ba87-41a4-9f6f-e93d13ad4cce"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", "Numeric", "*)"}], "Title"], 
  StyleBox["\n", "Title"], 
  StyleBox["\n", "Title"], 
  StyleBox["\n", "Subsubsection"], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"4", "d"}], " ", ",", " ", 
     RowBox[{"6", "d", "  ", "spinors", " ", "and", " ", 
      SuperscriptBox["p", "\[Mu]"], " ", 
      SuperscriptBox["\[Epsilon]", "\[Mu]"]}]}], " ", "*)"}], "Subsubsection"],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"spinorrandom", "[", 
     RowBox[{"n_", ",", "4", ",", 
      RowBox[{"reference_:", "True"}], ",", 
      RowBox[{"$100_:", "100"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Lambda]4d", ",", "t\[Lambda]4d", ",", "x", ",", "\[Lambda]4dref", 
        ",", "t\[Lambda]4dref", ",", "medd", ",", "start", ",", "med"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", ">", "3"}], ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "eff", "}"}], ",", 
           RowBox[{
            RowBox[{"Label", "[", "eff", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[Lambda]4d", "=", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "$100"}], ",", "$100"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "2"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"t\[Lambda]4d", "=", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"RandomInteger", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "$100"}], ",", "$100"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"n", "-", "2"}], ",", "2"}], "}"}]}], "]"}], ",", 
                RowBox[{"Array", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "]"}], "//", 
              RowBox[{
               RowBox[{"#", "/.", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Lambda]4d", "\[LeftDoubleBracket]", 
                    RowBox[{"a", ",", "i"}], "\[RightDoubleBracket]"}], 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"a", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "n"}], "}"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "//", 
                   "Flatten"}], "]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "&"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Times", "@@", 
                RowBox[{"(", 
                 RowBox[{"Det", "/@", 
                  RowBox[{"Subsets", "[", 
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"Goto", "[", "eff", "]"}]}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"n", "==", "3"}], ",", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "eff", "}"}], ",", 
             RowBox[{
              RowBox[{"Label", "[", "eff", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"medd", "=", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "$100"}], ",", "$100"}], "}"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"t\[Lambda]4d", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"medd", "#"}], "&"}], "/@", 
                RowBox[{"RandomSample", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", "10"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "~", "Join", "~", 
                   RowBox[{"Range", "[", 
                    RowBox[{"1", ",", "10"}], "]"}]}], ",", "3"}], "]"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"\[Lambda]4d", "=", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"RandomInteger", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "$100"}], ",", "$100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
                  RowBox[{"Array", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "]"}], "//", 
                RowBox[{
                 RowBox[{"#", "/.", 
                  RowBox[{
                   RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"t\[Lambda]4d", "\[LeftDoubleBracket]", 
                    RowBox[{"a", ",", "i"}], "\[RightDoubleBracket]"}], 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"a", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "n"}], "}"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "//", 
                    "Flatten"}], "]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "&"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Times", "@@", 
                  RowBox[{"(", 
                   RowBox[{"Det", "/@", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"\[Lambda]4d", ",", 
                    RowBox[{"t\[Lambda]4d", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "1"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}], "\[Equal]", 
                 "0"}], ",", 
                RowBox[{"Goto", "[", "eff", "]"}]}], "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "eff", "}"}], ",", 
             RowBox[{
              RowBox[{"Label", "[", "eff", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"medd", "=", 
               RowBox[{"RandomInteger", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "$100"}], ",", "$100"}], "}"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Lambda]4d", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"medd", "#"}], "&"}], "/@", 
                RowBox[{"RandomSample", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"-", "10"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "~", "Join", "~", 
                   RowBox[{"Range", "[", 
                    RowBox[{"1", ",", "10"}], "]"}]}], ",", "3"}], "]"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"t\[Lambda]4d", "=", 
               RowBox[{
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"RandomInteger", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "$100"}], ",", "$100"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
                  RowBox[{"Array", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], "]"}], "//", 
                RowBox[{
                 RowBox[{"#", "/.", 
                  RowBox[{
                   RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Lambda]4d", "\[LeftDoubleBracket]", 
                    RowBox[{"a", ",", "i"}], "\[RightDoubleBracket]"}], 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"a", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", 
                    RowBox[{"Abs", "@", "n"}]}], "}"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "//", 
                    "Flatten"}], "]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "&"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Times", "@@", 
                  RowBox[{"(", 
                   RowBox[{"Det", "/@", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"t\[Lambda]4d", ",", 
                    RowBox[{"\[Lambda]4d", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "1"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}], "\[Equal]", 
                 "0"}], ",", 
                RowBox[{"Goto", "[", "eff", "]"}]}], "]"}]}]}], "]"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"reference", "===", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"start", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "start"}], "\[LessEqual]", " ", 
             RowBox[{"2", 
              RowBox[{"Abs", "@", "n"}]}]}], ",", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"med", "=", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "$100"}], ",", "$100"}], "}"}], ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Times", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Det", "@", 
                    RowBox[{"{", 
                    RowBox[{"med", ",", "#"}], "}"}]}], "&"}], "/@", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    "\[Lambda]4d", ",", "t\[Lambda]4d", ",", "start"}], 
                    "]"}]}], ")"}]}], "\[NotEqual]", " ", "0"}]}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"start", ",", "med"}], "]"}]}], "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]4dTn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"\[Lambda]4d", ",", 
          RowBox[{"start", "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"Abs", "@", "n"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       RowBox[{"t\[Lambda]4dTn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"t\[Lambda]4d", ",", 
          RowBox[{"start", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "@", "n"}], "+", "1"}], ";;"}], "]"}], "]"}]}], 
         "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "}"}]}]}], "]"}]}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"spinorrandom", "[", "n_", "]"}], ":=", 
     RowBox[{"spinorrandom", "[", 
      RowBox[{"n", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"spinorrandom", "[", 
     RowBox[{"n_", ",", "6", ",", 
      RowBox[{"reference_:", "True"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sigma0", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"sigma1", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"sigma2", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "I"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"I", ",", "0"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"sigma3", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", "sigma", ",", 
        "directproduct", ",", "tsigma", ",", "pAB", ",", "tpAB", ",", 
        "\[Lambda]6dd", ",", "t\[Lambda]6dd", ",", "momenta", ",", "$0", ",", 
        "x", ",", "\[Lambda]6d", ",", "t\[Lambda]6d", ",", "\[Lambda]6dref", 
        ",", "t\[Lambda]6dref"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"directproduct", "[", 
         RowBox[{"sigma1_", ",", "sigma2_"}], "]"}], ":=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"sigma1", "/.", 
               RowBox[{"{", 
                RowBox[{"0", "\[Rule]", " ", "$0"}], "}"}]}], ")"}], "x"}], "/.", 
            RowBox[{"x", "\[Rule]", "  ", "sigma2"}]}], "/.", 
           RowBox[{"$0", "\[Rule]", " ", "0"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        SubscriptBox["sigma", "0"], "=", 
        RowBox[{"I", " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma1", ",", "sigma2"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["sigma", "1"], "=", 
        RowBox[{"I", " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma2", ",", "sigma3"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["sigma", "2"], "=", 
        RowBox[{"-", " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma2", ",", "sigma0"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["sigma", "3"], "=", 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma2", ",", "sigma1"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["sigma", "4"], "=", 
        RowBox[{"-", " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma3", ",", "sigma2"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["sigma", "5"], "=", 
        RowBox[{"I", " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma0", ",", "sigma2"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["tsigma", "0"], "=", 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma1", ",", "sigma2"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["tsigma", "1"], "=", 
        RowBox[{"I", " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma2", ",", "sigma3"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["tsigma", "2"], "=", " ", 
        RowBox[{"directproduct", "[", 
         RowBox[{"sigma2", ",", "sigma0"}], "]"}]}], ";", 
       RowBox[{
        SubscriptBox["tsigma", "3"], "=", 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma2", ",", "sigma1"}], "]"}]}]}], ";", 
       RowBox[{
        SubscriptBox["tsigma", "4"], "=", " ", 
        RowBox[{"directproduct", "[", 
         RowBox[{"sigma3", ",", "sigma2"}], "]"}]}], ";", 
       RowBox[{
        SubscriptBox["tsigma", "5"], "=", 
        RowBox[{"I", " ", 
         RowBox[{"directproduct", "[", 
          RowBox[{"sigma0", ",", "sigma2"}], "]"}]}]}], ";", 
       RowBox[{
        RowBox[{"pAB", "[", "$1_", "]"}], ":=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"momenta", "[", 
            RowBox[{"[", 
             RowBox[{"$1", ",", "i"}], "]"}], "]"}], 
           SubscriptBox["tsigma", 
            RowBox[{"i", "-", "1"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"tpAB", "[", "$1_", "]"}], ":=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"momenta", "[", 
            RowBox[{"[", 
             RowBox[{"$1", ",", "i"}], "]"}], "]"}], 
           SubscriptBox["sigma", 
            RowBox[{"i", "-", "1"}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"\[Lambda]6dd", "[", "$1_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Lambda]\[Lambda]6d", ",", "\[Lambda]", ",", "A", ",", "B", ",", 
            "a", ",", "b"}], "}"}], ",", 
          RowBox[{
           RowBox[{"\[Lambda]\[Lambda]6d", "=", 
            RowBox[{"Array", "[", 
             RowBox[{"\[Lambda]", ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "2"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"\[Lambda]\[Lambda]6d", "/.", 
            RowBox[{
             RowBox[{"FindInstance", "[", 
              RowBox[{
               RowBox[{"Flatten", "@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Lambda]\[Lambda]6d", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", ",", "a"}], "]"}], "]"}]}], 
                    RowBox[{"\[Lambda]\[Lambda]6d", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", ",", "b"}], "]"}], "]"}], 
                    RowBox[{"Signature", "[", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "2"}], "}"}]}], "]"}], "==", 
                   RowBox[{
                    RowBox[{"pAB", "[", "$1", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"A", ",", "B"}], "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"A", ",", "3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"B", ",", 
                    RowBox[{"A", "+", "1"}], ",", "4"}], "}"}]}], "]"}]}], 
               ",", 
               RowBox[{"Flatten", "@", "\[Lambda]\[Lambda]6d"}], ",", "2", 
               ",", 
               RowBox[{"RandomSeed", "\[Rule]", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}]}]}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}]}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"t\[Lambda]6dd", "[", "$1_", "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Lambda]\[Lambda]6d", ",", "\[Lambda]", ",", "A", ",", "B", ",", 
            "a", ",", "b"}], "}"}], ",", 
          RowBox[{
           RowBox[{"\[Lambda]\[Lambda]6d", "=", 
            RowBox[{"Array", "[", 
             RowBox[{"\[Lambda]", ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "2"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"\[Lambda]\[Lambda]6d", "/.", 
            RowBox[{
             RowBox[{"FindInstance", "[", 
              RowBox[{
               RowBox[{"Flatten", "@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Lambda]\[Lambda]6d", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", ",", "a"}], "]"}], "]"}], 
                    RowBox[{"\[Lambda]\[Lambda]6d", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", ",", "b"}], "]"}], "]"}], 
                    RowBox[{"Signature", "[", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "b"}], "}"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{"tpAB", "[", "$1", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"A", ",", "B"}], "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"A", ",", "3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"B", ",", 
                    RowBox[{"A", "+", "1"}], ",", "4"}], "}"}]}], "]"}]}], 
               ",", 
               RowBox[{"Flatten", "@", "\[Lambda]\[Lambda]6d"}], ",", "2", 
               ",", 
               RowBox[{"RandomSeed", "\[Rule]", 
                RowBox[{"RandomInteger", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "10"}], ",", "10"}], "}"}], "]"}]}]}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}]}]}], "]"}]}], ";", 
       RowBox[{"momenta", "=", 
        RowBox[{"momentamurandom", "[", 
         RowBox[{"n", ",", "6"}], "]"}]}], ";", 
       RowBox[{"\[Lambda]6d", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\[Lambda]6dd", "[", "$1", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"$1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"t\[Lambda]6d", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"t\[Lambda]6dd", "[", "$1", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"$1", ",", "n"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"reference", "===", "True"}], ",", 
         RowBox[{
          RowBox[{"momenta", "=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"eff2", ",", "ppre"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Label", "[", "eff2", "]"}], ";", 
              RowBox[{"ppre", "=", 
               RowBox[{"momentamurandom", "[", 
                RowBox[{"n", ",", "6"}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Or", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}], "==", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Except", "[", "0", "]"}]}], "]"}], "/", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Except", "[", "0", "]"}]}], "]"}]}], "]"}]}], 
                    "\[Equal]", "1"}]}], "&"}], "/@", 
                   RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"ppre", ",", "momenta"}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}], ",", 
                RowBox[{"Goto", "[", "eff2", "]"}]}], "]"}], ";", "ppre"}]}], 
            "]"}]}], ";", 
          RowBox[{"\[Lambda]6dref", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"\[Lambda]6dd", "[", "$1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"$1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"t\[Lambda]6dref", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"t\[Lambda]6dd", "[", "$1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"$1", ",", "n"}], "}"}]}], "]"}]}], ";", 
          RowBox[{"\[Lambda]6dTn", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"\[Lambda]6d", ",", "\[Lambda]6dref"}], "]"}]}], ";", 
          RowBox[{"t\[Lambda]6dTn", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"t\[Lambda]6d", ",", "t\[Lambda]6dref"}], "]"}]}]}]}], 
        "]"}], ";", 
       RowBox[{"{", 
        RowBox[{"\[Lambda]6d", ",", "t\[Lambda]6d"}], "}"}]}]}], "]"}]}], 
   "\n", "\n", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "When", " ", "reference", " ", "was", " ", "chosen", " ", "to", " ", 
       "be", " ", "True"}], ",", " ", 
      RowBox[{
      "the", " ", "reference", " ", "are", " ", "generated", " ", "carried", 
       " ", "in", " ", "\[Lambda]4dTn"}], ",", "t\[Lambda]4dTn", ",", 
      "\[Lambda]6dTn", ",", 
      RowBox[{
      "t\[Lambda]6dTn", " ", "while", " ", "the", " ", "output", " ", "of", 
       " ", "spinorrandom", " ", 
       RowBox[{"doesn", "'"}], "t", " ", "change"}]}], "*)"}], "Text"], "\n", 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ab4d", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "@", "\[Lambda]4dTn"}], "===", "List"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Lambda]4dTn", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
         RowBox[{"\[Lambda]4dTn", "[", 
          RowBox[{"[", 
           RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"\[Lambda]4dTn", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "2"}], "]"}], "]"}], 
         RowBox[{"\[Lambda]4dTn", "[", 
          RowBox[{"[", 
           RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Lambda]4dTn", "[", 
          RowBox[{"a", ",", "1"}], "]"}], " ", 
         RowBox[{"\[Lambda]4dTn", "[", 
          RowBox[{"b", ",", "2"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"\[Lambda]4dTn", "[", 
          RowBox[{"a", ",", "2"}], "]"}], 
         RowBox[{"\[Lambda]4dTn", "[", 
          RowBox[{"b", ",", "1"}], "]"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sb4d", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "@", "t\[Lambda]4dTn"}], "===", "List"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"t\[Lambda]4dTn", "[", 
           RowBox[{"[", 
            RowBox[{"a", ",", "1"}], "]"}], "]"}]}], " ", 
         RowBox[{"t\[Lambda]4dTn", "[", 
          RowBox[{"[", 
           RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"t\[Lambda]4dTn", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
         RowBox[{"t\[Lambda]4dTn", "[", 
          RowBox[{"[", 
           RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"t\[Lambda]4dTn", "[", 
           RowBox[{"a", ",", "1"}], "]"}]}], " ", 
         RowBox[{"t\[Lambda]4dTn", "[", 
          RowBox[{"b", ",", "2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"t\[Lambda]4dTn", "[", 
          RowBox[{"a", ",", "2"}], "]"}], " ", 
         RowBox[{"t\[Lambda]4dTn", "[", 
          RowBox[{"b", ",", "1"}], "]"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"amsb4d", "[", "i__", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ab4d", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"i", "[", 
            RowBox[{"[", "i2", "]"}], "]"}]}], "]"}], 
         RowBox[{"sb4d", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"i", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "2", ",", 
          RowBox[{
           RowBox[{"Length", "[", "i", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ammab4d", "[", 
      RowBox[{"i1__", ",", "i2__"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ab4d", "[", 
         RowBox[{
          RowBox[{"i1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
        RowBox[{"sb4d", "[", 
         RowBox[{
          RowBox[{"i1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"i2", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
        RowBox[{"ab4d", "[", 
         RowBox[{
          RowBox[{"i2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"i2", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "i1", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"Length", "[", "i2", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"smmsb4d", "[", 
      RowBox[{"i1__", ",", "i2__"}], "]"}], ":=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sb4d", "[", 
         RowBox[{
          RowBox[{"i1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"i1", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
        RowBox[{"ab4d", "[", 
         RowBox[{
          RowBox[{"i1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"i2", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
        RowBox[{"sb4d", "[", 
         RowBox[{
          RowBox[{"i2", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"i2", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "i1", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"Length", "[", "i2", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"asb6d", "[", 
      RowBox[{"i_", ",", "j_", ",", "a_", ",", "bd_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Head", "@", "\[Lambda]6dTn"}], "===", "List"}], "&&", 
        RowBox[{
         RowBox[{"Head", "@", "t\[Lambda]6dTn"}], "===", "List"}]}], ",", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Lambda]6dTn", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", ";;", ",", "a"}], "]"}], "]"}], 
          RowBox[{"t\[Lambda]6dTn", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", ";;", ",", "bd"}], "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Lambda]6dTn", "[", 
           RowBox[{"i", ",", ";;", ",", "a"}], "]"}], 
          RowBox[{"t\[Lambda]6dTn", "[", 
           RowBox[{"j", ",", ";;", ",", "bd"}], "]"}]}], ")"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ab6d", "[", 
     RowBox[{
     "i_", ",", "j_", ",", "$k_", ",", "$l_", ",", "a_", ",", "b_", ",", "c_",
       ",", "d_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "@", "\[Lambda]6dTn"}], "===", "List"}], ",", 
      RowBox[{"Det", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]6dTn", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;", ",", "a"}], "]"}], "]"}], ",", 
         RowBox[{"\[Lambda]6dTn", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", ";;", ",", "b"}], "]"}], "]"}], ",", 
         RowBox[{"\[Lambda]6dTn", "[", 
          RowBox[{"[", 
           RowBox[{"$k", ",", ";;", ",", "c"}], "]"}], "]"}], ",", 
         RowBox[{"\[Lambda]6dTn", "[", 
          RowBox[{"[", 
           RowBox[{"$l", ",", ";;", ",", "d"}], "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Det", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]6dTn", "[", 
          RowBox[{"i", ",", ";;", ",", "a"}], "]"}], ",", 
         RowBox[{"\[Lambda]6dTn", "[", 
          RowBox[{"j", ",", ";;", ",", "b"}], "]"}], ",", 
         RowBox[{"\[Lambda]6dTn", "[", 
          RowBox[{"$k", ",", ";;", ",", "c"}], "]"}], ",", 
         RowBox[{"\[Lambda]6dTn", "[", 
          RowBox[{"$l", ",", ";;", ",", "d"}], "]"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sb6d", "[", 
     RowBox[{
     "i_", ",", "j_", ",", "$k_", ",", "$l_", ",", "ad_", ",", "bd_", ",", 
      "cd_", ",", "dd_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "@", "t\[Lambda]6dTn"}], "===", "List"}], ",", 
      RowBox[{"Det", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t\[Lambda]6dTn", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;", ",", "ad"}], "]"}], "]"}], ",", 
         RowBox[{"t\[Lambda]6dTn", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", ";;", ",", "bd"}], "]"}], "]"}], ",", 
         RowBox[{"t\[Lambda]6dTn", "[", 
          RowBox[{"[", 
           RowBox[{"$k", ",", ";;", ",", "cd"}], "]"}], "]"}], ",", 
         RowBox[{"t\[Lambda]6dTn", "[", 
          RowBox[{"[", 
           RowBox[{"$l", ",", ";;", ",", "dd"}], "]"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"Det", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t\[Lambda]6dTn", "[", 
          RowBox[{"i", ",", ";;", ",", "ad"}], "]"}], ",", 
         RowBox[{"t\[Lambda]6dTn", "[", 
          RowBox[{"j", ",", ";;", ",", "bd"}], "]"}], ",", 
         RowBox[{"t\[Lambda]6dTn", "[", 
          RowBox[{"$k", ",", ";;", ",", "cd"}], "]"}], ",", 
         RowBox[{"t\[Lambda]6dTn", "[", 
          RowBox[{"$l", ",", ";;", ",", "dd"}], "]"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"We", " ", 
       RowBox[{"reserve", " ", "'"}], 
       RowBox[{
        RowBox[{"ab", "'"}], " ", "'"}], 
       RowBox[{"sb", "'"}], " ", "as", " ", "an", " ", "abstract", " ", 
       "symbol", " ", "and", " ", "choose", " ", "notation", " ", "ab4d", " ",
        "sb4d", " ", "ab3d", " ", "ab6d", " ", "sb6d", " ", "for", " ", 
       "numeric", " ", 
       RowBox[{"calculation", ".", " ", "All"}], " ", "these", " ", "numeric",
        " ", "calculation", " ", "are", " ", "based", " ", "on", "  ", 
       "\[Lambda]4dTn"}], ",", "t\[Lambda]4dTn", ",", "\[Lambda]6dTn", ",", 
      "t\[Lambda]6dTn", ",", "\[Lambda]3dTn", ",", " ", 
      RowBox[{
      "which", " ", "are", " ", "generated", " ", "by", " ", "spinorrandom", 
       " ", "by", " ", "default", " ", "or", " ", "one", " ", "can", " ", 
       "himself", " ", "define", " ", 
       RowBox[{"them", "."}]}]}], "*)"}], "Text"], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"s4d", "[", "set__", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "set", "}"}]}]}], "}"}], ",", 
       RowBox[{"Sum", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"ab", "[", 
            RowBox[{
             RowBox[{"i", "[", 
              RowBox[{"[", "a", "]"}], "]"}], ",", 
             RowBox[{"i", "[", 
              RowBox[{"[", "b", "]"}], "]"}]}], "]"}]}], " ", 
          RowBox[{"sb", "[", 
           RowBox[{
            RowBox[{"i", "[", 
             RowBox[{"[", "a", "]"}], "]"}], ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "b", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"Length", "@", "i"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", 
           RowBox[{"a", "+", "1"}], ",", 
           RowBox[{"Length", "@", "i"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"s6d", "[", "set__", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "set", "}"}]}]}], "}"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Det", "@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"asb", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "ii", "]"}], "]"}], ",", 
               RowBox[{"i", "[", 
                RowBox[{"[", "jj", "]"}], "]"}], ",", "a", ",", "bd"}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"bd", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Length", "@", "i"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{"ii", "+", "1"}], ",", 
           RowBox[{"Length", "@", "i"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdd", "[", "set__", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", "=", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "set", "}"}]}]}], "}"}], ",", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{
           SubscriptBox["k", 
            RowBox[{"i", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]], "\[CenterDot]", 
           SubscriptBox["k", 
            RowBox[{"i", "[", 
             RowBox[{"[", "jj", "]"}], "]"}]]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Length", "@", "i"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", 
           RowBox[{"ii", "+", "1"}], ",", 
           RowBox[{"Length", "@", "i"}]}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\n", "\n", 
   RowBox[{
    RowBox[{"sdata", "[", 
     RowBox[{"\[Lambda]4d_List", ",", "t\[Lambda]4d_List", ",", "4"}], "]"}], 
    ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]4d", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"\[Lambda]4d", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"\[Lambda]4d", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"\[Lambda]4d", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"t\[Lambda]4d", "[", 
           RowBox[{"[", 
            RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
          RowBox[{"t\[Lambda]4d", "[", 
           RowBox[{"[", 
            RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"t\[Lambda]4d", "[", 
           RowBox[{"[", 
            RowBox[{"a", ",", "2"}], "]"}], "]"}], 
          RowBox[{"t\[Lambda]4d", "[", 
           RowBox[{"[", 
            RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", 
        RowBox[{"Length", "@", "\[Lambda]4d"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", 
        RowBox[{"Length", "@", "\[Lambda]4d"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sdata", "[", 
      RowBox[{"\[Lambda]4d_List", ",", "t\[Lambda]4d_List"}], "]"}], ":=", 
     RowBox[{"sdata", "[", 
      RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d", ",", "4"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sdata", "[", 
     RowBox[{"\[Lambda]6d_List", ",", "t\[Lambda]6d_List", ",", "6"}], "]"}], 
    ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Det", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]6d", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", ";;", ",", "a"}], "]"}], "]"}], 
             RowBox[{"t\[Lambda]6d", "[", 
              RowBox[{"[", 
               RowBox[{"jj", ",", ";;", ",", "bd"}], "]"}], "]"}]}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"a", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"bd", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", 
        RowBox[{"Length", "@", "\[Lambda]6d"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jj", ",", 
        RowBox[{"Length", "@", "\[Lambda]6d"}]}], "}"}]}], "]"}]}], "\n", 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
     "These", " ", "Mandelstam", " ", "tables", " ", "act", " ", "as", " ", 
      "the", " ", "minimal", " ", "data", " ", "to", " ", "solve", " ", 
      "scattering", " ", 
      RowBox[{"equation", "."}]}], "*)"}], "Text"], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"momentamurandom", "[", 
      RowBox[{"n_", ",", "d_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "eff2", ",", "xxx", ",", "xx", ",", "mm", ",", "ppre", ",", "gun", 
         ",", "pnH1"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Label", "[", "eff2", "]"}], ";", 
        RowBox[{"ppre", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"eff1", ",", "x"}], "}"}], ",", 
             RowBox[{
              RowBox[{"Label", "[", "eff1", "]"}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"d", ">", "3"}], ",", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["x", "0"], "=", 
                  RowBox[{"RandomInteger", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"100", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"d", "-", "3"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"100", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"d", "-", "3"}], "]"}]}], "]"}], "+", "100"}]}], 
                    "}"}], "]"}]}], ";", 
                 RowBox[{"Do", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["x", "i"], "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "100"}], "}"}], "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"d", "-", "4"}]}], "}"}]}], "]"}], ";", 
                 RowBox[{
                  RowBox[{"FindInstance", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["x", "i"], "^", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["x", "0"], "^", "2"}]}], "\[Equal]", "0"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"d", "-", "3"}]], ",", 
                    SubscriptBox["x", 
                    RowBox[{"d", "-", "2"}]], ",", 
                    SubscriptBox["x", 
                    RowBox[{"d", "-", "1"}]]}], "}"}], ",", "Integers", ",", 
                    "2"}], "]"}], "//", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"Goto", "[", "eff1", "]"}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["x", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    RowBox[{"d", "-", "4"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"Abs", "/@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", ";;", ",", "2"}], "]"}], 
                    "]"}]}]}], "]"}]}], "]"}], "&"}]}]}], ",", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["x", "0"], "=", 
                  RowBox[{"RandomInteger", "[", 
                   RowBox[{"{", 
                    RowBox[{"30", ",", "300"}], "}"}], "]"}]}], ";", 
                 RowBox[{
                  RowBox[{"FindInstance", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["x", "i"], "^", "2"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], "-", 
                    RowBox[{
                    SubscriptBox["x", "0"], "^", "2"}]}], "\[Equal]", "0"}], "&&", 
                    RowBox[{
                    SubscriptBox["x", "1"], ">", "0"}], "&&", 
                    RowBox[{
                    SubscriptBox["x", "2"], ">", "0"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["x", 
                    RowBox[{"d", "-", "2"}]], ",", 
                    SubscriptBox["x", 
                    RowBox[{"d", "-", "1"}]]}], "}"}], ",", "Integers", ",", 
                    "2"}], "]"}], "//", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"Goto", "[", "eff1", "]"}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    SubscriptBox["x", "0"], "}"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", ";;", ",", "2"}], "]"}], "]"}]}],
                     "]"}]}], "]"}], "&"}]}]}]}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"iii", ",", 
             RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}], "==", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "]"}]}], "&&", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Except", "[", "0", "]"}]}], "]"}], "/", 
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Except", "[", "0", "]"}]}], "]"}]}], "]"}]}], 
                "\[Equal]", "1"}]}], "&"}], "/@", 
             RowBox[{"Subsets", "[", 
              RowBox[{"ppre", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}], ",", 
          RowBox[{"Goto", "[", "eff2", "]"}]}], "]"}], ";", 
        RowBox[{"ppre", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", "#"}], "&"}], "/@", 
              RowBox[{"Range", "@", 
               RowBox[{"Length", "@", "#"}]}]}], " ", "#"}], "&"}], ",", 
           "ppre", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"pnH1", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           SubscriptBox["xx", "i"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"d", ">", "3"}], ",", 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"d", "\[GreaterEqual]", " ", "5"}], ",", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"again", ",", 
                  RowBox[{"nnn", "=", "1"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"Label", "[", "again", "]"}], ";", 
                 RowBox[{"gun", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["xx", "0"], "\[Rule]", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"100", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"d", "-", "3"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"100", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"d", "-", "3"}], "]"}]}], "]"}], "+", "100"}]}], 
                    "}"}], "]"}]}], "}"}], ",", " ", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "5", ",", 
                    RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "200"}], ",", "200"}], "}"}], ",", 
                    RowBox[{"d", "-", "5"}]}], "]"}]}], "}"}]}], "]"}]}], 
                   "]"}]}], ";", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Reduce", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", 
                    RowBox[{"pnH1", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"pnH1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "\[Equal]", 
                    "0"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Plus", "@@@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Plus", "@@@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "\[Equal]", 
                    "0"}]}], "/.", "gun"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["xx", "1"], ",", 
                    SubscriptBox["xx", "2"]}], "}"}]}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Union", "@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Power", "[", 
                    RowBox[{"_", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}], ",", "Infinity"}], 
                    "]"}]}], "&"}]}], "//", 
                   RowBox[{
                    RowBox[{"FindInstance", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"xxx", "^", "2"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["xx", "3"], ",", 
                    SubscriptBox["xx", "4"], ",", "xxx"}], "}"}], ",", 
                    "Integers"}], "]"}], "&"}]}], "//", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Equal]", 
                    RowBox[{"{", "}"}]}], "&&", 
                    RowBox[{"nnn", "<", "5"}]}], ",", 
                    RowBox[{
                    RowBox[{"nnn", "++"}], ";", 
                    RowBox[{"Goto", "[", "again", "]"}]}], ",", "#"}], "]"}], 
                   "&"}]}]}]}], "]"}], ",", 
              RowBox[{"d", "==", "4"}], ",", 
              RowBox[{
               RowBox[{"gun", "=", 
                RowBox[{"{", "}"}]}], ";", 
               RowBox[{
                RowBox[{
                 RowBox[{"Reduce", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", 
                    RowBox[{"pnH1", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"pnH1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "\[Equal]", 
                    "0"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Plus", "@@@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Plus", "@@@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "\[Equal]", 
                    "0"}]}], "/.", "gun"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["xx", "1"], ",", 
                    SubscriptBox["xx", "2"]}], "}"}]}], "]"}], "//", 
                 RowBox[{
                  RowBox[{"Union", "@", 
                   RowBox[{"Cases", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Power", "[", 
                    RowBox[{"_", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}], ",", "Infinity"}], 
                    "]"}]}], "&"}]}], "//", 
                RowBox[{
                 RowBox[{"FindInstance", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"xxx", "^", "2"}]}], "&&", 
                    RowBox[{"100", "<", 
                    SubscriptBox["xx", "0"], "<", "200"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["xx", "0"], ",", 
                    SubscriptBox["xx", "3"], ",", "xxx"}], "}"}], ",", 
                   "Integers"}], "]"}], "&"}]}]}]}], "]"}], "//", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#", "\[NotEqual]", " ", 
                RowBox[{"{", "}"}]}], ",", 
               RowBox[{"Sort", "@", 
                RowBox[{"Join", "[", 
                 RowBox[{"gun", ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", 
                    RowBox[{"pnH1", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"pnH1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "\[Equal]", 
                    "0"}], "&&", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Plus", "@@@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Plus", "@@@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "\[Equal]", 
                    "0"}]}], "/.", "gun"}], "/.", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["xx", "1"], ",", 
                    SubscriptBox["xx", "2"]}], "}"}]}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
               RowBox[{"Goto", "[", "eff2", "]"}]}], "]"}], "&"}]}], ",", 
           RowBox[{
            RowBox[{"mm", "=", 
             RowBox[{"d", "-", "2"}]}], ";", 
            RowBox[{"gun", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   SubscriptBox["xx", "i"], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "mm"}], "}"}]}], "]"}], ",", 
                 RowBox[{"RandomInteger", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "200"}], ",", "200"}], "}"}], ",", "mm"}], 
                  "]"}]}], "}"}]}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"FindInstance", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", 
                    RowBox[{"pnH1", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"pnH1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "\[Equal]", 
                  "0"}], "&&", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "^", "2"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Plus", "@@@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Plus", "@@@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"Append", "[", 
                    RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], "\[Equal]", 
                  "0"}]}], "/.", "gun"}], ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  SubscriptBox["xx", "0"], "}"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   SubscriptBox["xx", "i"], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"mm", "+", "1"}], ",", 
                    RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
               "Reals"}], "]"}], "//", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", "\[NotEqual]", " ", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"Sort", "@", 
                 RowBox[{"Join", "[", 
                  RowBox[{"gun", ",", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
                RowBox[{"Goto", "[", "eff2", "]"}]}], "]"}], "&"}]}]}]}], 
          "]"}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"ppre", ",", 
             RowBox[{"{", "pnH1", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"Plus", "@@@", 
                 RowBox[{"Transpose", "@", 
                  RowBox[{"Append", "[", 
                   RowBox[{"ppre", ",", "pnH1"}], "]"}]}]}], ")"}]}], "}"}]}],
             "]"}], "/.", "#"}], "&"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
       "We", " ", "generate", "  ", "momenta", " ", "in", " ", "general", " ",
         "dimensons", " ", "which", " ", "satisfy", " ", "on"}], "-", 
       RowBox[{"shell", " ", "conditon", " ", "and", " ", "momentum", " ", 
        RowBox[{"conservation", ".", " ", "All"}], " ", "are", " ", 
        "rational", " ", "number", " ", "except", " ", "one", " ", 
        "irrational", " ", "number", " ", "in", " ", "3", 
        RowBox[{"d", ".", " ", "Actually"}], " ", "3", "d"}]}], ",", " ", 
      RowBox[{
      "6", "d", " ", "spinors", " ", "are", " ", "generated", " ", "based", 
       " ", "on", " ", "this", " ", 
       RowBox[{"function", "."}]}]}], "*)"}], "Text"], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{"polarizationmurandom", "[", 
     RowBox[{"momenta_", ",", 
      RowBox[{"helilist_:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", "helilist", "}"}]}]}], "\[LessEqual]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{"Dimensions", "@", "momenta"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "-", "2"}]}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "a", ",", "b", ",", "x", ",", "y", ",", "d", ",", 
          "polarizationmurandompre", ",", "polarizationrandomheli"}], "}"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"polarizationmurandompre", "[", "a_", "]"}], ":=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", "=", 
             RowBox[{"Length", "@", "a"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"d", ">", "3"}], ",", 
              RowBox[{
               RowBox[{"b", "=", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"x", ",", "d"}], "]"}], "+", 
                 RowBox[{"I", " ", 
                  RowBox[{"Array", "[", 
                   RowBox[{"y", ",", "d"}], "]"}]}]}]}], ";", 
               RowBox[{
                RowBox[{"b", "/.", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "\[Rule]", " ", "0"}], "&"}], "/@", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{"x", ",", "d"}], "]"}], ",", 
                    RowBox[{"Array", "[", 
                    RowBox[{"y", ",", "d"}], "]"}]}], "}"}]}], ")"}], "//", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ";;"}], "]"}], "]"}]}], "]"}], "&"}]}], 
                    ")"}]}]}], ")"}]}], "/.", 
                RowBox[{
                 RowBox[{"FindInstance", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"lorentzdot", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Equal]", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"lorentzdot", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Equal]", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"lorentzdot", "[", 
                    RowBox[{"b", ",", 
                    RowBox[{"Conjugate", "@", "b"}]}], "]"}], "\[Equal]", 
                    "2"}], "&&", 
                    RowBox[{"Element", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{"x", ",", "d"}], "]"}], ",", 
                    RowBox[{"Array", "[", 
                    RowBox[{"y", ",", "d"}], "]"}]}], "}"}]}], ",", "Reals"}],
                     "]"}]}], "/.", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", " ", "0"}], "&"}], "/@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{"x", ",", "d"}], "]"}], ",", 
                    RowBox[{"Array", "[", 
                    RowBox[{"y", ",", "d"}], "]"}]}], "}"}]}], ")"}], "//", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ";;"}], "]"}], "]"}]}], "]"}], "&"}]}], 
                    ")"}]}]}], ")"}]}], ",", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{"x", ",", "d"}], "]"}], ",", 
                    RowBox[{"Array", "[", 
                    RowBox[{"y", ",", "d"}], "]"}]}], "}"}]}], ")"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;", "4"}], "]"}], "]"}]}]}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}]}], ",", 
              RowBox[{"polarizationrandomheli", "[", 
               RowBox[{"a", ",", "1"}], "]"}]}], "]"}]}], ")"}]}], ";", 
         RowBox[{
          RowBox[{"polarizationrandomheli", "[", 
           RowBox[{"momentum_", ",", "heli__"}], "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "dd", ",", "generator", ",", "theta", ",", "R", ",", "inverseR", 
              ",", "\[Theta]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"dd", "=", 
              RowBox[{"Length", "@", "momentum"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dd", "\[Equal]", "3"}], ",", 
               RowBox[{"Print", "[", "\"\<none\>\"", "]"}], ",", 
               RowBox[{
                RowBox[{"generator", "=", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "j", "+", "1"}], ")"}]}], 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dd", "-", "1"}], ",", 
                    RowBox[{"dd", "-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", " ", "1"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"j", ",", "i"}], "}"}], "\[Rule]", " ", 
                    RowBox[{"-", "1"}]}]}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", 
                    RowBox[{"dd", "-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
                  "]"}]}], ";", 
                RowBox[{"theta", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "ii"], ",", 
                   RowBox[{"{", 
                    RowBox[{"ii", ",", 
                    RowBox[{"Length", "@", "generator"}]}], "}"}]}], "]"}]}], 
                ";", 
                RowBox[{"R", "=", 
                 RowBox[{"Dot", "@@", 
                  RowBox[{"(", 
                   RowBox[{"MatrixExp", "/@", 
                    RowBox[{"(", 
                    RowBox[{"theta", " ", "generator"}], ")"}]}], " ", 
                   ")"}]}]}], ";", 
                RowBox[{"inverseR", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"dd", ">", "4"}], ",", 
                    RowBox[{
                    RowBox[{"R", "/.", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", " ", "0"}], "&"}], "/@", 
                    RowBox[{"theta", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dd", "-", "2"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dd", "-", "3"}], ")"}], "/", "2"}]}]}], "]"}], 
                    "]"}]}], ")"}]}], "/.", 
                    RowBox[{
                    RowBox[{"FindInstance", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"R", ".", " ", 
                    RowBox[{"momentum", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"momentum", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"dd", "-", "1"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "\[Rule]", " ", "1"}]}], "]"}]}]}], 
                    ")"}], "/.", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", " ", "0"}], "&"}], "/@", 
                    RowBox[{"theta", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dd", "-", "2"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dd", "-", "3"}], ")"}], "/", "2"}]}]}], "]"}], 
                    "]"}]}], ")"}]}], "}"}], ",", 
                    RowBox[{"theta", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dd", "-", "2"}], ")"}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"dd", "-", "3"}], ")"}], "/", "2"}]}], "+", "1"}],
                     ";;"}], "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"R", "/.", 
                    RowBox[{
                    RowBox[{"FindInstance", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"R", ".", " ", 
                    RowBox[{"momentum", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"momentum", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"dd", "-", "1"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "\[Rule]", " ", "1"}]}], "]"}]}]}], 
                    ")"}], "}"}], ",", "theta"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "//", 
                    "TrigExpand"}], "//", "Simplify"}], "//", "Inverse"}]}], 
                ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "heli", "}"}]}]}], "\[Equal]", "1"}], "&&", 
                   RowBox[{
                    RowBox[{"Head", "@", "heli"}], "\[Equal]", "Integer"}]}], 
                  ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"inverseR", ".", 
                    RowBox[{"(", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"dd", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"heli", "\[Rule]", " ", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"heli", "+", "1"}], ",", 
                    RowBox[{"dd", "-", "2"}], ",", "1"}], "]"}], "\[Rule]", 
                    " ", "I"}]}], "}"}]}], "]"}], ")"}]}], "//", "Simplify"}],
                    "//", 
                   RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"#", ",", "0"}], "]"}], "&"}]}], ",", 
                  RowBox[{
                   RowBox[{"Function", "[", 
                    RowBox[{"slot", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"inverseR", ".", 
                    RowBox[{"(", 
                    RowBox[{"ReplacePart", "[", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"dd", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"slot", "\[Rule]", " ", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"slot", "+", "1"}], ",", 
                    RowBox[{"dd", "-", "1"}], ",", "1"}], "]"}], "\[Rule]", 
                    " ", "I"}]}], "}"}]}], "]"}], ")"}]}], "//", "Simplify"}],
                     "//", 
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"#", ",", "0"}], "]"}], "&"}]}]}], "]"}], "/@", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", "heli", "}"}]}]}]}], "]"}]}]}], "]"}]}]}], 
           "]"}]}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"helilist", "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{"polarizationmurandompre", ",", "momenta", ",", 
             RowBox[{"{", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "@", 
                  RowBox[{"momenta", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "===", "List"}], ",", 
                "1", ",", "0"}], "]"}], "}"}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "@", 
               RowBox[{"momenta", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "===", "List"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "momenta"}], "===", 
                RowBox[{"Length", "@", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"{", "helilist", "}"}]}]}]}], ",", 
               RowBox[{"polarizationrandomheli", "@@@", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"momenta", ",", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"{", "helilist", "}"}]}]}], "}"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"Print", "[", "\"\<wrong\>\"", "]"}], ";", "0"}]}], 
              "]"}], ",", 
             RowBox[{"polarizationrandomheli", "[", 
              RowBox[{"momenta", ",", "helilist"}], "]"}]}], "]"}]}], 
          "]"}]}]}], "]"}], ",", 
      RowBox[{"Print", "[", "\"\<wrong\>\"", "]"}]}], "]"}]}], "\n", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "We", " ", "generate", " ", "polarizations", "  ", "in", " ", "general",
        " ", 
       RowBox[{"dimensons", ".", " ", "The"}], " ", "helicity", " ", "state", 
       " ", "remark", " ", "is", " ", "expected", " ", "to", " ", "be", " ", 
       "1"}], ",", "2", ",", "...", ",", 
      RowBox[{"d", "-", "2"}], ",", " ", 
      RowBox[{"which", " ", "correspond", " ", "to", " ", 
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "I", ",", 
         RowBox[{
          RowBox[{"0", "..."}], "0"}], ",", "0"}], ")"}]}], ",", 
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "I", ",", 
        RowBox[{
         RowBox[{"0", "..."}], "0"}]}], ")"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"0", ",", "I", ",", "0", ",", 
         RowBox[{
          RowBox[{"0", "..."}], "0"}], ",", "1", ",", "0"}], ")"}], " ", 
       "respectively", " ", "when", " ", "the", " ", "momentum", " ", "is", 
       " ", "rotated", " ", "to", " ", "be", " ", 
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"0", "..."}], ",", "0", ",", "1"}], ")"}]}]}], "*)"}], 
    "Text"], 
   StyleBox["\n", "Text"], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"mysqrt", "[", 
      RowBox[{"y_", ",", 
       RowBox[{"z2_:", "2"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"z1", "=", "2"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"x", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "@", "y"}], "//", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Floor", "[", 
               RowBox[{"10", "^", "z1"}], "]"}]}], "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"Rationalize", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "@", "#"}], " ", "/", "10"}], "/", 
              RowBox[{"Floor", "[", 
               RowBox[{"10", "^", "z1"}], "]"}]}]}], "]"}], "&"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"x", "\[Equal]", "0"}], ",", 
          RowBox[{"x", "=", 
           RowBox[{"10", "^", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"Log10", "@", "y"}], "/", "2"}], "]"}]}]}]}], "]"}], 
        ";", 
        RowBox[{
         RowBox[{"x", " ", 
          RowBox[{"Normal", "@", 
           RowBox[{"Series", "[", " ", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"1", "+", "\[Epsilon]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", ",", "0", ",", 
               RowBox[{"Floor", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"10", "^", "z2"}]}], "/", 
                 RowBox[{"Log10", "@", 
                  RowBox[{"Abs", "[", " ", 
                   RowBox[{
                    RowBox[{"y", "/", 
                    RowBox[{"x", "^", "2"}]}], "-", "1"}], "]"}]}]}], "]"}]}],
               "}"}]}], "]"}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"y", "/", 
             RowBox[{"x", "^", "2"}]}], "-", "1"}]}], "}"}]}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mysqrtReplace", "[", 
      RowBox[{"z2_:", "2"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        TagBox[
         StyleBox[
          RowBox[{"Sqrt", "[", "a_Integer", "]"}],
          ShowSpecialCharacters->False,
          ShowStringCharacters->True,
          NumberMarks->True],
         FullForm], "\[RuleDelayed]", " ", 
        RowBox[{"mysqrt", "[", 
         RowBox[{"a", ",", "z2"}], "]"}]}], ",", 
       RowBox[{
        TagBox[
         StyleBox[
          RowBox[{"Sqrt", "[", "a_Rational", "]"}],
          ShowSpecialCharacters->False,
          ShowStringCharacters->True,
          NumberMarks->True],
         FullForm], "\[RuleDelayed]", " ", 
        RowBox[{"mysqrt", "[", 
         RowBox[{"a", ",", "z2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"1", "/", 
         TagBox[
          StyleBox[
           RowBox[{"Sqrt", "[", "a_Integer", "]"}],
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm]}], "\[RuleDelayed]", 
        RowBox[{"1", "/", " ", 
         RowBox[{"mysqrt", "[", 
          RowBox[{"a", ",", "z2"}], "]"}]}]}], ",", 
       RowBox[{
        TagBox[
         StyleBox[
          RowBox[{"Sqrt", "[", "a_Complex", "]"}],
          ShowSpecialCharacters->False,
          ShowStringCharacters->True,
          NumberMarks->True],
         FullForm], "\[RuleDelayed]", " ", 
        RowBox[{"mysqrt", "[", 
         RowBox[{"a", ",", "z2"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"1", "/", 
         TagBox[
          StyleBox[
           RowBox[{"Sqrt", "[", "a_Complex", "]"}],
           ShowSpecialCharacters->False,
           ShowStringCharacters->True,
           NumberMarks->True],
          FullForm]}], "\[RuleDelayed]", 
        RowBox[{"1", "/", " ", 
         RowBox[{"mysqrt", "[", 
          RowBox[{"a", ",", "z2"}], "]"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "can", " ", "use", " ", "the", " ", "replace", " ", "rule", 
     " ", 
     RowBox[{"mysqrtReplace", "[", "]"}], " ", "to", " ", "reduce", " ", 
     "the", " ", "irrational", " ", "number", " ", "brought", " ", "out", " ",
      "in", " ", "polarizationmurandom", " ", "to", " ", "rational", " ", 
     "number", " ", "with", " ", "the", " ", "error", " ", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", 
        SuperscriptBox["10", "z2"]}], ")"}]}]}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lorentzdot", "[", 
      RowBox[{"vector1_", ",", "vector2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"vector1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], 
       RowBox[{"vector2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"vector1", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}], ".", 
       RowBox[{"vector2", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;"}], "]"}], "]"}]}]}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"sdata", "[", "momenta_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"momenta", "[", 
         RowBox[{"[", 
          RowBox[{"a", ",", "1"}], "]"}], "]"}], 
        RowBox[{"momenta", "[", 
         RowBox[{"[", 
          RowBox[{"b", ",", "1"}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"momenta", "[", 
         RowBox[{"[", 
          RowBox[{"a", ",", 
           RowBox[{"2", ";;"}]}], "]"}], "]"}], ".", 
        RowBox[{"momenta", "[", 
         RowBox[{"[", 
          RowBox[{"b", ",", 
           RowBox[{"2", ";;"}]}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", 
        RowBox[{"Length", "@", "momenta"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", 
        RowBox[{"Length", "@", "momenta"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
   StyleBox[
    RowBox[{"(*", "solutions", "*)"}], "Subsubsection"], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"solutions", "[", 
      RowBox[{"sdata_", ",", 
       RowBox[{"sl2gauge_:", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Sigma]", "1"], "\[Rule]", " ", "0"}], ",", 
          RowBox[{
           SubscriptBox["\[Sigma]", "2"], "\[Rule]", "1"}], ",", 
          RowBox[{
           SubscriptBox["\[Sigma]", "3"], "\[Rule]", " ", "2"}]}], "}"}]}], 
       ",", 
       RowBox[{"smooth_:", "1"}], ",", 
       RowBox[{"$100_:", "100"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "n", ",", "sigmaInfinity", ",", "ss", ",", "Eq", ",", "soln", ",", 
         "$sl2gauge"}], "}"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "@", "sdata"}]}], ";", 
        RowBox[{"sigmaInfinity", "=", 
         RowBox[{"sl2gauge", "//", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"FreeQ", "[", 
                    RowBox[{"#", ",", "Infinity"}], "]"}]}], "&"}]}], "]"}], 
               ",", 
               RowBox[{"Select", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"FreeQ", "[", 
                   RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}]}], "}"}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "&"}]}]}], ";", 
        RowBox[{
         RowBox[{"ss", "[", "set_List", "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"sdata", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"set", "[", 
               RowBox[{"[", "a", "]"}], "]"}], ",", 
              RowBox[{"set", "[", 
               RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{
              RowBox[{"Length", "[", "set", "]"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", 
             RowBox[{"a", "+", "1"}], ",", 
             RowBox[{"Length", "[", "set", "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"Eq", "[", "m_", "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"AA", "=", 
             RowBox[{"Subsets", "[", 
              RowBox[{
               RowBox[{"Range", "[", "n", "]"}], ",", 
               RowBox[{"{", "m", "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{"AA", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], 
              RowBox[{"Product", "[", 
               RowBox[{
                SubscriptBox["\[Sigma]", 
                 RowBox[{"AA", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}]], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "@", "AA"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", 
        RowBox[{"soln", "=", 
         RowBox[{"NSolve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Eq", "[", "m", "]"}], "/", 
                  SubscriptBox["\[Sigma]", "sigmaInfinity"]}], "//", 
                 "Expand"}], ")"}], "/.", "sl2gauge"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "2", ",", 
                RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], "\[Equal]", " ", 
            "0"}], ",", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Sigma]", "#"], "&"}], "/@", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Range", "@", "n"}], ",", 
              RowBox[{"sl2gauge", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
           ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "$100"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"sl2gauge", ",", "Infinity"}], "]"}]}], "&&", 
           RowBox[{"smooth", "\[Equal]", "1"}]}], ",", 
          RowBox[{
           RowBox[{"$sl2gauge", "=", 
            RowBox[{"sl2gauge", "/.", 
             RowBox[{"{", 
              RowBox[{"Infinity", "\[Rule]", " ", 
               RowBox[{"10", "^", "50"}]}], "}"}]}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"slot", ",", 
               RowBox[{"FindRoot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Eq", "[", "m", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "2", ",", 
                    RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], "/.", 
                  "$sl2gauge"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
                  "slot"}], ",", 
                 RowBox[{"WorkingPrecision", "\[Rule]", "$100"}]}], "]"}]}], 
              "]"}], "/@", "soln"}], "//", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Sort", "@", 
                RowBox[{"Join", "[", 
                 RowBox[{"$sl2gauge", ",", "#"}], "]"}]}], "&"}], "/@", "#"}],
              "&"}]}]}], ",", 
          RowBox[{"soln", "//", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "@", 
               RowBox[{"Join", "[", 
                RowBox[{"sl2gauge", ",", "#"}], "]"}]}], "&"}], "/@", "#"}], 
            "&"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
   StyleBox["\n", "Text"], 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "When", " ", "smooth", " ", "is", " ", "chosen", " ", "to", " ", "be", 
       " ", "1"}], ",", " ", 
      RowBox[{
      "the", " ", "function", " ", "solutions", " ", "will", "  ", "change", 
       " ", "all", " ", "results", " ", "smoothly", " ", "so", " ", "that", 
       " ", "the", " ", "Infinity", " ", "in", " ", "the", " ", "gauge", " ", 
       "fixing", " ", "will", " ", "be", " ", "changed", " ", "to", " ", "a", 
       " ", "finite", " ", "number"}]}], "*)"}], "Code"], 
   StyleBox["\n", "Code"], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"solutionsector", "[", 
      RowBox[{"\[Lambda]4d_", ",", "t\[Lambda]4d_", ",", "soln_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ab", ",", "sb"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]4d", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"\[Lambda]4d", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"\[Lambda]4d", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
            RowBox[{"\[Lambda]4d", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
        RowBox[{
         RowBox[{"sb", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"t\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
             RowBox[{"t\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"t\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "2"}], "]"}], "]"}], 
             RowBox[{"t\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "n", ",", "out", ",", "krange", ",", "sigmaInfinity", ",", "M"}], 
           "}"}], ",", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{"Length", "@", "\[Lambda]4d"}]}], ";", 
           RowBox[{"out", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"krange", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"IntegerQ", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", " ", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Reverse", "@", 
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}]}], "]"}]}], ",", " ", 
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"n", "/", "2"}], "]"}]}]}], "]"}]}], "}"}], 
                   "]"}]}], "}"}], "]"}], "&"}], "[", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", "n", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"n", "+", "1"}], ")"}], "/", "2"}], "}"}]}], "]"}],
               "]"}], "//", 
             RowBox[{
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", 
                RowBox[{"-", "3"}]}], "]"}], "&"}]}]}], ";", 
           RowBox[{"sigmaInfinity", "=", 
            RowBox[{
             RowBox[{"Max", "@", 
              RowBox[{"Abs", "@", 
               RowBox[{
                RowBox[{"soln", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}]}]}], "//", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", ">", 
                 RowBox[{"10", "^", "30"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"soln", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", "#"}], "]"}],
                     "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
              "&"}]}]}], ";", 
           RowBox[{"M", "=", 
            RowBox[{"capitalpsi", "[", 
             RowBox[{"n", ",", 
              RowBox[{"{", 
               RowBox[{"sigmaInfinity", ",", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"sigmaInfinity", "+", "1"}], ",", "n", ",", "1"}], 
                 "]"}]}], "}"}]}], "]"}]}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"Block", "[", 
              RowBox[{
               RowBox[{"{", "ref", "}"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"ref", "[", "a_Integer", "]"}], ":=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"a", "\[LessEqual]", "$k"}], ",", "n", ",", "1"}], 
                  "]"}]}], " ", ";", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Sqrt", "@", 
                    RowBox[{"Abs", "@", 
                    RowBox[{"Det", "[", 
                    RowBox[{
                    RowBox[{"M", "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                    RowBox[{"lorentzproducts", "[", 
                    RowBox[{"Range", "[", "$k", "]"}], "]"}]}], "]"}]}]}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "sigmaInfinity"], "-", 
                    SubscriptBox["\[Sigma]", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"sigmaInfinity", "+", "1"}], ",", "n", ",", "1"}],
                     "]"}]]}], ")"}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], ")"}]}], "]"}], ">", 
                   RowBox[{"10", "^", 
                    RowBox[{"-", "50"}]}]}], ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"out", "[", 
                    RowBox[{"[", "$k", "]"}], "]"}], ",", "iii"}], "]"}]}], 
                 "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"$k", ",", "krange"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"iii", ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Range", "@", 
                  RowBox[{"Length", "[", "soln", "]"}]}], ",", 
                 RowBox[{"Flatten", "[", "out", "]"}]}], "]"}]}], "}"}]}], 
            "]"}], ";", "out"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"solutions4d", "[", 
      RowBox[{
      "neg_", ",", "\[Lambda]4d_List", ",", "t\[Lambda]4d_List", ",", "soln_",
        ",", "sector_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "\[Lambda]4d"}], "==", 
        RowBox[{"Length", "@", "t\[Lambda]4d"}]}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "tgauge", ",", "eq4d"}], "}"}], ",", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"Length", "@", "\[Lambda]4d"}]}], ";", 
          RowBox[{"tgauge", "=", 
           RowBox[{
            RowBox[{"Max", "@", 
             RowBox[{
              RowBox[{"soln", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "2"}], "]"}], "]"}]}], "//", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "@", "#"}], ">", 
                RowBox[{"10", "^", "30"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"soln", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", "#"}], "]"}],
                     "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
                 "}"}], "/.", 
                RowBox[{"\[Sigma]", "\[Rule]", " ", "t"}]}], ",", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["t", "1"], "\[Rule]", "1"}], "}"}]}], "]"}], 
             "&"}]}]}], ";", 
          RowBox[{"eq4d", "=", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"t\[Lambda]4d", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"t\[Lambda]4d", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], 
                    SubscriptBox["t", "i"], 
                    RowBox[{
                    SubscriptBox["t", "j"], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "i"], "-", 
                    SubscriptBox["\[Sigma]", "j"]}], ")"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "n", "]"}], ",", "neg"}], "]"}]}], 
                    "}"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "neg"}], "}"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Lambda]4d", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\[Lambda]4d", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], 
                    SubscriptBox["t", "i"], 
                    RowBox[{
                    SubscriptBox["t", "j"], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "i"], "-", 
                    SubscriptBox["\[Sigma]", "j"]}], ")"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "neg"}], "}"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"Range", "[", "n", "]"}], ",", "neg"}], "]"}]}], 
                 "}"}]}], "]"}]}], "]"}]}]}], ";", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"kk", ",", "gl2gauge"}], "}"}], ",", 
            RowBox[{
             RowBox[{"kk", "=", 
              RowBox[{"Length", "[", "neg", "]"}]}], ";", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"NSolve", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"eq4d", "/.", "tgauge"}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", 
                    RowBox[{"sector", "[", 
                    RowBox[{"[", 
                    RowBox[{"kk", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                    ")"}], "\[Equal]", "0"}], ",", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["t", "#"], "&"}], "/@", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", "n"}], ",", 
                    RowBox[{"tgauge", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], 
                    "]"}]}], ",", 
                   RowBox[{"WorkingPrecision", "\[Rule]", "50"}]}], "]"}], "//", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"soln", "[", 
                    RowBox[{"[", 
                    RowBox[{"sector", "[", 
                    RowBox[{"[", 
                    RowBox[{"kk", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"tgauge", ",", "#"}], "}"}], "]"}]}]}], "]"}], 
                  "&"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"sector", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
              "//", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "<", 
                    RowBox[{"2", "n"}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"kk", "\[Equal]", "2"}], "||", 
                    RowBox[{"kk", "\[Equal]", 
                    RowBox[{"n", "-", "2"}]}]}], ")"}]}], ",", 
                 RowBox[{
                  RowBox[{"gl2gauge", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Sigma]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]], "\[Rule]", " ", "1"}], 
                    ",", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]], "\[Rule]", " ", "0"}], 
                    ",", 
                    RowBox[{
                    SubscriptBox["t", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]], "\[Rule]", " ", "1"}], 
                    ",", 
                    RowBox[{
                    SubscriptBox["t", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]], "\[Rule]", " ", "1"}]}], 
                    "}"}], "&"}], "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "neg"}], "\[Equal]", "2"}], ",", 
                    "neg", ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", "n"}], ",", "neg"}], "]"}]}], 
                    "]"}]}]}], ";", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"NSolve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"eq4d", "/.", "gl2gauge"}], ")"}], "\[Equal]", 
                    "0"}], ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "#"], ",", 
                    SubscriptBox["t", "#"]}], "}"}], "&"}], "/@", 
                    RowBox[{"Range", "@", "n"}]}], "]"}], ",", 
                    RowBox[{"gl2gauge", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"WorkingPrecision", "\[Rule]", "100"}]}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Sort", "@", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "gl2gauge"}], 
                    "]"}]}], "&"}]}], "//", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"n", "+", "1"}], ";;"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "n"}], "]"}], "]"}]}], "}"}]}], "}"}], 
                    "&"}]}]}], ",", "#"}], "]"}], "&"}]}]}]}], "]"}]}]}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{
     "solution", " ", "samples", " ", "for", " ", "higher", " ", "pts"}], 
     "*)"}], "Text"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"solutionsamples", "[", 
      RowBox[{"stable_", ",", 
       RowBox[{"$3_:", "3"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ss", ",", "n", ",", "$n", ",", "sl2gauge", ",", "$sl2gauge", ",", 
         "epstable", ",", "eq", ",", "Eq", ",", "endpointplussigmantotalpre", 
         ",", "startpoint", ",", "startpointplussigman", ",", 
         "endpointplussigman", ",", "$100", ",", "break", ",", "presolution", 
         ",", "null"}], "}"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "@", "stable"}]}], ";", 
        RowBox[{"sl2gauge", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["\[Sigma]", "1"], "\[Rule]", "Infinity"}], ",", 
           RowBox[{
            SubscriptBox["\[Sigma]", "2"], "\[Rule]", 
            RowBox[{"11", "+", 
             RowBox[{"17", "I"}]}]}], ",", 
           RowBox[{
            SubscriptBox["\[Sigma]", "3"], "\[Rule]", 
            RowBox[{"51", "-", 
             RowBox[{"133", "I"}]}]}]}], "}"}]}], ";", 
        RowBox[{"$sl2gauge", "=", 
         RowBox[{"sl2gauge", "/.", 
          RowBox[{"{", 
           RowBox[{"Infinity", "\[Rule]", " ", 
            RowBox[{"10", "^", "50"}]}], "}"}]}]}], ";", 
        RowBox[{
         RowBox[{"epstable", "[", 
          RowBox[{"$n_", ",", "epsilon_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"stable", "//", 
             RowBox[{
              RowBox[{"ReplacePart", "[", 
               RowBox[{"#", ",", 
                RowBox[{"$n", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "$n", "]"}], "]"}], "epsilon"}]}]}], "]"}], 
              "&"}]}], "//", "Transpose"}], "//", 
           RowBox[{
            RowBox[{"ReplacePart", "[", 
             RowBox[{"#", ",", 
              RowBox[{"$n", "\[Rule]", " ", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "$n", "]"}], "]"}], "epsilon"}]}]}], "]"}], 
            "&"}]}], "//", "Transpose"}]}], ";", 
        RowBox[{
         RowBox[{"eq", "[", 
          RowBox[{"i_", ",", "$n_", ",", "epsilon_"}], "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"epstable", "[", 
              RowBox[{"$n", ",", "epsilon"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Sigma]", "i"], "-", 
              SubscriptBox["\[Sigma]", "j"]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", "n", "]"}], ",", 
               RowBox[{"{", "i", "}"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"ss", "[", 
          RowBox[{"set_List", ",", "$n_", ",", "epsilon_"}], "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"epstable", "[", 
             RowBox[{"$n", ",", "epsilon"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"set", "[", 
               RowBox[{"[", "a", "]"}], "]"}], ",", 
              RowBox[{"set", "[", 
               RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", 
             RowBox[{
              RowBox[{"Length", "[", "set", "]"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", 
             RowBox[{"a", "+", "1"}], ",", 
             RowBox[{"Length", "[", "set", "]"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"Eq", "[", 
          RowBox[{"m_", ",", "$n_", ",", "epsilon_"}], "]"}], ":=", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"AA", "=", 
             RowBox[{"Subsets", "[", 
              RowBox[{
               RowBox[{"Range", "[", "n", "]"}], ",", 
               RowBox[{"{", "m", "}"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ss", "[", 
               RowBox[{
                RowBox[{"AA", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "$n", ",", "epsilon"}], 
               "]"}], 
              RowBox[{"Product", "[", 
               RowBox[{
                SubscriptBox["\[Sigma]", 
                 RowBox[{"AA", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "i"}], "]"}], "]"}]], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "@", "AA"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", 
        RowBox[{"endpointplussigmantotalpre", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"$n", "=", "n"}], ";", 
        RowBox[{
         RowBox[{"startpoint", "[", "$n", "]"}], "=", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", "\[LessEqual]", "8"}], ",", 
            RowBox[{
             RowBox[{"solutions", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"stable", "//", 
                   RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "$n", "}"}]}], "]"}], "&"}]}], "//", 
                  "Transpose"}], "//", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", "$n", "}"}]}], "]"}], "&"}]}], "//", 
                "Transpose"}], ",", "sl2gauge", ",", "1"}], "]"}], "//", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ";;", 
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"Length", "@", "#"}], "/", "$3"}], "]"}]}], "]"}],
                 "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", "$3"}], "]"}], "]"}], "&"}]}], ",", 
            RowBox[{"solutionsamples", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"stable", "//", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"{", "$n", "}"}]}], "]"}], "&"}]}], "//", 
                "Transpose"}], "//", 
               RowBox[{
                RowBox[{"Drop", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", "$n", "}"}]}], "]"}], "&"}]}], "//", 
              "Transpose"}], "]"}]}], "]"}], "/.", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Sigma]", "#"], "&"}], "/@", 
              RowBox[{"Range", "@", "n"}]}], ")"}], "//", 
            RowBox[{
             RowBox[{"Rule", "@@@", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"Drop", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "$n", "}"}]}], "]"}], ",", 
                   SubscriptBox["\[Sigma]", "$n"]}], "]"}]}], "}"}], "]"}]}], 
             "&"}]}], ")"}]}]}], ";", 
        RowBox[{
         RowBox[{"startpointplussigman", "[", "$n", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"NSolve", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"eq", "[", 
                   RowBox[{"$n", ",", "$n", ",", "1"}], "]"}], "/.", " ", 
                  RowBox[{
                   RowBox[{"startpoint", "[", "$n", "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  SubscriptBox["\[Sigma]", "$n"], "}"}]}], "]"}], "//", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"startpoint", "[", "$n", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
                 "#"}], "&"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "@", " ", 
                 RowBox[{"startpoint", "[", "$n", "]"}]}]}], "}"}]}], "]"}], "//", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"4", ";;"}], "]"}], "]"}]}], "&"}], "/@", "#"}], 
            "&"}]}], "//", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{";;", ";;", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "@", "#"}], "/", "2"}], "/", "$3"}], 
                 "]"}], ",", "1"}], "]"}]}], "]"}], "]"}], "&"}]}]}], ";", 
        RowBox[{
         RowBox[{"endpointplussigman", "[", "$n", "]"}], "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"$100", "=", "21"}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"break", "=", "False"}], ";", 
           RowBox[{
            RowBox[{"presolution", "[", 
             RowBox[{"$k", ",", "0"}], "]"}], "=", 
            RowBox[{
             RowBox[{"startpointplussigman", "[", "$n", "]"}], "[", 
             RowBox[{"[", "$k", "]"}], "]"}]}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"presolution", "[", 
                RowBox[{"$k", ",", "iepsilon"}], "]"}], "=", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"FindRoot", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Eq", "[", 
                    RowBox[{"m", ",", "$n", ",", 
                    RowBox[{
                    RowBox[{"iepsilon", "^", "3"}], "/", 
                    RowBox[{"$100", "^", "3"}]}]}], "]"}], ")"}], "/.", 
                    "$sl2gauge"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "2", ",", 
                    RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], "\[Equal]", 
                    " ", "0"}], ",", 
                   RowBox[{"presolution", "[", 
                    RowBox[{"$k", ",", 
                    RowBox[{"iepsilon", "-", "1"}]}], "]"}], ",", 
                   RowBox[{"WorkingPrecision", "\[Rule]", 
                    RowBox[{"40", "+", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"40", " ", 
                    RowBox[{
                    RowBox[{"iepsilon", "^", "3"}], "/", 
                    RowBox[{"$100", "^", "3"}]}]}], "]"}]}]}]}], "]"}], "//", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], " ", "}"}], "&"}], "/@",
                    "#"}], "&"}]}], ")"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"iepsilon", "\[Equal]", "1"}], "&&", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"presolution", "[", 
                    RowBox[{"$$k", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", "20"}],
                     "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"$$k", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"$k", "-", "n", "+", "4"}], ",", "1"}], "]"}], 
                    ",", 
                    RowBox[{"$k", "-", "1"}]}], "}"}]}], "]"}], ",", 
                   RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"presolution", "[", 
                    RowBox[{"$k", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", "20"}],
                     "]"}]}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"break", "=", "True"}], ";", 
                 RowBox[{
                  RowBox[{"presolution", "[", 
                   RowBox[{"$k", ",", "$100"}], "]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"null", ",", "null"}], "}"}], "}"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"iepsilon", ",", "$100"}], "}"}]}], "]"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"!", "break"}], "&&", 
              RowBox[{"!", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"presolution", "[", 
                    RowBox[{"$$k", ",", "$100"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", "20"}],
                     "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"$$k", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"$k", "-", "n", "+", "4"}], ",", "1"}], "]"}], 
                    ",", 
                    RowBox[{"$k", "-", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"presolution", "[", 
                    RowBox[{"$k", ",", "$100"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", "20"}],
                   "]"}]}], "]"}]}]}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"endpointplussigman", "[", "$n", "]"}], ",", 
               RowBox[{"Sort", "@", 
                RowBox[{"presolution", "[", 
                 RowBox[{"$k", ",", "$100"}], "]"}]}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"$k", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"startpointplussigman", "[", "$n", "]"}]}]}], "}"}]}], 
         "]"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"endpointplussigmantotalpre", ",", 
          RowBox[{"endpointplussigman", "[", "$n", "]"}]}], "]"}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"$sl2gauge", ",", 
              RowBox[{"Rule", "@@@", "#"}]}], "]"}], "&"}], "/@", 
           RowBox[{"endpointplussigman", "[", "$n", "]"}]}], "//", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Times", "@@", 
                RowBox[{"(", 
                 RowBox[{"Abs", "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Eq", "[", 
                    RowBox[{"m", ",", "$n", ",", "1"}], "]"}], ")"}], "/.", 
                    "$sl2gauge"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "2", ",", 
                    RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], "/.", "#"}], 
                   ")"}]}], ")"}]}], "<", 
               RowBox[{
                RowBox[{"10", "^", 
                 RowBox[{"-", "5"}]}], "n"}]}], "&"}]}], "]"}], "&"}]}], "//", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{";;", ";;", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{"Floor", "[", 
                 RowBox[{
                  RowBox[{"Length", "@", "#"}], "/", "$3"}], "]"}], ",", 
                "1"}], "]"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"Min", "[", 
              RowBox[{"$3", ",", 
               RowBox[{"Length", "@", "#"}]}], "]"}]}], "]"}], "]"}], 
          "&"}]}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "$3", " ", "is", " ", "used", " ", "to", " ", "control", " ", "the", " ", 
     "solution", " ", "number"}], "*)"}], "\n", "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"oneloopsolutions", "[", 
      RowBox[{"\[Lambda]4dT2_", ",", "t\[Lambda]4dT2_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ab", ",", "sb"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"ab", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Lambda]4dT2", "\[LeftDoubleBracket]", 
             RowBox[{"a", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
            RowBox[{"\[Lambda]4dT2", "\[LeftDoubleBracket]", 
             RowBox[{"b", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
           RowBox[{
            RowBox[{"\[Lambda]4dT2", "\[LeftDoubleBracket]", 
             RowBox[{"a", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
            RowBox[{"\[Lambda]4dT2", "\[LeftDoubleBracket]", 
             RowBox[{"b", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ")"}]}], 
        ";", 
        RowBox[{
         RowBox[{"sb", "[", 
          RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"t\[Lambda]4dT2", "\[LeftDoubleBracket]", 
             RowBox[{"a", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
            RowBox[{"t\[Lambda]4dT2", "\[LeftDoubleBracket]", 
             RowBox[{"b", ",", "2"}], "\[RightDoubleBracket]"}]}], "-", 
           RowBox[{
            RowBox[{"t\[Lambda]4dT2", "\[LeftDoubleBracket]", 
             RowBox[{"a", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
            RowBox[{"t\[Lambda]4dT2", "\[LeftDoubleBracket]", 
             RowBox[{"b", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ")"}]}], 
        ";", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "n", ",", "gauge", ",", "numeric", ",", "E1", ",", "E2", ",", "E3",
             ",", "E4", ",", "E5", ",", "k", ",", "l"}], "}"}], ",", 
          RowBox[{
           RowBox[{"n", "=", 
            RowBox[{
             RowBox[{"Length", "@", "\[Lambda]4dT2"}], "-", "2"}]}], ";", 
           RowBox[{"numeric", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["k", "i_"], "\[CenterDot]", 
                SubscriptBox["k", "j_"]}], "\[RuleDelayed]", " ", 
               RowBox[{
                RowBox[{"ab", "[", 
                 RowBox[{"i", ",", "j"}], "]"}], 
                RowBox[{
                 RowBox[{"sb", "[", 
                  RowBox[{"i", ",", "j"}], "]"}], "/", "2"}]}]}], ",", 
              RowBox[{
               RowBox[{
                SubscriptBox["k", "i_"], "\[CenterDot]", "l"}], 
               "\[RuleDelayed]", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ab", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}], 
                   RowBox[{"sb", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"n", "+", "1"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"ab", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"n", "+", "2"}]}], "]"}], 
                   RowBox[{"sb", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"n", "+", "2"}]}], "]"}]}]}], ")"}], "/", 
                "2"}]}]}], "}"}]}], ";", 
           RowBox[{"gauge", "=", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["\[Sigma]", "1"], "\[Rule]", "1"}], "}"}]}], ";", 
           RowBox[{"E1", "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["k", "i"], "\[CenterDot]", "l"}], ")"}]}], " ", 
               SubscriptBox["\[Sigma]", "i"]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"E2", "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["k", "i"], "\[CenterDot]", 
                  SubscriptBox["k", "j"]}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i"], "\[CenterDot]", "l"}], "-", 
                 RowBox[{
                  SubscriptBox["k", "j"], "\[CenterDot]", "l"}]}], ")"}], 
               SubscriptBox["\[Sigma]", "i"], 
               SubscriptBox["\[Sigma]", "j"]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"E3", "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", 
                  SubscriptBox["k", "i2"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", 
                  SubscriptBox["k", "i3"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", 
                  SubscriptBox["k", "i1"]}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", "l"}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", "l"}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", "l"}]}], ")"}], 
               SubscriptBox["\[Sigma]", "i1"], 
               SubscriptBox["\[Sigma]", "i2"], 
               SubscriptBox["\[Sigma]", "i3"]}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", 
                RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", 
                RowBox[{"i2", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"E4", "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", 
                  SubscriptBox["k", "i2"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", 
                  SubscriptBox["k", "i3"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", 
                  SubscriptBox["k", "i1"]}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", "l"}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", "l"}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", "l"}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}], "-", 
                 RowBox[{"l", "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}]}], ")"}], 
               SubscriptBox["\[Sigma]", "i1"], 
               SubscriptBox["\[Sigma]", "i2"], 
               SubscriptBox["\[Sigma]", "i3"], 
               SubscriptBox["\[Sigma]", "i4"]}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", 
                RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", 
                RowBox[{"i2", "+", "1"}], ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", 
                RowBox[{"i3", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"E5", "=", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", 
                  SubscriptBox["k", "i2"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", 
                  SubscriptBox["k", "i3"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", 
                  SubscriptBox["k", "i1"]}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", "l"}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", "l"}], "-", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", "l"}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}], "-", 
                 RowBox[{"l", "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i1"], "\[CenterDot]", 
                  SubscriptBox["k", "i5"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i2"], "\[CenterDot]", 
                  SubscriptBox["k", "i5"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i3"], "\[CenterDot]", 
                  SubscriptBox["k", "i5"]}], "+", 
                 RowBox[{
                  SubscriptBox["k", "i5"], "\[CenterDot]", 
                  SubscriptBox["k", "i4"]}], "-", 
                 RowBox[{"l", "\[CenterDot]", 
                  SubscriptBox["k", "i5"]}]}], ")"}], 
               SubscriptBox["\[Sigma]", "i1"], 
               SubscriptBox["\[Sigma]", "i2"], 
               SubscriptBox["\[Sigma]", "i3"], 
               SubscriptBox["\[Sigma]", "i4"], 
               SubscriptBox["\[Sigma]", "i5"]}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", 
                RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i3", ",", 
                RowBox[{"i2", "+", "1"}], ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i4", ",", 
                RowBox[{"i3", "+", "1"}], ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i5", ",", 
                RowBox[{"i4", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ";", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"gauge", "~", "Join", "~", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"NSolve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "E1", ",", "E2", ",", "E3", ",", "E4", ",", "E5"}], "}"}],
                     "[", 
                    RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], "]"}], "]"}], "/.", 
                   "gauge"}], "//.", "numeric"}], ")"}], "\[Equal]", "0"}], 
               ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 SubscriptBox["\[Sigma]", "i"], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ",", 
               RowBox[{"WorkingPrecision", "\[Rule]", "300"}]}], "]"}]}], "//", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "i"], "-", 
                    SubscriptBox["\[Sigma]", "j"]}], ")"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"i", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "/.",
                    "#"}], "]"}], ">", 
                 RowBox[{"10", "^", 
                  RowBox[{"-", "400"}]}]}], "&"}]}], "]"}], "&"}]}]}]}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "oneloopsolutions", " ", "only", " ", "works", " ", "in", " ", "4", 
      RowBox[{"d", ".", " ", "\[Lambda]4dT2"}], " ", "t\[Lambda]4dT2", " ", 
      "means", " ", "the", " ", "last", " ", "two", " ", "spinors", " ", 
      "are", " ", "used", " ", "to", " ", "denate", " ", "the", " ", "loop", 
      " ", "momentum", " ", 
      RowBox[{"ell", ".", " ", "oneloopsolutions"}], " ", 
      RowBox[{"doesn", "'"}], "t", " ", "always", " ", "find", " ", "all", 
      " ", "solutions", " ", "for", " ", "6", "pt"}], ",", " ", 
     RowBox[{
     "but", " ", "we", " ", "are", " ", "sure", " ", "it", " ", "does", " ", 
      "for", " ", "oneloop6pt72soln", " ", "below"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"oneloop6pt72soln", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"23", ",", "47"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "40"}], ",", "28"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"22", ",", "34"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "17"}], ",", 
           RowBox[{"-", "4"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "38"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"26", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "12"}], ",", 
           RowBox[{"-", "4"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"14", ",", "50"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "24"}], ",", "44"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "50"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "6"}], ",", 
           RowBox[{"-", "3"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "41"}], ",", "17"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["437", "6"], ",", 
           RowBox[{"-", 
            FractionBox["7871", "162"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["599", "6"]}], ",", 
           RowBox[{"-", 
            FractionBox["1921", "162"]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "15"}], ",", 
           RowBox[{"-", "30"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "18"}], ",", 
           RowBox[{"-", "47"}]}], "}"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Another", " ", "way", " ", "to", " ", "get", " ", "one", " ", "loop", 
      " ", "solutons", " ", "is", " ", "to", " ", "use", " ", "the", " ", 
      "forward", " ", 
      RowBox[{"limit", ".", " ", "eps"}], " ", "is", " ", "the", " ", 
      "forward", " ", "limit", " ", 
      RowBox[{"parameter", ".", " ", "Each"}], " ", "momentum", " ", "is", 
      " ", "expected", " ", "to", " ", "have", " ", "been", " ", "lifted", 
      " ", "in", " ", "d"}], "+", 
     RowBox[{
     "1", " ", "dimenson", " ", "with", " ", "its", " ", "last", " ", 
      "element", " ", "zero", " ", "and", " ", "ell", " ", "is", " ", "a", 
      " ", "null", " ", "vector", " ", "in", " ", "thts", " ", "d"}], "+", 
     RowBox[{"1", " ", "dimensons"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"singularsolution", "[", 
     RowBox[{"momenta_", ",", "ell_", ",", "eps_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "momentaTell", ",", "$soln", ",", "ii", ",", "$solnSingualrSector", 
        ",", "nn"}], "}"}], ",", 
      RowBox[{
       RowBox[{"nn", "=", 
        RowBox[{"Length", "@", "momenta"}]}], ";", 
       RowBox[{"momentaTell", "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "ep"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{"momenta", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"nn", "-", "2"}]}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "ep"}], ")"}], 
               RowBox[{"momenta", "[", 
                RowBox[{"[", 
                 RowBox[{"nn", "-", "1"}], "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "ep"}], ")"}], 
               RowBox[{"momenta", "[", 
                RowBox[{"[", "nn", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"ell", "+", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], "ep", " ", 
                 RowBox[{"momenta", "[", 
                  RowBox[{"[", 
                   RowBox[{"nn", "-", "1"}], "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], "ep", " ", 
                 RowBox[{"momenta", "[", 
                  RowBox[{"[", "nn", "]"}], "]"}]}]}], "//", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "3"}], "]"}], "]"}], "+", "y"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "+", "x"}]}]}], "}"}]}],
                  "]"}], "&"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "ell"}], "+", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], "ep", " ", 
                 RowBox[{"momenta", "[", 
                  RowBox[{"[", 
                   RowBox[{"nn", "-", "1"}], "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], "ep", " ", 
                 RowBox[{"momenta", "[", 
                  RowBox[{"[", "nn", "]"}], "]"}]}]}], "//", 
               RowBox[{
                RowBox[{"ReplacePart", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "3"}], "]"}], "]"}], "-", "y"}]}], ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "-", "x"}]}]}], "}"}]}],
                  "]"}], "&"}]}]}], "}"}], "//", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "/.", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"lorentzdot", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", 
                    RowBox[{
                    RowBox[{"lorentzdot", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ")"}]}], "/.", 
              RowBox[{"ep", "\[Rule]", " ", "eps"}]}], "&"}]}], "//", 
           "Simplify"}]}], "]"}]}], ";", 
       RowBox[{"$soln", "=", 
        RowBox[{"solutions", "[", 
         RowBox[{
          RowBox[{"sdata", "@", "momentaTell"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "momenta"}], "\[GreaterEqual]", " ", 
             "6"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Sigma]", "1"], "\[Rule]", "1"}], ",", 
              RowBox[{
               SubscriptBox["\[Sigma]", "2"], "\[Rule]", "0"}], ",", 
              RowBox[{
               SubscriptBox["\[Sigma]", "3"], "\[Rule]", " ", "Infinity"}]}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Sigma]", "1"], "\[Rule]", "1"}], ",", 
              RowBox[{
               SubscriptBox["\[Sigma]", "2"], "\[Rule]", "0"}], ",", 
              RowBox[{
               SubscriptBox["\[Sigma]", "3"], "\[Rule]", " ", "2"}]}], 
             "}"}]}], "]"}], ",", "1", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"1000", ",", 
            RowBox[{"20", 
             RowBox[{"Ceiling", "[", 
              RowBox[{"-", 
               RowBox[{"Log10", "@", "eps"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
       ";", 
       RowBox[{"ii", "=", "1"}], ";", 
       RowBox[{"$solnSingualrSector", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ";", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"ii", "\[LessEqual]", " ", 
          RowBox[{"Length", "@", "$soln"}]}], ",", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"$soln", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", 
                  RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"$soln", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", 
                  RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}], "<", 
             RowBox[{"1000", 
              RowBox[{"eps", "^", "2"}]}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"$solnSingualrSector", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "ii"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"$soln", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", 
                  RowBox[{"-", "2"}], ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"$soln", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", 
                  RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}]}], "]"}], ">", 
             RowBox[{"1000", "eps"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"$solnSingualrSector", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "ii"}], "]"}], ",", 
            "True", ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"$solnSingualrSector", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "ii"}], "]"}]}], "]"}], 
          ";", 
          RowBox[{"ii", "++"}]}]}], "]"}], ";", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"$soln", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          "$solnSingualrSector"}], ",", "momentaTell"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\n", 
   StyleBox[
    RowBox[{"(*", "lorentzproducts", "*)"}], "Subsubsection"], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"CenterDot", ",", "Orderless"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Before", " ", "replace", " ", "rule", " ", "lorentzproducts", " ", 
      "works"}], ",", " ", 
     RowBox[{
     "we", " ", "need", " ", "to", " ", "tell", " ", "him", " ", "the", " ", 
      "reference", " ", "by", " ", "defining", " ", "the", " ", 
      RowBox[{"function", " ", "'"}], 
      RowBox[{"ref", "'"}]}]}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lorentzproducts", "[", 
      RowBox[{"neg_List", ",", "4"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["k", "a_"], "\[CenterDot]", 
         SubscriptBox["k", "b_"]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"ab", "[", 
          RowBox[{"a", ",", "b"}], "]"}], " ", 
         RowBox[{"sb", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "b_"], "\[CenterDot]", 
         SubscriptBox["\[Epsilon]", "a_"]}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"neg", ",", "a"}], "]"}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{"a", ",", "b"}], "]"}], " ", 
             RowBox[{"sb", "[", 
              RowBox[{
               RowBox[{"ref", "[", "a", "]"}], ",", "b"}], "]"}]}], 
            RowBox[{"sb", "[", 
             RowBox[{"a", ",", 
              RowBox[{"ref", "[", "a", "]"}]}], "]"}]]}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"ab", "[", 
              RowBox[{
               RowBox[{"ref", "[", "a", "]"}], ",", "b"}], "]"}], " ", 
             RowBox[{"sb", "[", 
              RowBox[{"a", ",", "b"}], "]"}]}], 
            RowBox[{"ab", "[", 
             RowBox[{
              RowBox[{"ref", "[", "a", "]"}], ",", "a"}], "]"}]]}]}], "]"}]}],
        ",", 
       RowBox[{
        RowBox[{"l", "\[CenterDot]", 
         SubscriptBox["\[Epsilon]", "a_"]}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"neg", ",", "a"}], "]"}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "a"}], "]"}], " ", 
              RowBox[{"sb", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", 
                RowBox[{"ref", "[", "a", "]"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{
                RowBox[{"n", "+", "2"}], ",", "a"}], "]"}], " ", 
              RowBox[{"sb", "[", 
               RowBox[{
                RowBox[{"n", "+", "2"}], ",", 
                RowBox[{"ref", "[", "a", "]"}]}], "]"}]}]}], 
            RowBox[{"sb", "[", 
             RowBox[{"a", ",", 
              RowBox[{"ref", "[", "a", "]"}]}], "]"}]]}], ",", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", 
                RowBox[{"ref", "[", "a", "]"}]}], "]"}], " ", 
              RowBox[{"sb", "[", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "a"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{
                RowBox[{"n", "+", "2"}], ",", 
                RowBox[{"ref", "[", "a", "]"}]}], "]"}], " ", 
              RowBox[{"sb", "[", 
               RowBox[{
                RowBox[{"n", "+", "2"}], ",", "a"}], "]"}]}]}], 
            RowBox[{"ab", "[", 
             RowBox[{
              RowBox[{"ref", "[", "a", "]"}], ",", "a"}], "]"}]]}]}], "]"}]}],
        ",", 
       RowBox[{
        RowBox[{"l", "\[CenterDot]", 
         SubscriptBox["k", "i_"]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"i", ",", 
              RowBox[{"n", "+", "1"}]}], "]"}], " ", 
            RowBox[{"sb", "[", 
             RowBox[{"i", ",", 
              RowBox[{"n", "+", "1"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"i", ",", 
              RowBox[{"n", "+", "2"}]}], "]"}], " ", 
            RowBox[{"sb", "[", 
             RowBox[{"i", ",", 
              RowBox[{"n", "+", "2"}]}], "]"}]}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Epsilon]", "a_"], "\[CenterDot]", 
         SubscriptBox["\[Epsilon]", "b_"]}], "\[RuleDelayed]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"neg", ",", "a"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"neg", ",", "b"}], "]"}], ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"ab", "[", 
                RowBox[{"a", ",", "b"}], "]"}], " ", 
               RowBox[{"sb", "[", 
                RowBox[{
                 RowBox[{"ref", "[", "a", "]"}], ",", 
                 RowBox[{"ref", "[", "b", "]"}]}], "]"}]}], 
              RowBox[{
               RowBox[{"sb", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"ref", "[", "a", "]"}]}], "]"}], " ", 
               RowBox[{"sb", "[", 
                RowBox[{"b", ",", 
                 RowBox[{"ref", "[", "b", "]"}]}], "]"}]}]]}], ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"ab", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"ref", "[", "b", "]"}]}], "]"}], " ", 
               RowBox[{"sb", "[", 
                RowBox[{
                 RowBox[{"ref", "[", "a", "]"}], ",", "b"}], "]"}]}], 
              RowBox[{
               RowBox[{"sb", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"ref", "[", "a", "]"}]}], "]"}], " ", 
               RowBox[{"ab", "[", 
                RowBox[{
                 RowBox[{"ref", "[", "b", "]"}], ",", "b"}], "]"}]}]]}]}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"neg", ",", "b"}], "]"}], ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"ab", "[", 
                RowBox[{
                 RowBox[{"ref", "[", "a", "]"}], ",", "b"}], "]"}], " ", 
               RowBox[{"sb", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"ref", "[", "b", "]"}]}], "]"}]}], 
              RowBox[{
               RowBox[{"ab", "[", 
                RowBox[{
                 RowBox[{"ref", "[", "a", "]"}], ",", "a"}], "]"}], " ", 
               RowBox[{"sb", "[", 
                RowBox[{"b", ",", 
                 RowBox[{"ref", "[", "b", "]"}]}], "]"}]}]]}], ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"2", " ", 
               RowBox[{"ab", "[", 
                RowBox[{
                 RowBox[{"ref", "[", "a", "]"}], ",", 
                 RowBox[{"ref", "[", "b", "]"}]}], "]"}], " ", 
               RowBox[{"sb", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}], 
              RowBox[{
               RowBox[{"ab", "[", 
                RowBox[{
                 RowBox[{"ref", "[", "a", "]"}], ",", "a"}], "]"}], " ", 
               RowBox[{"ab", "[", 
                RowBox[{
                 RowBox[{"ref", "[", "b", "]"}], ",", "b"}], "]"}]}]]}]}], 
           "]"}]}], "]"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lorentzproducts", "[", "neg_List", "]"}], ":=", 
     RowBox[{"lorentzproducts", "[", 
      RowBox[{"neg", ",", "4"}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"We", " ", "use", " ", "the", " ", "convention", " ", "n"}], 
      "+", "1"}], ",", " ", 
     RowBox[{"n", "+", 
      RowBox[{
      "2", " ", "to", " ", "denote", " ", "the", " ", "massive", " ", "loop", 
       " ", "momentum", " ", "when", " ", "it", " ", "is", " ", 
       "involved"}]}]}], "*)"}], "\[IndentingNewLine]", "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lorentzproducts", "[", 
      RowBox[{"helist_List", ",", "6"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["k", "i_"], "\[CenterDot]", 
         SubscriptBox["k", "j_"]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], 
         RowBox[{"Det", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"asb", "[", 
             RowBox[{"i", ",", "j", ",", "a", ",", "bd"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"bd", ",", "2"}], "}"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["k", "i_"], "\[CenterDot]", 
         SubscriptBox["\[Epsilon]", "j_"]}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Signature", "[", 
             RowBox[{"{", 
              RowBox[{"ia", ",", "ib"}], "}"}], "]"}], 
            RowBox[{"Signature", "[", 
             RowBox[{"{", 
              RowBox[{"rjbd", ",", "rjbd2"}], "}"}], "]"}], 
            RowBox[{"asb", "[", 
             RowBox[{"i", ",", 
              RowBox[{"ref", "[", "j", "]"}], ",", "ia", ",", "rjbd"}], "]"}], 
            RowBox[{"asb", "[", 
             RowBox[{"i", ",", "j", ",", "ib", ",", 
              RowBox[{"helist", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], 
            RowBox[{"asb", "[", 
             RowBox[{"j", ",", 
              RowBox[{"ref", "[", "j", "]"}], ",", 
              RowBox[{"helist", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", "rjbd2"}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ia", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ib", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"rjbd", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"rjbd2", ",", "2"}], "}"}]}], "]"}], "/", 
         RowBox[{"Det", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"asb", "[", 
             RowBox[{"j", ",", 
              RowBox[{"ref", "[", "j", "]"}], ",", "a", ",", "bd"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"bd", ",", "2"}], "}"}]}], "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Epsilon]", "i_"], "\[CenterDot]", 
         SubscriptBox["\[Epsilon]", "j_"]}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Signature", "[", 
              RowBox[{"{", 
               RowBox[{"rib", ",", "rib2"}], "}"}], "]"}], 
             RowBox[{"Signature", "[", 
              RowBox[{"{", 
               RowBox[{"rjbd", ",", "rjbd2"}], "}"}], "]"}], 
             RowBox[{"asb", "[", 
              RowBox[{"i", ",", 
               RowBox[{"ref", "[", "j", "]"}], ",", 
               RowBox[{"helist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "rjbd"}], "]"}], 
             RowBox[{"asb", "[", 
              RowBox[{
               RowBox[{"ref", "[", "i", "]"}], ",", "j", ",", "rib", ",", 
               RowBox[{"helist", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "]"}], 
             RowBox[{"asb", "[", 
              RowBox[{
               RowBox[{"ref", "[", "i", "]"}], ",", "i", ",", "rib2", ",", 
               RowBox[{"helist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], 
             RowBox[{"asb", "[", 
              RowBox[{"j", ",", 
               RowBox[{"ref", "[", "j", "]"}], ",", 
               RowBox[{"helist", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", "rjbd2"}], 
              "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"rib", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"rib2", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"rjbd", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"rjbd2", ",", "2"}], "}"}]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Det", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"asb", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"ref", "[", "i", "]"}], ",", "a", ",", "bd"}], "]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"bd", ",", "2"}], "}"}]}], "]"}]}], 
            RowBox[{"Det", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"asb", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"ref", "[", "j", "]"}], ",", "a", ",", "bd"}], "]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"bd", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"replaceTrace4d", "[", "neg_List", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"trace", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"Union", "[", 
            RowBox[{"neg", ",", "i"}], "]"}]}], "==", 
          RowBox[{"Length", "@", "neg"}]}], ",", 
         RowBox[{"2", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"i", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"Length", "@", "i"}], "-", "1"}]}], "}"}]}], "]"}], 
          RowBox[{"ab", "[", 
           RowBox[{
            RowBox[{"i", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Length", "@", 
           RowBox[{"Union", "[", 
            RowBox[{"neg", ",", "i"}], "]"}]}], "\[Equal]", 
          RowBox[{
           RowBox[{"Length", "@", "neg"}], "+", 
           RowBox[{"Length", "@", "i"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"Length", "@", "i"}], ")"}]}], " ", "2", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"sb", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"i", "[", 
               RowBox[{"[", 
                RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"Length", "@", "i"}], "-", "1"}]}], "}"}]}], "]"}], 
          RowBox[{"sb", "[", 
           RowBox[{
            RowBox[{"i", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Union", "[", 
             RowBox[{"neg", ",", "i"}], "]"}]}], "==", 
           RowBox[{
            RowBox[{"Length", "@", "neg"}], "+", "1"}]}], "||", 
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"Union", "[", 
             RowBox[{"neg", ",", "i"}], "]"}]}], "==", 
           RowBox[{
            RowBox[{"Length", "@", "neg"}], "+", 
            RowBox[{"Length", "@", "i"}], "-", "1"}]}]}], ",", "0", ",", 
         "True", ",", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"$i1", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"neg", ",", "#"}], "]"}], "&"}]}], "]"}]}], ",", 
             RowBox[{"$i2", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"neg", ",", "#"}], "]"}]}], "&"}]}], "]"}]}]}], 
            "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"Length", "@", "$i2"}], ")"}]}], 
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{"ab", "[", 
               RowBox[{
                RowBox[{"$i1", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"$i1", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{
                 RowBox[{"Length", "@", "$i1"}], "-", "1"}]}], "}"}]}], "]"}], 
            RowBox[{"ab", "[", 
             RowBox[{
              RowBox[{"$i1", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ",", 
              RowBox[{"$i1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{"sb", "[", 
               RowBox[{
                RowBox[{"$i2", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"$i2", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{
                 RowBox[{"Length", "@", "$i2"}], "-", "1"}]}], "}"}]}], "]"}], 
            RowBox[{"sb", "[", 
             RowBox[{
              RowBox[{"$i2", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], ",", 
              RowBox[{"$i2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
      "}"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Pf", "[", "A_", "]"}], ":=", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Length", "[", "A", "]"}], ",", "0", ",", "1", ",", 
       RowBox[{"_", "?", "OddQ"}], ",", "0", ",", 
       RowBox[{"_", "?", "EvenQ"}], ",", 
       RowBox[{"xPf", "[", "A", "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"xPf", "[", "A_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "A", "]"}], "\[Equal]", "2"}], ",", 
       RowBox[{"A", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "i"], " ", 
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], " ", 
          RowBox[{"xPf", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Delete", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"Delete", "[", 
                RowBox[{"A", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "1", "}"}], ",", 
                   RowBox[{"{", "i", "}"}]}], "}"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "1", "}"}], ",", 
                RowBox[{"{", "i", "}"}]}], "}"}]}], "]"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pfaffianNumericpre", "[", 
      RowBox[{"matrix_", ",", 
       RowBox[{"{", 
        RowBox[{"j_", ",", "i_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"matrix", "//", 
         RowBox[{"Function", "[", 
          RowBox[{"slot", ",", 
           RowBox[{
            RowBox[{"kk", "=", "j"}], ";", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"kk", "\[LessEqual]", " ", 
                RowBox[{"Length", "@", "matrix"}]}], "&&", 
               RowBox[{
                RowBox[{"Abs", "@", 
                 RowBox[{"slot", "[", 
                  RowBox[{"[", 
                   RowBox[{"kk", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], "]"}]}], "<", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "50"}]}]}]}], ",", 
              RowBox[{"kk", "++"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"kk", ">", 
               RowBox[{"Length", "@", "matrix"}]}], ",", 
              RowBox[{"RandomInteger", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Length", "@", "matrix"}], ",", 
                  RowBox[{"Length", "@", "matrix"}]}], "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"kk", ">", "j"}], ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"slot", ",", 
                   RowBox[{"j", "\[Rule]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"slot", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", " ", 
                    RowBox[{"slot", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}]}], ")"}]}]}], "]"}], ",", 
                 "slot"}], "]"}], "//", 
               RowBox[{"Function", "[", 
                RowBox[{"slot1", ",", 
                 RowBox[{"ReplacePart", "[", 
                  RowBox[{"slot1", ",", 
                   RowBox[{"i", "\[Rule]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"slot1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", 
                    RowBox[{"x", " ", 
                    RowBox[{"slot1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "//", 
                    RowBox[{
                    RowBox[{"#", "/.", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}], "\[Equal]", "0"}], 
                    ",", "x"}], "]"}]}]}], "&"}]}], ")"}]}]}], "]"}]}], 
                "]"}]}]}], "]"}]}]}], "]"}]}], "//", "Transpose"}], "//", 
       RowBox[{"Function", "[", 
        RowBox[{"slot", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"kk", ">", 
            RowBox[{"Length", "@", "matrix"}]}], ",", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "@", "matrix"}], ",", 
               RowBox[{"Length", "@", "matrix"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"kk", ">", "j"}], ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"slot", ",", 
                RowBox[{"j", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"slot", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "+", " ", 
                   RowBox[{"slot", "[", 
                    RowBox[{"[", "kk", "]"}], "]"}]}], ")"}]}]}], "]"}], ",", 
              "slot"}], "]"}], "//", 
            RowBox[{"Function", "[", 
             RowBox[{"slot1", ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"slot1", ",", 
                RowBox[{"i", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"slot1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", 
                    RowBox[{"x", " ", 
                    RowBox[{"slot1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "//", 
                   RowBox[{
                    RowBox[{"#", "/.", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}], "\[Equal]", "0"}], 
                    ",", "x"}], "]"}]}]}], "&"}]}], ")"}]}]}], "]"}]}], 
             "]"}]}]}], "]"}]}], "]"}]}], "//", "Transpose"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pfaffianNumeric", "[", "matrix_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Fold", "[", 
       RowBox[{"pfaffianNumericpre", ",", "matrix", ",", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"j", ",", "i"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{
              RowBox[{"Length", "@", "matrix"}], "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"j", "+", "1"}], ",", 
             RowBox[{"Length", "@", "matrix"}]}], "}"}]}], "]"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "i"}], "-", "1"}], ",", 
            RowBox[{"2", "i"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"Length", "@", "matrix"}], "/", "2"}]}], "}"}]}], "]"}], 
       "&"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{"(*", 
     RowBox[{"YM", " ", "GR", " ", "BI", " ", 
      RowBox[{"F", "^", "3"}], " ", "amplitudes", " ", "numeric"}], " ", 
     "*)"}], "Subsubsection"], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"jacobianchy", "[", 
      RowBox[{"n_", ",", 
       RowBox[{"list_List:", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}]}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "3"}], ",", 
       RowBox[{"1", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Sigma]", 
              RowBox[{"list", "[", 
               RowBox[{"[", "1", "]"}], "]"}]], "-", 
             SubscriptBox["\[Sigma]", 
              RowBox[{"list", "[", 
               RowBox[{"[", "2", "]"}], "]"}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Sigma]", 
              RowBox[{"list", "[", 
               RowBox[{"[", "2", "]"}], "]"}]], "-", 
             SubscriptBox["\[Sigma]", 
              RowBox[{"list", "[", 
               RowBox[{"[", "3", "]"}], "]"}]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Sigma]", 
              RowBox[{"list", "[", 
               RowBox[{"[", "3", "]"}], "]"}]], "-", 
             SubscriptBox["\[Sigma]", 
              RowBox[{"list", "[", 
               RowBox[{"[", "1", "]"}], "]"}]]}], ")"}]}], ")"}], "^", 
         "2"}]}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "eq", "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"eq", "[", "i_", "]"}], ":=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["s", 
               RowBox[{"i", ",", "j"}]], "/", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Sigma]", "i"], "-", 
                SubscriptBox["\[Sigma]", "j"]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Range", "[", "n", "]"}], ",", 
                 RowBox[{"{", "i", "}"}]}], "]"}]}], "}"}]}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"holdDet", "@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"eq", "[", "i", "]"}], ",", 
                SubscriptBox["\[Sigma]", "j"]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Range", "@", "n"}], ",", "list"}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Range", "@", "n"}], ",", "list"}], "]"}]}], 
               "}"}]}], "]"}]}], "/", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Sigma]", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]], "-", 
                SubscriptBox["\[Sigma]", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Sigma]", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]], "-", 
                SubscriptBox["\[Sigma]", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Sigma]", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]], "-", 
                SubscriptBox["\[Sigma]", 
                 RowBox[{"list", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]]}], ")"}]}], ")"}], "^", 
            "2"}]}]}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"jacobianchy4d", "[", 
      RowBox[{"\[Lambda]4d_", ",", "t\[Lambda]4d_", ",", "neg_List"}], "]"}], 
     ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Eq", ",", "pos", ",", "var", ",", "$\[Lambda]4d", ",", 
         "$t\[Lambda]4d"}], "}"}], ",", 
       RowBox[{
        RowBox[{"pos", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Range", "@", "n"}], ",", "neg"}], "]"}]}], ";", 
        RowBox[{"$\[Lambda]4d", "=", "\[Lambda]4d"}], ";", " ", 
        RowBox[{"$t\[Lambda]4d", "=", "t\[Lambda]4d"}], ";", 
        RowBox[{"Eq", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"$t\[Lambda]4d", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$t\[Lambda]4d", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], 
                  SubscriptBox["t", "i"], 
                  RowBox[{
                   SubscriptBox["t", "j"], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "i"], "-", 
                    SubscriptBox["\[Sigma]", "j"]}], ")"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "pos"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "neg"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"$\[Lambda]4d", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"$\[Lambda]4d", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], 
                  SubscriptBox["t", "i"], 
                  RowBox[{
                   SubscriptBox["t", "j"], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "i"], "-", 
                    SubscriptBox["\[Sigma]", "j"]}], ")"}]}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "neg"}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "pos"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
        ";", 
        RowBox[{"var", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["\[Sigma]", "i"], ",", 
              SubscriptBox["t", "i"]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Flatten", "@", 
               RowBox[{"{", 
                RowBox[{"neg", ",", "pos"}], "}"}]}]}], "}"}]}], "]"}], 
          "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "neg"}], "\[GreaterEqual]", " ", "2"}], ",", 
          RowBox[{
           RowBox[{"holdDet", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"Eq", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"var", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "5", ",", 
                RowBox[{"2", "n"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "5", ",", 
                RowBox[{"2", "n"}]}], "}"}]}], "]"}], "]"}], "/", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"$\[Lambda]4d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"neg", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                 " ", 
                 RowBox[{"$\[Lambda]4d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"neg", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], 
                  "]"}]}], "-", 
                RowBox[{
                 RowBox[{"$\[Lambda]4d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"neg", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                 RowBox[{"$\[Lambda]4d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"neg", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], 
                  "]"}]}]}], ")"}], "^", "2"}], " ", 
             SubscriptBox["t", 
              RowBox[{"neg", "[", 
               RowBox[{"[", "1", "]"}], "]"}]], " ", 
             SubscriptBox["t", 
              RowBox[{"neg", "[", 
               RowBox[{"[", "2", "]"}], "]"}]], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Sigma]", 
                 RowBox[{"neg", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]], "-", 
                SubscriptBox["\[Sigma]", 
                 RowBox[{"neg", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]]}], ")"}], "^", "2"}]}], " ",
             ")"}]}], ",", 
          RowBox[{
           RowBox[{"holdDet", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"Eq", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"var", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{
                 RowBox[{"2", "n"}], "-", "4"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{
                 RowBox[{"2", "n"}], "-", "4"}]}], "}"}]}], "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"$t\[Lambda]4d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
                  "]"}], 
                 RowBox[{"$t\[Lambda]4d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", "2"}], "]"}], 
                  "]"}]}], "-", 
                RowBox[{
                 RowBox[{"$t\[Lambda]4d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", "2"}], "]"}], 
                  "]"}], 
                 RowBox[{"$t\[Lambda]4d", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], ",", "1"}], "]"}], 
                  "]"}]}]}], ")"}], "^", "2"}], " ", 
             SubscriptBox["t", 
              RowBox[{"pos", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]], " ", 
             SubscriptBox["t", 
              RowBox[{"pos", "[", 
               RowBox[{"[", 
                RowBox[{"-", "2"}], "]"}], "]"}]], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Sigma]", 
                 RowBox[{"pos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]], "-", 
                SubscriptBox["\[Sigma]", 
                 RowBox[{"pos", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]]}], ")"}], "^", "2"}]}], 
            " ", ")"}]}]}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"parketaylorsigma", "[", "list_List", "]"}], ":=", 
     RowBox[{"1", "/", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Sigma]", 
          RowBox[{"list", "[", 
           RowBox[{"[", "i", "]"}], "]"}]], "-", 
         SubscriptBox["\[Sigma]", 
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"Length", "@", "list"}], ",", "1"}], "]"}], "]"}], 
           "]"}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}]}], " ", 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"capitalpsi", "[", 
      RowBox[{"n_Integer", ",", "list_List"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[LessEqual]", "n"}], "&&", 
          RowBox[{"j", "\[LessEqual]", " ", "n"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "j"}], ",", "0", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["k", "i"], "\[CenterDot]", 
              SubscriptBox["k", "j"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["\[Sigma]", "i"], "-", 
              SubscriptBox["\[Sigma]", "j"]}], ")"}]}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", ">", "n"}], "&&", 
            RowBox[{"j", ">", "n"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "j"}], ",", "0", ",", 
             FractionBox[
              RowBox[{" ", 
               RowBox[{
                SubscriptBox["\[Epsilon]", 
                 RowBox[{"i", "-", "n"}]], "\[CenterDot]", 
                SubscriptBox["\[Epsilon]", 
                 RowBox[{"j", "-", "n"}]]}]}], 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["\[Sigma]", 
                 RowBox[{"i", "-", "n"}]], "-", 
                SubscriptBox["\[Sigma]", 
                 RowBox[{"j", "-", "n"}]]}], ")"}]]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", ">", "n"}], "&&", 
              RowBox[{"j", "\[LessEqual]", "n"}]}], ",", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", 
                RowBox[{"j", "+", "n"}]}], ",", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"m", "\[Equal]", "j"}], ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Epsilon]", 
                    RowBox[{"i", "-", "n"}]], "\[CenterDot]", 
                    SubscriptBox["k", "m"]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", 
                    RowBox[{"i", "-", "n"}]], "-", 
                    SubscriptBox["\[Sigma]", "m"]}], ")"}]}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "n"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Epsilon]", 
                   RowBox[{"i", "-", "n"}]], "\[CenterDot]", 
                  SubscriptBox["k", "j"]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", 
                   RowBox[{"i", "-", "n"}]], "-", 
                  SubscriptBox["\[Sigma]", "j"]}], ")"}]}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", 
                RowBox[{"j", "-", "n"}]}], ",", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"m", "\[Equal]", "i"}], ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Epsilon]", "i"], "\[CenterDot]", 
                    SubscriptBox["k", "m"]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "m"], "-", 
                    SubscriptBox["\[Sigma]", "i"]}], ")"}]}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "n"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Epsilon]", 
                   RowBox[{"j", "-", "n"}]], "\[CenterDot]", 
                  SubscriptBox["k", "i"]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "i"], "-", 
                  SubscriptBox["\[Sigma]", 
                   RowBox[{"j", "-", "n"}]]}], ")"}]}]}], "]"}]}], "]"}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"2", "n"}], "]"}], ",", "list"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"2", "n"}], "]"}], ",", "list"}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpYMchy4dnumeric", "[", 
     RowBox[{
     "neg_", ",", "list_List", ",", "\[Lambda]4d_", ",", "t\[Lambda]4d_"}], 
     "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "neg"}], ">", "3"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "neg"}], "<", "2"}], "||", 
         RowBox[{
          RowBox[{"Length", "@", "neg"}], ">", 
          RowBox[{
           RowBox[{"Length", "@", "list"}], "-", "2"}]}]}], ")"}]}], ",", "0",
       ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ab", ",", "sb", ",", "ref"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ref", "[", "a_Integer", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"neg", ",", "a"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{"list", ",", "neg"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"neg", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", " ", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
         RowBox[{
          RowBox[{"sb", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "2"}], "]"}], "]"}], 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"Length", "@", "list"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", ">", "7"}], ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", 
                  "Infinity"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}], 
              ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], 
                "}"}]}]}], "]"}], ";", 
            RowBox[{"soln", "=", 
             RowBox[{"solutions", "[", 
              RowBox[{
               RowBox[{"sdata", "[", 
                RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
               "sl2gauge"}], "]"}]}], ";", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", "4"}], " ", 
                RowBox[{"parketaylorsigma", "[", "list", "]"}], 
                RowBox[{"Pf", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"capitalpsi", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "/.", 
                   RowBox[{"lorentzproducts", "[", "neg", "]"}]}], "/.", 
                  RowBox[{"soln", "[", 
                   RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], "2", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "2"}], ")"}]}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["\[Sigma]", "1"], "-", 
                    SubscriptBox["\[Sigma]", "2"]}], ")"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                    RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                    RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                   RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}]}], "/.", 
               RowBox[{"soln", "[", 
                RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"iii", ",", 
                RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}]}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpGRchy4dnumeric", "[", 
     RowBox[{"neg_", ",", "\[Lambda]4d_", ",", "t\[Lambda]4d_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "neg"}], ">", "3"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "neg"}], "<", "2"}], "||", 
         RowBox[{
          RowBox[{"Length", "@", "neg"}], ">", 
          RowBox[{
           RowBox[{"Length", "@", "\[Lambda]4d"}], "-", "2"}]}]}], ")"}]}], 
      ",", "0", ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ab", ",", "sb", ",", "ref"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ref", "[", "a_Integer", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"neg", ",", "a"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "@", 
                RowBox[{"Length", "@", "\[Lambda]4d"}]}], ",", "neg"}], "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"neg", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", " ", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
         RowBox[{
          RowBox[{"sb", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "2"}], "]"}], "]"}], 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"Length", "@", "\[Lambda]4d"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", ">", "7"}], ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", 
                  "Infinity"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}], 
              ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], 
                "}"}]}]}], "]"}], ";", 
            RowBox[{"soln", "=", 
             RowBox[{"solutions", "[", 
              RowBox[{
               RowBox[{"sdata", "[", 
                RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
               "sl2gauge"}], "]"}]}], ";", 
            RowBox[{"Sum", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Det", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"capitalpsi", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "/.", 
                    RowBox[{"lorentzproducts", "[", "neg", "]"}]}], "/.", 
                   RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], "/", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["\[Sigma]", "1"], "-", 
                    SubscriptBox["\[Sigma]", "2"]}], ")"}], "^", "2"}]}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                    RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                    RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                   RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                  RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}], "/.", 
               RowBox[{"soln", "[", 
                RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"iii", ",", 
                RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}]}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpBIchy4dnumeric", "[", 
     RowBox[{"neg_", ",", "\[Lambda]4d_", ",", "t\[Lambda]4d_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"EvenQ", "@", 
        RowBox[{"Length", "@", "\[Lambda]4d"}]}], "&&", 
       RowBox[{
        RowBox[{"Length", "@", "neg"}], " ", "==", 
        RowBox[{
         RowBox[{"Length", "@", "\[Lambda]4d"}], "/", "2"}]}]}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ab", ",", "sb", ",", "ref"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"ref", "[", "a_Integer", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"neg", ",", "a"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "@", 
                RowBox[{"Length", "@", "\[Lambda]4d"}]}], ",", "neg"}], "]"}],
              "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"neg", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", " ", 
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
         RowBox[{
          RowBox[{"sb", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "2"}], "]"}], "]"}], 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"Length", "@", "\[Lambda]4d"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", ">", "7"}], ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", 
                  "Infinity"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}], 
              ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], 
                "}"}]}]}], "]"}], ";", 
            RowBox[{"soln", "=", 
             RowBox[{"solutions", "[", 
              RowBox[{
               RowBox[{"sdata", "[", 
                RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
               "sl2gauge"}], "]"}]}], ";", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"8", " ", 
                RowBox[{"Det", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"capitalpsi", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}]}]}], "]"}], "]"}], "/.", 
                   RowBox[{"lorentzproducts", "[", "neg", "]"}]}], "/.", 
                  RowBox[{"soln", "[", 
                   RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], 
                RowBox[{
                 RowBox[{
                  RowBox[{"Pf", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"capitalpsi", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "/.", 
                    RowBox[{"lorentzproducts", "[", "neg", "]"}]}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], "/", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "1"], "-", 
                    SubscriptBox["\[Sigma]", "2"]}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                    RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                    RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                   RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}]}], "/.", 
               RowBox[{"soln", "[", 
                RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"iii", ",", 
                RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}]}]}], "]"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpDBIpurescalarchy4dnumeric", "[", 
     RowBox[{"\[Lambda]4d_", ",", "t\[Lambda]4d_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"EvenQ", "@", 
       RowBox[{"Length", "@", "\[Lambda]4d"}]}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ab", ",", "sb"}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
         RowBox[{
          RowBox[{"sb", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "2"}], "]"}], "]"}], 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"Length", "@", "\[Lambda]4d"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", ">", "7"}], ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", 
                  "Infinity"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}], 
              ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], 
                "}"}]}]}], "]"}], ";", 
            RowBox[{"soln", "=", 
             RowBox[{"solutions", "[", 
              RowBox[{
               RowBox[{"sdata", "[", 
                RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
               "sl2gauge"}], "]"}]}], ";", 
            RowBox[{"Sum", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Det", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"capitalpsi", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}]}]}], "]"}], "]"}], "/.", 
                    RowBox[{"lorentzproducts", "[", 
                    RowBox[{"{", "}"}], "]"}]}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], "^", "2"}], 
                 "/", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["\[Sigma]", "1"], "-", 
                    SubscriptBox["\[Sigma]", "2"]}], ")"}], "^", "4"}]}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                    RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                    RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                   RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                  RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}], "/.", 
               RowBox[{"soln", "[", 
                RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"iii", ",", 
                RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}]}]}], "]"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpNLSMchy4dnumeric", "[", 
     RowBox[{"list_List", ",", "\[Lambda]4d_", ",", "t\[Lambda]4d_"}], "]"}], 
    ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"EvenQ", "@", 
       RowBox[{"Length", "@", "\[Lambda]4d"}]}], ",", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ab", ",", "sb"}], "}"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ab", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
             RowBox[{"\[Lambda]4d", "[", 
              RowBox[{"[", 
               RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
         RowBox[{
          RowBox[{"sb", "[", 
           RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "2"}], "]"}], "]"}], 
              RowBox[{"t\[Lambda]4d", "[", 
               RowBox[{"[", 
                RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
           RowBox[{
            RowBox[{"n", "=", 
             RowBox[{"Length", "@", "\[Lambda]4d"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"n", ">", "7"}], ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", 
                  "Infinity"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}], 
              ",", 
              RowBox[{"sl2gauge", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], 
                "}"}]}]}], "]"}], ";", 
            RowBox[{"soln", "=", 
             RowBox[{"solutions", "[", 
              RowBox[{
               RowBox[{"sdata", "[", 
                RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
               "sl2gauge"}], "]"}]}], ";", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"1", "/", "2"}], " ", 
                RowBox[{"parketaylorsigma", "[", "list", "]"}], " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Det", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"capitalpsi", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}]}]}], "]"}], "]"}], "/.", 
                    RowBox[{"lorentzproducts", "[", 
                    RowBox[{"{", "}"}], "]"}]}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], "/", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "1"], "-", 
                    SubscriptBox["\[Sigma]", "2"]}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                    RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                    RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                   RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}]}], "/.", 
               RowBox[{"soln", "[", 
                RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"iii", ",", 
                RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
          "]"}]}]}], "]"}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ampphi3chy4dnumeric", "[", 
     RowBox[{
     "list1_List", ",", "list2_List", ",", "\[Lambda]4d_", ",", 
      "t\[Lambda]4d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ab", ",", "sb"}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]4d", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"\[Lambda]4d", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"\[Lambda]4d", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"\[Lambda]4d", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
       RowBox[{
        RowBox[{"sb", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"t\[Lambda]4d", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"t\[Lambda]4d", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"t\[Lambda]4d", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "2"}], "]"}], "]"}], 
            RowBox[{"t\[Lambda]4d", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"Length", "@", "\[Lambda]4d"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", ">", "7"}], ",", 
            RowBox[{"sl2gauge", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", "Infinity"}], 
               ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}], 
            ",", 
            RowBox[{"sl2gauge", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}]}], 
           "]"}], ";", 
          RowBox[{"soln", "=", 
           RowBox[{"solutions", "[", 
            RowBox[{
             RowBox[{"sdata", "[", 
              RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
             "sl2gauge"}], "]"}]}], ";", 
          RowBox[{"Sum", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"n", "+", "1"}], ")"}]}], 
              RowBox[{"parketaylorsigma", "[", "list1", "]"}], "  ", 
              RowBox[{
               RowBox[{"parketaylorsigma", "[", "list2", "]"}], " ", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                   RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                    RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                  RowBox[{"soln", "[", 
                   RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                 RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}]}], "/.", 
             RowBox[{"soln", "[", 
              RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"iii", ",", 
              RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
        "]"}]}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpF3chy4dnumeric", "[", 
     RowBox[{
     "neg_", ",", "list_List", ",", "\[Lambda]4d_", ",", "t\[Lambda]4d_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ab", ",", "sb", ",", "ref", ",", "\[Lambda]4dT1", ",", 
        "t\[Lambda]4dT1"}], "}"}], ",", 
      RowBox[{
       RowBox[{"\[Lambda]4dT1", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"\[Lambda]4d", ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "10000"}], ",", "10000"}], "}"}], ",", "2"}], 
           "]"}]}], "]"}]}], ";", 
       RowBox[{"t\[Lambda]4dT1", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"t\[Lambda]4d", ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "10000"}], ",", "10000"}], "}"}], ",", "2"}], 
           "]"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"ref", "[", "a_Integer", "]"}], ":=", 
        RowBox[{
         RowBox[{"Length", "@", "\[Lambda]4d"}], "+", "1"}]}], ";", " ", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]4dT1", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"\[Lambda]4dT1", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"\[Lambda]4dT1", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"\[Lambda]4dT1", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
       RowBox[{
        RowBox[{"sb", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"t\[Lambda]4dT1", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"t\[Lambda]4dT1", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"t\[Lambda]4dT1", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "2"}], "]"}], "]"}], 
            RowBox[{"t\[Lambda]4dT1", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"Length", "@", "list"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", ">", "7"}], ",", 
            RowBox[{"sl2gauge", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", "Infinity"}], 
               ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}], 
            ",", 
            RowBox[{"sl2gauge", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}]}], 
           "]"}], ";", 
          RowBox[{"soln", "=", 
           RowBox[{"solutions", "[", 
            RowBox[{
             RowBox[{"sdata", "[", 
              RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
             "sl2gauge"}], "]"}]}], ";", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "4"}], " ", 
              RowBox[{"parketaylorsigma", "[", "list", "]"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"subcycleset", "@", "list"}], "//", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Length", "/@", 
                    RowBox[{"List", "@@", "#"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}], "#"}], "&"}], "/@",
                     "#"}], "&"}]}], "//", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "/.", 
                    RowBox[{
                    RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "\[Equal]", "i"}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Epsilon]", "i"], "\[CenterDot]", 
                    SubscriptBox["k", "m"]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "i"], "-", 
                    SubscriptBox["\[Sigma]", "m"]}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "list"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{
                    RowBox[{"trace", "[", 
                    RowBox[{"{", "i", "}"}], "]"}], " ", "/", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Sigma]", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}]], "-", 
                    SubscriptBox["\[Sigma]", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], ",", "1"}], "]"}], "]"}], 
                    "]"}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}]}], "}"}]}], "]"}]}]}]}], 
                    "]"}]}]}], "/.", 
                    RowBox[{"replaceTrace", "@", "neg"}]}], "/.", 
                   RowBox[{"lorentzproducts", "[", "neg", "]"}]}], "&"}]}], 
                ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                   RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                    RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                  RowBox[{"soln", "[", 
                   RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                 RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}]}], "/.", 
             RowBox[{"soln", "[", 
              RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"iii", ",", 
              RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AmpR3chy4dnumeric", "[", 
     RowBox[{"neg_", ",", "\[Lambda]4d_", ",", "t\[Lambda]4d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ab", ",", "sb", ",", "ref", ",", "\[Lambda]4dT1", ",", 
        "t\[Lambda]4dT1", ",", "list"}], "}"}], ",", 
      RowBox[{
       RowBox[{"list", "=", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "\[Lambda]4d"}]}]}], ";", 
       RowBox[{"\[Lambda]4dT1", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"\[Lambda]4d", ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "10000"}], ",", "10000"}], "}"}], ",", "2"}], 
           "]"}]}], "]"}]}], ";", 
       RowBox[{"t\[Lambda]4dT1", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"t\[Lambda]4d", ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "10000"}], ",", "10000"}], "}"}], ",", "2"}], 
           "]"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"ref", "[", "a_Integer", "]"}], ":=", 
        RowBox[{
         RowBox[{"Length", "@", "\[Lambda]4d"}], "+", "1"}]}], ";", " ", 
       RowBox[{
        RowBox[{"ab", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Lambda]4dT1", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
           RowBox[{"\[Lambda]4dT1", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"\[Lambda]4dT1", "[", 
            RowBox[{"[", 
             RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
           RowBox[{"\[Lambda]4dT1", "[", 
            RowBox[{"[", 
             RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
       RowBox[{
        RowBox[{"sb", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"t\[Lambda]4dT1", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
            RowBox[{"t\[Lambda]4dT1", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"t\[Lambda]4dT1", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "2"}], "]"}], "]"}], 
            RowBox[{"t\[Lambda]4dT1", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"Length", "@", "list"}]}], ";", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", ">", "7"}], ",", 
            RowBox[{"sl2gauge", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", "Infinity"}], 
               ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}], 
            ",", 
            RowBox[{"sl2gauge", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
               RowBox[{
                SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], "}"}]}]}], 
           "]"}], ";", 
          RowBox[{"soln", "=", 
           RowBox[{"solutions", "[", 
            RowBox[{
             RowBox[{"sdata", "[", 
              RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
             "sl2gauge"}], "]"}]}], ";", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"subcycleset", "@", "list"}], "//", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Length", "/@", 
                    RowBox[{"List", "@@", "#"}]}], ",", 
                    RowBox[{
                    RowBox[{"#", ">", "1"}], "&"}]}], "]"}]}], "#"}], "&"}], "/@",
                     "#"}], "&"}]}], "//", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "/.", 
                    RowBox[{
                    RowBox[{"subcycle", "[", "i__", "]"}], "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], "\[Equal]", "1"}], ",", " ", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"m", "\[Equal]", "i"}], ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Epsilon]", "i"], "\[CenterDot]", 
                    SubscriptBox["k", "m"]}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "i"], "-", 
                    SubscriptBox["\[Sigma]", "m"]}], ")"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "list"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], 
                    RowBox[{
                    RowBox[{"trace", "[", 
                    RowBox[{"{", "i", "}"}], "]"}], " ", "/", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["\[Sigma]", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}]], "-", 
                    SubscriptBox["\[Sigma]", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"j", "+", "1"}], ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}], ",", "1"}], "]"}], "]"}], 
                    "]"}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "i", "}"}]}]}], "}"}]}], "]"}]}]}]}], 
                    "]"}]}]}], "/.", 
                    RowBox[{"replaceTrace", "@", "neg"}]}], "/.", 
                   RowBox[{"lorentzproducts", "[", "neg", "]"}]}], "&"}]}], 
                ")"}], "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                  RowBox[{
                   SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                   RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                 RowBox[{"soln", "[", 
                  RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}], "/.", 
             RowBox[{"soln", "[", 
              RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"iii", ",", 
              RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
        "]"}]}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"AmpsGalchy4dnumeric", "[", 
     RowBox[{"\[Lambda]4d_", ",", "t\[Lambda]4d_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", "=", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", "\[Lambda]4d"}]}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "@", 
         RowBox[{"Length", "@", "\[Lambda]4d"}]}], ",", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ab", ",", "sb"}], "}"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"ab", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Lambda]4d", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
               RowBox[{"\[Lambda]4d", "[", 
                RowBox[{"[", 
                 RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"\[Lambda]4d", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", "2"}], "]"}], "]"}], " ", 
               RowBox[{"\[Lambda]4d", "[", 
                RowBox[{"[", 
                 RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ";", 
           RowBox[{
            RowBox[{"sb", "[", 
             RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"t\[Lambda]4d", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "1"}], "]"}], "]"}], " ", 
                RowBox[{"t\[Lambda]4d", "[", 
                 RowBox[{"[", 
                  RowBox[{"b", ",", "2"}], "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"t\[Lambda]4d", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "2"}], "]"}], "]"}], 
                RowBox[{"t\[Lambda]4d", "[", 
                 RowBox[{"[", 
                  RowBox[{"b", ",", "1"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n", ",", "soln", ",", "sl2gauge"}], "}"}], ",", 
             RowBox[{
              RowBox[{"n", "=", 
               RowBox[{"Length", "@", "\[Lambda]4d"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"n", ">", "7"}], ",", 
                RowBox[{"sl2gauge", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Sigma]", "1"], "\[Rule]", "  ", 
                    "Infinity"}], ",", 
                   RowBox[{
                    SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                   RowBox[{
                    SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], 
                  "}"}]}], ",", 
                RowBox[{"sl2gauge", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["\[Sigma]", "1"], "\[Rule]", "0"}], ",", 
                   RowBox[{
                    SubscriptBox["\[Sigma]", "2"], "\[Rule]", " ", "1"}], ",", 
                   RowBox[{
                    SubscriptBox["\[Sigma]", "3"], "\[Rule]", "2"}]}], 
                  "}"}]}]}], "]"}], ";", 
              RowBox[{"soln", "=", 
               RowBox[{"solutions", "[", 
                RowBox[{
                 RowBox[{"sdata", "[", 
                  RowBox[{"\[Lambda]4d", ",", "t\[Lambda]4d"}], "]"}], ",", 
                 "sl2gauge"}], "]"}]}], ";", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Det", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"capitalpsi", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{";;", ",", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{"-", "n"}], "-", "1"}]}]}], "]"}], "]"}], "/.", 
                    RowBox[{"lorentzproducts", "[", 
                    RowBox[{"{", "}"}], "]"}]}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["\[Sigma]", "1"], "-", 
                    SubscriptBox["\[Sigma]", "2"]}], ")"}], "^", "2"}]}], 
                    ")"}], "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"jacobianchy", "[", "n", "]"}], "/.", 
                    RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", " ", 
                    RowBox[{"s4d", "[", 
                    RowBox[{"{", "i", "}"}], "]"}]}]}], "/.", 
                    RowBox[{"soln", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "/.", 
                    RowBox[{"holdDet", "\[Rule]", " ", "Det"}]}], ")"}]}], "/.", 
                 RowBox[{"soln", "[", 
                  RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"iii", ",", 
                  RowBox[{"Length", "[", "soln", "]"}]}], "}"}]}], "]"}]}]}], 
            "]"}]}]}], "]"}], ",", "0"}], "]"}]}], "]"}]}], "\n"}]}]], "Code",
 CellChangeTimes->{
  3.690435737884128*^9, {3.690435873339916*^9, 3.6904359461500044`*^9}, {
   3.6904391500017605`*^9, 3.6904391587693386`*^9}, {3.6904391903464537`*^9, 
   3.6904392116508107`*^9}, {3.6904396822979326`*^9, 3.690439731663658*^9}, {
   3.6904398409605765`*^9, 3.6904398751305127`*^9}, {3.6904399103681993`*^9, 
   3.690439919469062*^9}, {3.6904448779082346`*^9, 3.69044487945977*^9}, 
   3.690451557604889*^9, {3.6904552954229097`*^9, 3.6904553493907194`*^9}, {
   3.6904567808797503`*^9, 3.6904567874603047`*^9}, {3.6904569525075784`*^9, 
   3.69045700651154*^9}, {3.6904580736492186`*^9, 3.690458117463752*^9}, {
   3.6904582030374947`*^9, 3.6904582088259583`*^9}, {3.690458248636801*^9, 
   3.6904582489546776`*^9}, {3.690503258090227*^9, 3.6905032595625377`*^9}, {
   3.690541067805234*^9, 3.6905410682164817`*^9}, {3.6905442194331474`*^9, 
   3.6905442523428774`*^9}, {3.6905451935893784`*^9, 3.6905452108824797`*^9}, 
   3.690547352971901*^9, {3.6907213832584457`*^9, 3.690721450288104*^9}, {
   3.6907215234134827`*^9, 3.690721602182609*^9}, {3.6907216409949145`*^9, 
   3.6907217055716853`*^9}, {3.6907217892829447`*^9, 
   3.6907219503398623`*^9}, {3.690722013774641*^9, 3.69072208062955*^9}, {
   3.6907700754279194`*^9, 3.690770150626915*^9}, {3.690986374593322*^9, 
   3.6909864071264477`*^9}, {3.690986710173628*^9, 3.6909867127486515`*^9}, {
   3.690987031480727*^9, 3.690987040981311*^9}, {3.691986808070387*^9, 
   3.691986808850194*^9}, {3.6919868898227644`*^9, 3.6919868906536016`*^9}, {
   3.6931765105900345`*^9, 3.6931765248647575`*^9}, {3.69326137237597*^9, 
   3.693261469937347*^9}, {3.6932618644486303`*^9, 3.693261865010889*^9}, {
   3.6932766493805294`*^9, 3.6932766566846213`*^9}, 3.6933017113170977`*^9, {
   3.6933017456885095`*^9, 3.693301746846284*^9}, 3.6933060167742786`*^9, {
   3.6992329853806734`*^9, 3.6992329947250395`*^9}, {3.6994255395414667`*^9, 
   3.699425553471395*^9}, 3.700267688831125*^9, {3.7002677817645435`*^9, 
   3.7002677819487076`*^9}, {3.7002777501062107`*^9, 3.700277771349655*^9}, {
   3.700446301828238*^9, 3.700446329838709*^9}, {3.700446429346679*^9, 
   3.700446492543145*^9}, {3.7004465589272366`*^9, 3.7004465779895315`*^9}, 
   3.7004466443822517`*^9, {3.7004467022951035`*^9, 3.7004467038618307`*^9}, {
   3.700447150139594*^9, 3.700447156715123*^9}, {3.7004473076877623`*^9, 
   3.7004473146569414`*^9}, {3.700447724665077*^9, 3.700447748285509*^9}, {
   3.7004503188551865`*^9, 3.7004503296231613`*^9}, {3.700450366305645*^9, 
   3.700450390552782*^9}, {3.7004504960222692`*^9, 3.700450787939824*^9}, {
   3.7004508315349236`*^9, 3.7004512631417603`*^9}, {3.700451579512576*^9, 
   3.7004516569488053`*^9}, {3.7004592098168783`*^9, 3.7004592168304234`*^9}, 
   3.7004595191110725`*^9, {3.7004623431921744`*^9, 3.7004623894580617`*^9}, {
   3.700462443212695*^9, 3.7004625662074757`*^9}, {3.700462649176716*^9, 
   3.7004626492953386`*^9}, {3.7004627067419643`*^9, 
   3.7004631235572023`*^9}, {3.700463199238708*^9, 3.7004632924406557`*^9}, {
   3.7004634504598274`*^9, 3.7004635905809193`*^9}, {3.700463634486726*^9, 
   3.7004636838878765`*^9}, {3.700463727713357*^9, 3.7004638383376455`*^9}, {
   3.7004638856758385`*^9, 3.700463923619844*^9}, {3.7004639933629656`*^9, 
   3.7004642538769894`*^9}, 3.700464302098316*^9, {3.7004644318243246`*^9, 
   3.700464504578926*^9}, {3.700464537619955*^9, 3.700464586004112*^9}, {
   3.7004646262195683`*^9, 3.70046462745907*^9}, {3.7004646650872793`*^9, 
   3.700464826944821*^9}, {3.700464937886487*^9, 3.700464945863371*^9}, {
   3.7004650952737846`*^9, 3.7004651692413425`*^9}, {3.700465213604399*^9, 
   3.700465229397617*^9}, {3.7004656361911736`*^9, 3.7004659071884212`*^9}, {
   3.700465995094836*^9, 3.700466102588024*^9}, {3.700466596080223*^9, 
   3.700466610150441*^9}, {3.700466645308768*^9, 3.7004668122611146`*^9}, {
   3.70046684582339*^9, 3.7004668623303876`*^9}, {3.7004677259581685`*^9, 
   3.7004677832365327`*^9}, {3.700474069743099*^9, 3.7004741012738037`*^9}, {
   3.7228926426685205`*^9, 3.7228926530518837`*^9}, {3.726011863666333*^9, 
   3.72601191905764*^9}, {3.726011971555915*^9, 3.726011989716118*^9}, {
   3.732377701993825*^9, 3.732377702545363*^9}, {3.732378821771285*^9, 
   3.732378824161467*^9}, {3.742189773548558*^9, 3.742189774807405*^9}, {
   3.743463469100881*^9, 3.743463469419074*^9}, {3.753791540258523*^9, 
   3.753791547851824*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"3c6ee69f-9fbb-43dd-a3c1-ac3c0930dbb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bcjnumerator", "[", "list_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tree", ",", "ttree", ",", "ektree", ",", "treee", ",", "ekdot", ",", 
       "epdot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"treee", "[", "llist_", "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "slott", "}"}], ",", 
         RowBox[{
          RowBox[{"slott", "=", 
           RowBox[{"llist", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"slot", ",", 
              RowBox[{"tree", "[", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"llist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "slot"}], "}"}]}], 
                ",", 
                RowBox[{"Select", "[", 
                 RowBox[{"slott", ",", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"slot", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
               "]"}]}], "]"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"slott", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
              RowBox[{"Subsets", "@", 
               RowBox[{"slott", "[", 
                RowBox[{"[", 
                 RowBox[{";;", 
                  RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ")"}]}], "//", 
           RowBox[{
            RowBox[{"Plus", "@@", "#"}], " ", "&"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tree", "[", "ii__", "]"}], ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"slott", ",", "iislot"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"iislot", "=", 
           RowBox[{
            RowBox[{"{", "ii", "}"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"slott", "=", 
           RowBox[{
            RowBox[{"{", "ii", "}"}], "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"slott", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"ttree", "[", "iislot", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"slot", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{"verslot", ",", 
                    RowBox[{"tree", "[", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "iislot"}], ",", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"verslot", ",", "slot"}], "}"}]}], ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{"slott", ",", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"slot", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], 
                    "]"}]}], "]"}], "/@", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", "iislot"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"list", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"slot", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], 
                    "]"}], "]"}], ",", "#"}], "]"}], "&"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "//", 
                 RowBox[{
                  RowBox[{"Plus", "@@", "#"}], "&"}]}]}], "]"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Append", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Max", "@", "slott"}]}], "]"}], "&"}], "/@", 
                RowBox[{"Subsets", "@", 
                 RowBox[{"slott", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"slott", ",", 
                    RowBox[{"Max", "@", "slott"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], 
                   "]"}], "]"}]}]}], ")"}]}], "//", 
             RowBox[{
              RowBox[{"Plus", "@@", "#"}], "&"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ekdot", "[", "i__", "]"}], ":=", 
       RowBox[{"cdot", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", 
          RowBox[{
           RowBox[{"{", "i", "}"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["f", "#"], "&"}], "/@", 
            RowBox[{
             RowBox[{"{", "i", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", 
               RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}], ",", 
         SubscriptBox["k", 
          RowBox[{
           RowBox[{"{", "i", "}"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"epdot", "[", "i__", "]"}], ":=", 
       RowBox[{"cdot", "[", 
        RowBox[{
         SubscriptBox["\[Epsilon]", 
          RowBox[{
           RowBox[{"{", "i", "}"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["f", "#"], "&"}], "/@", 
            RowBox[{
             RowBox[{"{", "i", "}"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", ";;", 
               RowBox[{"-", "2"}]}], "]"}], "]"}]}], ")"}]}], ",", 
         SubscriptBox["\[Epsilon]", 
          RowBox[{
           RowBox[{"{", "i", "}"}], "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ektree", "[", "ii_", "]"}], ":=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], " ", "^", 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"Length", "@", 
            RowBox[{"ii", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], " ", 
        RowBox[{"epdot", "@@", 
         RowBox[{"ii", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], 
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ekdot", "@@", " ", 
              RowBox[{"Reverse", "@", "#"}]}], "&"}], ")"}], "/@", 
           RowBox[{"ii", "[", 
            RowBox[{"[", 
             RowBox[{"2", ";;"}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"treee", "@", "list"}], "/.", 
       RowBox[{"ttree", "\[Rule]", " ", "ektree"}]}]}]}], "]"}]}], "\n", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AmpYM", "[", "list_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "@", "list"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"bcjnumerator", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Sequence", "@@", "#"}], ",", "n"}], "}"}], "]"}], 
            RowBox[{"phi3mand", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Sequence", "@@", "#"}], ",", "n"}], "}"}], ",", 
              RowBox[{"Range", "@", "n"}]}], "]"}]}], "&"}], "/@", 
          RowBox[{"Permutations", "@", 
           RowBox[{"Range", "[", 
            RowBox[{"2", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}]}]}], "//", 
         RowBox[{
          RowBox[{"#", "//.", "reducecdot"}], "&"}]}], "//", "Total"}], "//", 
       RowBox[{
        RowBox[{"#", "/.", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"slot", ",", 
            RowBox[{"slot", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"slot", "/.", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Range", "@", "n"}], ",", "list"}], "}"}]}], 
                "]"}]}], ")"}]}]}], "]"}], "/@", 
          RowBox[{"Union", "@", 
           RowBox[{"Level", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"-", "2"}], "}"}]}], "]"}]}]}]}], "&"}]}]}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AmpGR", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ym1", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ym1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"bcjnumerator", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"Sequence", "@@", "#"}], ",", "n"}], "}"}], "]"}], 
           RowBox[{"phi3mand", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Sequence", "@@", "#"}], ",", "n"}], "}"}], ",", 
             RowBox[{"Range", "@", "n"}]}], "]"}]}], "&"}], "/@", 
         RowBox[{"Permutations", "@", 
          RowBox[{"Range", "[", 
           RowBox[{"2", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}]}], "//", "Total"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"slotlist", ",", 
           RowBox[{
            RowBox[{"bcjnumerator", "@", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Sequence", "@@", "slotlist"}], ",", "n"}], "}"}]}], 
            RowBox[{"(", 
             RowBox[{"ym1", "/.", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"slot", ",", 
                 RowBox[{"slot", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{"slot", "/.", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "\[Rule]", " ", "#2"}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "@", "n"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Sequence", "@@", "slotlist"}], ",", "n"}], 
                    "}"}]}], "}"}]}], "]"}]}], ")"}]}]}], "]"}], "/@", 
               RowBox[{"Union", "@", 
                RowBox[{"Level", "[", 
                 RowBox[{"ym1", ",", 
                  RowBox[{"{", 
                   RowBox[{"-", "2"}], "}"}]}], "]"}]}]}]}], ")"}]}]}], "]"}],
          "/@", 
         RowBox[{"Permutations", "@", 
          RowBox[{"Range", "[", 
           RowBox[{"2", ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}]}], "/.", "reducecdot"}], "//", 
       "Total"}]}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.7352120598672533`*^9, 3.735212079606327*^9}, {
   3.73521305933281*^9, 3.7352130977921467`*^9}, 3.753757633569707*^9},
 CellLabel->
  "In[191]:=",ExpressionUUID->"e4e70660-ae4c-42fe-a78f-88092f372427"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pushforward", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "slot", "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ans", ",", "nn"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nn", "=", 
         RowBox[{"Length", "@", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"slot", ",", 
             RowBox[{"PT", "[", "__", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ans", "=", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"phi3mand", "[", 
           RowBox[{
            RowBox[{"Range", "@", "nn"}], ",", 
            RowBox[{"Range", "@", "nn"}]}], "]"}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"slott", ",", 
              RowBox[{
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"left", ",", "right", ",", "slot2", ",", "ss"}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", "$2", "}"}], ",", 
                    RowBox[{
                    RowBox[{"slot2", "=", 
                    RowBox[{"Sort", "@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"slott", ",", 
                    RowBox[{
                    SubscriptBox["s", "i__"], "\[RuleDelayed]", "  ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], ",", "nn"}], "]"}], ",", 
                    SubscriptBox["ss", "i"], ",", 
                    SubscriptBox["ss", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "@", "nn"}], ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}]]}], "]"}]}], ",", 
                    "Infinity"}], "]"}]}]}], ";", 
                    RowBox[{"left", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"slot2", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "$2"}], 
                    "&"}]}], "]"}]}], ";", 
                    RowBox[{"right", "=", 
                    RowBox[{"Select", "[", 
                    RowBox[{"slot2", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "\[Equal]", "$2"}], 
                    "&"}]}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"left", "=!=", " ", 
                    RowBox[{"{", "}"}]}], "&&", 
                    RowBox[{"right", "===", " ", 
                    RowBox[{"{", "}"}]}]}], ",", 
                    RowBox[{"left", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"left", "===", " ", 
                    RowBox[{"{", "}"}]}], "&&", 
                    RowBox[{"right", "=!=", " ", 
                    RowBox[{"{", "}"}]}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"right", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "True", ",", 
                    "0"}], "]"}], "/.", 
                    RowBox[{"ss", "\[Rule]", " ", "s"}]}]}]}], "]"}], "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"2", ",", 
                    RowBox[{"nn", "-", "2"}]}], "]"}]}]}], "]"}], "//", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "^", 
                  RowBox[{"Length", "@", 
                   RowBox[{"Cases", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "1"}], ",", "Infinity"}], "]"}]}]}], " ", 
                 RowBox[{"Signature", "[", 
                  RowBox[{"Ordering", "@", 
                   RowBox[{"(", 
                    RowBox[{"#", "/.", 
                    RowBox[{
                    RowBox[{"-", "1"}], "\[Rule]", " ", "1"}]}], ")"}]}], 
                  "]"}], 
                 RowBox[{"Wedge", "@@", 
                  RowBox[{"Sort", "@", 
                   RowBox[{"(", 
                    RowBox[{"#", "/.", 
                    RowBox[{
                    RowBox[{"-", "1"}], "\[Rule]", "1"}]}], ")"}]}]}]}], 
                "&"}]}]}], "]"}], "/@", "#"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"slot", "/.", "\[VeryThinSpace]", 
          RowBox[{
           RowBox[{"PT", "[", "i__", "]"}], "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Signature", "[", 
               RowBox[{"{", "i", "}"}], "]"}], " ", "ans"}], "/.", 
             "\[VeryThinSpace]", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Range", "[", "nn", "]"}], ",", 
                 RowBox[{"{", "i", "}"}]}], "}"}]}], "]"}]}], ")"}]}]}], "/.",
          "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{"Wedge", "[", "i__", "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"Signature", "[", 
            RowBox[{"Ordering", "[", 
             RowBox[{"{", "i", "}"}], "]"}], "]"}], " ", 
           RowBox[{"Wedge", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Sort", "[", 
              RowBox[{"{", "i", "}"}], "]"}]}], "]"}]}]}]}]}]}], "]"}]}], 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.726020590566856*^9, {3.726022637129706*^9, 3.726022639272791*^9}, {
   3.726022692803708*^9, 3.726022850896818*^9}, {3.726022953066373*^9, 
   3.726022961200214*^9}, {3.726023010069717*^9, 3.726023013037229*^9}, 
   3.7260230617367783`*^9, {3.7260230949505043`*^9, 3.7260231494050083`*^9}, 
   3.7260232092099237`*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"d2a5700f-f650-4913-9b36-94b02d99d819"]
},
AutoGeneratedPackage->Automatic,
WindowSize->{Full, Full},
WindowMargins->{{Automatic, -50}, {113, Automatic}},
Magnification:>1.4 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 212, 3, 42, "Input",ExpressionUUID->"c7e36da7-39ea-464c-81ec-8c4f212968ba"],
Cell[795, 27, 172, 2, 48, "Output",ExpressionUUID->"408b420e-994a-4d04-947a-10ed881820ea"]
}, Open  ]],
Cell[982, 32, 45452, 1199, 2241, "Code",ExpressionUUID->"9f0aadb1-08d1-4e65-8e9b-6a9a867b4424"],
Cell[46437, 1233, 32620, 762, 1208, "Code",ExpressionUUID->"ce4f864c-e20a-4ff5-b34e-2393ffaf6922"],
Cell[79060, 1997, 39451, 936, 1359, "Code",ExpressionUUID->"0347b7c8-9753-481c-99d6-917cfaed8cb5"],
Cell[118514, 2935, 12075, 306, 510, "Code",ExpressionUUID->"66f8ccbb-caa0-43c7-974c-750d7c6a330d"],
Cell[130592, 3243, 3885, 112, 216, "Code",ExpressionUUID->"5de668f0-77c4-4b74-a5d2-5581cd782964"],
Cell[134480, 3357, 54709, 1383, 3105, "Input",ExpressionUUID->"18e7cee1-e688-489f-ac59-bd5d23b855e0",
 InitializationCell->True],
Cell[189192, 4742, 154, 3, 42, "Input",ExpressionUUID->"534cbd9c-ba87-41a4-9f6f-e93d13ad4cce"],
Cell[189349, 4747, 272453, 6869, 3955, "Code",ExpressionUUID->"3c6ee69f-9fbb-43dd-a3c1-ac3c0930dbb1"],
Cell[461805, 11618, 12899, 345, 671, "Code",ExpressionUUID->"e4e70660-ae4c-42fe-a78f-88092f372427"],
Cell[474707, 11965, 6811, 163, 247, "Code",ExpressionUUID->"d2a5700f-f650-4913-9b36-94b02d99d819"]
}
]
*)

